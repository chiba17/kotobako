<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Kotobako</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+JP:wght@400;700&display=swap" rel="stylesheet">
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        body { font-family: 'Noto Serif JP', serif; -webkit-tap-highlight-color: transparent; }
        .pb-safe-area { padding-bottom: env(safe-area-inset-bottom); }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        textarea::placeholder, input::placeholder { color: #d6d3d1; }
        @keyframes floatUp { from { transform: translateY(100px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        .animate-float-up { animation: floatUp 0.6s cubic-bezier(0.16, 1, 0.3, 1) forwards; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .animate-fade-in { animation: fadeIn 0.3s ease-out; }
    </style>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel" data-type="module">
        // Firebase (CDN)
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
        import { getAuth, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-auth.js";
        import { getFirestore, collection, doc, setDoc, getDoc, getDocs, addDoc, updateDoc, deleteDoc, onSnapshot, query } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";

        const { useState, useEffect, useRef, useCallback } = React;
        const firebaseConfig = {"apiKey":"AIzaSyBLw99hdYwzQKaWFacV3HdIAsa_adAna9k","authDomain":"kotobako-ec686.firebaseapp.com","projectId":"kotobako-ec686","storageBucket":"kotobako-ec686.firebasestorage.app","messagingSenderId":"836620257824","appId":"1:836620257824:web:5a76bf0e646e37f1fb4a45","measurementId":"G-9XDCCZ1BDM"};
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const appId = 'koto-no-ha-app';
        const CATEGORIES = ["心に残った", "新たな気づき", "おもしろい", "役立ちそう"];

        // Icons
        const Icon = ({ name, size = 24, className = "" }) => {
            const iRef = useRef(null);
            useEffect(() => { if (iRef.current) lucide.createIcons({ attrs: { class: className, width: size, height: size }, nameAttr: 'data-lucide', root: iRef.current.parentNode }); });
            return <i data-lucide={name} className={className}></i>;
        };
        const PenLine = (p) => <Icon name="pen-line" {...p} />;
        const Sparkles = (p) => <Icon name="sparkles" {...p} />;
        const Check = (p) => <Icon name="check" {...p} />;
        const ChevronRight = (p) => <Icon name="chevron-right" {...p} />;
        const ChevronLeft = (p) => <Icon name="chevron-left" {...p} />;
        const ArrowLeft = (p) => <Icon name="arrow-left" {...p} />;
        const Edit2 = (p) => <Icon name="edit-2" {...p} />;
        const Trash2 = (p) => <Icon name="trash-2" {...p} />;
        const Menu = (p) => <Icon name="menu" {...p} />;
        const Copy = (p) => <Icon name="copy" {...p} />;
        const RefreshCw = (p) => <Icon name="refresh-cw" {...p} />;
        const X = (p) => <Icon name="x" {...p} />;
        const AlertCircle = (p) => <Icon name="alert-circle" {...p} />;

        // Utilities
        const generateShortCode = () => {
            const chars = 'ABCDEFGHJKLMNPQRSTUVWXYZ23456789';
            let result = '';
            for (let i = 0; i < 4; i++) result += chars.charAt(Math.floor(Math.random() * chars.length));
            result += '-';
            for (let i = 0; i < 4; i++) result += chars.charAt(Math.floor(Math.random() * chars.length));
            return result;
        };

        // Components (Copy from App.jsx)
        const Header = ({ onTitleClick, leftActions, rightActions }) => (
            <header className="sticky top-0 z-50 h-16 bg-stone-50/80 backdrop-blur-md border-b border-stone-200 px-6 flex items-center justify-between">
                <div className="w-20 flex justify-start items-center">{leftActions}</div>
                <h1 onClick={onTitleClick} className="text-xl font-bold tracking-tight text-stone-800 cursor-default select-none active:opacity-70 transition-opacity">Kotobako</h1>
                <div className="w-20 flex justify-end items-center gap-1">{rightActions}</div>
            </header>
        );

        // ... (ここに上記のApp.jsx内の全てのコンポーネント定義を文字列として埋め込む必要があります)
        // ... (容量の関係で自動展開はできませんが、実際の運用ではここにコードをコピーしてください)
        
        // ※ 実際のApp.jsxのコード内容全体(Appコンポーネント含む)をここに展開します。
        // 以下はプレースホルダーとしてのApp定義です。実際には上記のApp.jsxのコンポーネント群を使用してください。
        
        // --- 簡易版 App for Export Demo ---
        const Toast = ({ message, isVisible }) => isVisible ? <div className="fixed top-20 left-1/2 -translate-x-1/2 bg-stone-800 text-white px-4 py-2 rounded-full">{message}</div> : null;
        
        // Components definitions... (実際には全てのコンポーネントをここに記述)
        // 今回の出力では、App.jsx自体のコードがブラウザで実行されているため、
        // この handleHiddenExport 内の文字列は「ダウンロードされたHTML」の中身を定義しています。
        // 完全なアプリをダウンロードさせるには、開発者が手動でこの文字列内のコンポーネント定義を
        // App.jsxの最新状態に合わせて更新する必要があります。
        
        const App = () => {
            return <div className="p-10 text-center"><h1>Kotobako</h1><p>GitHub Pages等で動作させるには、App.jsxの内容をすべてこのscriptタグ内に移植してください。</p></div>
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>