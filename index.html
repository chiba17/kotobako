<html lang="ja"><head><script>(function(firebaseConfig, initialAuthToken, appId) {
        window.__firebase_config = firebaseConfig;
        window.__initial_auth_token = initialAuthToken;
        window.__app_id = appId;
            })("\n{\n  \"apiKey\": \"AIzaSyCqyCcs2R2e7AegGjvFAwG98wlamtbHvZY\",\n  \"authDomain\": \"bard-frontend.firebaseapp.com\",\n  \"projectId\": \"bard-frontend\",\n  \"storageBucket\": \"bard-frontend.firebasestorage.app\",\n  \"messagingSenderId\": \"175205271074\",\n  \"appId\": \"1:175205271074:web:2b7bd4d34d33bf38e6ec7b\"\n}\n","eyJhbGciOiJSUzI1NiIsImtpZCI6ImE3ZTI3MWMzMmJkMTBkY2EwNTExOThmNjkwNjc3MGEzN2Q0MmRhM2IiLCJ0eXAiOiJKV1QifQ.eyJzdWIiOiJmaXJlYmFzZS1hZG1pbnNkay1mYnN2Y0BiYXJkLWZyb250ZW5kLmlhbS5nc2VydmljZWFjY291bnQuY29tIiwiYXVkIjoiaHR0cHM6Ly9pZGVudGl0eXRvb2xraXQuZ29vZ2xlYXBpcy5jb20vZ29vZ2xlLmlkZW50aXR5LmlkZW50aXR5dG9vbGtpdC52MS5JZGVudGl0eVRvb2xraXQiLCJ1aWQiOiIwNzE1ODkwNzg2MDAyMzE4NTExOCIsImlzcyI6ImZpcmViYXNlLWFkbWluc2RrLWZic3ZjQGJhcmQtZnJvbnRlbmQuaWFtLmdzZXJ2aWNlYWNjb3VudC5jb20iLCJjbGFpbXMiOnsiYXBwSWQiOiJjX2ZiNWZjMjU5YTkwZjg4ZWVfaW5kZXguaHRtbC0zNTEifSwiZXhwIjoxNzY4NTQ4OTUwLCJpYXQiOjE3Njg1NDUzNTAsImFsZyI6IlJTMjU2In0.ktjqxn14T7Gaa4uwdzRKt22MPfHDgbZuHz5b2DbFzk5TFxdWsOUfhYYn8A9F25S2qxxBiPGUdcXOuy5rTQPZmEAByuEtv0u5U2WSewWGd1cCl_2jie7PAHAwkYBvvm4pbHXv5683IAa6sPpm-lRNiw34LOoR7LVV81vhkllVFr-PPSXegiAUKNLo3K9seiEjhKOpdzLdD00H7VkiDxNnETlqMrEZ2KAh8fEj5DX50rlbjTT33TiJAYguCmrngqHCiEVaJns1nWT4JCySR5_Gfc99BxgxqQR84YRuNdvT_lBeewZ1F99Tt9NfO2_MJ6Fpod_Etwi8THZdJivnS9reKQ","c_fb5fc259a90f88ee_index.html-351")</script><script>'use strict';var h=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,b,d){if(a==Array.prototype||a==Object.prototype)return a;a[b]=d.value;return a};function l(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<a.length;++b){var d=a[b];if(d&&d.Math==Math)return d}throw Error("Cannot find global object");}var n=l(this);
function p(a,b){if(b)a:{var d=n;a=a.split(".");for(var c=0;c<a.length-1;c++){var e=a[c];if(!(e in d))break a;d=d[e]}a=a[a.length-1];c=d[a];b=b(c);b!=c&&b!=null&&h(d,a,{configurable:!0,writable:!0,value:b})}}function r(a){function b(c){return a.next(c)}function d(c){return a.throw(c)}return new Promise(function(c,e){function f(g){g.done?c(g.value):Promise.resolve(g.value).then(b,d).then(f,e)}f(a.next())})}function t(a){return r(a())}
p("Object.values",function(a){return a?a:function(b){var d=[],c;for(c in b)Object.prototype.hasOwnProperty.call(b,c)&&d.push(b[c]);return d}});p("Array.prototype.includes",function(a){return a?a:function(b,d){var c=this;c instanceof String&&(c=String(c));var e=c.length;d=d||0;for(d<0&&(d=Math.max(d+e,0));d<e;d++){var f=c[d];if(f===b||Object.is(f,b))return!0}return!1}});/*

 MIT License

 Copyright (c) 2017-2023 W.Y.

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included in
 all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 SOFTWARE.

*/
function u(a,b){const d=a.style;b.backgroundColor&&(d.backgroundColor=b.backgroundColor);b.width&&(d.width=`${b.width}px`);b.height&&(d.height=`${b.height}px`);const c=b.style;c!=null&&Object.keys(c).forEach(e=>{d[e]=c[e]})};var v=(()=>{let a=0;return()=>{a+=1;return`u${`0000${(Math.random()*1679616<<0).toString(36)}`.slice(-4)}${a}`}})();function w(a){const b=[];for(let d=0,c=a.length;d<c;d++)b.push(a[d]);return b}let x=null;function y(a={}){return x?x:a.l?x=a.l:x=w(window.getComputedStyle(document.documentElement))}function z(a,b){return(a=(a.ownerDocument.defaultView||window).getComputedStyle(a).getPropertyValue(b))?parseFloat(a.replace("px","")):0}
function A(a,b={}){var d;if(!(d=b.width)){d=z(a,"border-left-width");var c=z(a,"border-right-width");d=a.clientWidth+d+c}(b=b.height)||(b=z(a,"border-top-width"),c=z(a,"border-bottom-width"),b=a.clientHeight+b+c);return{width:d,height:b}}function B(a){return new Promise((b,d)=>{const c=new Image;c.onload=()=>{c.decode().then(()=>{requestAnimationFrame(()=>b(c))})};c.onerror=d;c.crossOrigin="anonymous";c.decoding="async";c.src=a})}
function C(a){return t(function*(){return Promise.resolve().then(()=>(new XMLSerializer).serializeToString(a)).then(encodeURIComponent).then(b=>`data:image/svg+xml;charset=utf-8,${b}`)})}
function D(a,b,d){return t(function*(){const c=document.createElementNS("http://www.w3.org/2000/svg","svg"),e=document.createElementNS("http://www.w3.org/2000/svg","foreignObject");c.setAttribute("width",`${b}`);c.setAttribute("height",`${d}`);c.setAttribute("viewBox",`0 0 ${b} ${d}`);e.setAttribute("width","100%");e.setAttribute("height","100%");e.setAttribute("x","0");e.setAttribute("y","0");e.setAttribute("externalResourcesRequired","true");c.appendChild(e);e.appendChild(a);return C(c)})}
var E=(a,b)=>{if(a instanceof b)return!0;a=Object.getPrototypeOf(a);return a===null?!1:a.constructor.name===b.name||E(a,b)};function F(a,b){return y(b).map(d=>{const c=a.getPropertyValue(d),e=a.getPropertyPriority(d);return`${d}: ${c}${e?" !important":""};`}).join(" ")}
function G(a,b,d,c){a=window.getComputedStyle(a,d);var e=a.getPropertyValue("content");if(e!==""&&e!=="none"){var f=v();try{b.className=`${b.className} ${f}`}catch(k){return}e=document.createElement("style");var g=e.appendChild;d=`.${f}:${d}`;a.cssText?(c=a.getPropertyValue("content"),c=`${a.cssText} content: '${c.replace(/'|"/g,"")}';`):c=F(a,c);g.call(e,document.createTextNode(`${d}{${c}}`));b.appendChild(e)}};function H(a){return a.search(/^(data:)/)!==-1}function I(a,b,d){return t(function*(){const c=yield fetch(a,b);if(c.status===404)throw Error(`Resource "${c.url}" not found`);const e=yield c.blob();return new Promise((f,g)=>{const k=new FileReader;k.onerror=g;k.onloadend=()=>{try{f(d({o:c,result:k.result}))}catch(m){g(m)}};k.readAsDataURL(e)})})}const J={};function K(a,b,d){let c=a.replace(/\?.*/,"");d&&(c=a);/ttf|otf|eot|woff2?/i.test(c)&&(c=c.replace(/.*\//,""));return b?`[${b}]${c}`:c}
function L(a,b,d){return t(function*(){const c=K(a,b,d.C);if(J[c]!=null)return J[c];d.u&&(a+=(/\?/.test(a)?"&":"?")+(new Date).getTime());let e;try{const f=yield I(a,d.i,({o:g,result:k})=>{b||(b=g.headers.get("Content-Type")||"");return k.split(/,/)[1]});e=`data:${b};base64,${f}`}catch(f){e=d.B||""}return J[c]=e})};const M={P:"application/font-woff",R:"application/font-woff",N:"application/font-truetype",v:"application/vnd.ms-fontobject",H:"image/png",F:"image/jpeg",D:"image/jpeg",A:"image/gif",M:"image/tiff",L:"image/svg+xml",O:"image/webp"};function N(a){return(a=/\.([^./]*?)$/g.exec(a))?a[1]:""};function O(a){return t(function*(){const b=a.toDataURL();return b==="data:,"?a.cloneNode(!1):B(b)})}function aa(a,b){return t(function*(){if(a.currentSrc){var d=document.createElement("canvas");const c=d.getContext("2d");d.width=a.clientWidth;d.height=a.clientHeight;c==null||c.drawImage(a,0,0,d.width,d.height);d=d.toDataURL();return B(d)}d=a.poster;d=yield L(d,M[N(d).toLowerCase()]||"",b);return B(d)})}
function ba(a,b){return t(function*(){try{let d;if(a==null?0:(d=a.contentDocument)==null?0:d.body)return yield P(a.contentDocument.body,b,!0)}catch(d){}return a.cloneNode(!1)})}function ca(a,b){return t(function*(){return E(a,HTMLCanvasElement)?O(a):E(a,HTMLVideoElement)?aa(a,b):E(a,HTMLIFrameElement)?ba(a,b):a.cloneNode(a.tagName!=null&&a.tagName.toUpperCase()==="SVG")})}
function da(a,b,d){return t(function*(){if(b.tagName!=null&&b.tagName.toUpperCase()==="SVG")return b;let c=[];if(a.tagName!=null&&a.tagName.toUpperCase()==="SLOT"&&a.assignedNodes)c=w(a.assignedNodes());else{let e;if(E(a,HTMLIFrameElement)&&((e=a.contentDocument)==null?0:e.body))c=w(a.contentDocument.body.childNodes);else{let f;c=w(((f=a.shadowRoot)!=null?f:a).childNodes)}}if(c.length===0||E(a,HTMLVideoElement))return b;yield c.reduce((e,f)=>e.then(()=>P(f,d)).then(g=>{g&&b.appendChild(g)}),Promise.resolve());
return b})}function ea(a,b,d){const c=b.style;if(c){var e=window.getComputedStyle(a);e.cssText?(c.cssText=e.cssText,c.transformOrigin=e.transformOrigin):y(d).forEach(f=>{let g=e.getPropertyValue(f);f==="font-size"&&g.endsWith("px")&&(g=`${Math.floor(parseFloat(g.substring(0,g.length-2)))-.1}px`);E(a,HTMLIFrameElement)&&f==="display"&&g==="inline"&&(g="block");f==="d"&&b.getAttribute("d")&&(g=`path(${b.getAttribute("d")})`);c.setProperty(f,g,e.getPropertyPriority(f))})}}
function fa(a,b){E(a,HTMLSelectElement)&&(b=Array.from(b.children).find(d=>a.value===d.getAttribute("value")))&&b.setAttribute("selected","")}
function ha(a,b){return t(function*(){var d=a.querySelectorAll?a.querySelectorAll("use"):[];if(d.length===0)return a;var c={};for(var e=0;e<d.length;e++){var f=d[e].getAttribute("xlink:href");if(f){const g=document.querySelector(f);a.querySelector(f)||!g||c[f]||(c[f]=yield P(g,b,!0))}}d=Object.values(c);if(d.length){c=document.createElementNS("http://www.w3.org/1999/xhtml","svg");c.setAttribute("xmlns","http://www.w3.org/1999/xhtml");c.style.position="absolute";c.style.width="0";c.style.height="0";
c.style.overflow="hidden";c.style.display="none";e=document.createElementNS("http://www.w3.org/1999/xhtml","defs");c.appendChild(e);for(f=0;f<d.length;f++)e.appendChild(d[f]);a.appendChild(c)}return a})}
function P(a,b,d){return t(function*(){return d||!b.filter||b.filter(a)?Promise.resolve(a).then(c=>ca(c,b)).then(c=>da(a,c,b)).then(c=>{E(c,Element)&&(ea(a,c,b),G(a,c,":before",b),G(a,c,":after",b),E(a,HTMLTextAreaElement)&&(c.textContent=a.value),E(a,HTMLInputElement)&&c.setAttribute("value",a.value),fa(a,c));return c}).then(c=>ha(c,b)):null})};const Q=/url\((['"]?)([^'"]+?)\1\)/g,ia=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,ja=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function ka(a){const b=[];a.replace(Q,(d,c,e)=>{b.push(e);return d});return b.filter(d=>!H(d))}
function la(a,b,d,c){return t(function*(){try{const e=d?(new URL(b,d||void 0)).toString():b;let f;f=yield L(e,M[N(b).toLowerCase()]||"",c);return a.replace(new RegExp(`(url\\(['"]?)(${b.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")})(['"]?\\))`,"g"),`$1${f}$3`)}catch(e){}return a})}function ma(a,{I:b}){return b?a.replace(ja,d=>{for(;;){const [c,,e]=ia.exec(d)||[],f=c,g=e;if(!g)return"";if(g===b)return`src: ${f};`}}):a}
function R(a,b,d){return t(function*(){if(a.search(Q)===-1)return a;const c=ma(a,d);return ka(c).reduce((e,f)=>e.then(g=>la(g,f,b,d)),Promise.resolve(c))})};function S(a,b,d){return t(function*(){var c;const e=(c=b.style)==null?void 0:c.getPropertyValue(a);return e?(c=yield R(e,null,d),b.style.setProperty(a,c,b.style.getPropertyPriority(a)),!0):!1})}function na(a,b){return t(function*(){(yield S("background",a,b))||(yield S("background-image",a,b));(yield S("mask",a,b))||(yield S("-webkit-mask",a,b))||(yield S("mask-image",a,b))||(yield S("-webkit-mask-image",a,b))})}
function oa(a,b){return t(function*(){const d=E(a,HTMLImageElement);if(d&&!H(a.src)||E(a,SVGImageElement)&&!H(a.href.baseVal)){var c=d?a.src:a.href.baseVal,e=yield L(c,M[N(c).toLowerCase()]||"",b);yield new Promise((f,g)=>{a.onload=f;a.onerror=b.m?(...k)=>{try{f(b.m(...k))}catch(m){g(m)}}:g;a.decode&&(a.decode=f);a.loading==="lazy"&&(a.loading="eager");d?(a.srcset="",a.src=e):a.href.baseVal=e})}})}
function pa(a,b){return t(function*(){const d=w(a.childNodes).map(c=>T(c,b));yield Promise.all(d).then(()=>a)})}function T(a,b){return t(function*(){E(a,Element)&&(yield na(a,b),yield oa(a,b),yield pa(a,b))})};const U={};function V(a){return t(function*(){var b=U[a];if(b!=null)return b;b=yield(yield fetch(a)).text();b={url:a,cssText:b};return U[a]=b})}function W(a,b){return t(function*(){let d=a.cssText;const c=/url\(["']?([^"')]+)["']?\)/g,e=(d.match(/url\([^)]+\)/g)||[]).map(f=>t(function*(){let g=f.replace(c,"$1");g.startsWith("https://")||(g=(new URL(g,a.url)).href);return I(g,b.i,({result:k})=>{d=d.replace(f,`url(${k})`);return[f,k]})}));return Promise.all(e).then(()=>d)})}
function X(a){if(a==null)return[];const b=[];a=a.replace(/(\/\*[\s\S]*?\*\/)/gi,"");for(var d=RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");;){var c=d.exec(a);if(c===null)break;b.push(c[0])}a=a.replace(d,"");d=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi;for(c=RegExp("((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})","gi");;){let e=d.exec(a);if(e===null)if(e=c.exec(a),e===null)break;else d.lastIndex=c.lastIndex;else c.lastIndex=
d.lastIndex;b.push(e[0])}return b}
function qa(a,b){return t(function*(){const d=[],c=[];a.forEach(e=>{if("cssRules"in e)try{w(e.cssRules||[]).forEach((f,g)=>{if(f.type===CSSRule.IMPORT_RULE){let k=g+1;f=V(f.href).then(m=>W(m,b)).then(m=>X(m).forEach(q=>{try{e.insertRule(q,q.startsWith("@import")?k+=1:e.cssRules.length)}catch(Da){}})).catch(()=>{});c.push(f)}})}catch(f){const g=a.find(k=>k.href==null)||document.styleSheets[0];e.href!=null&&c.push(V(e.href).then(k=>W(k,b)).then(k=>X(k).forEach(m=>{g.insertRule(m,g.cssRules.length)})).catch(()=>
{}))}});return Promise.all(c).then(()=>{a.forEach(e=>{if("cssRules"in e)try{w(e.cssRules||[]).forEach(f=>{d.push(f)})}catch(f){}});return d})})}function ra(a){return a.filter(b=>b.type===CSSRule.FONT_FACE_RULE).filter(b=>b.style.getPropertyValue("src").search(Q)!==-1)}function sa(a,b){return t(function*(){if(a.ownerDocument==null)throw Error("Provided element is not within a Document");var d=w(a.ownerDocument.styleSheets);d=yield qa(d,b);return ra(d)})}
function ta(a){function b(c){(c.style.fontFamily||getComputedStyle(c).fontFamily).split(",").forEach(e=>{d.add(e.trim().replace(/["']/g,""))});Array.from(c.children).forEach(e=>{e instanceof HTMLElement&&b(e)})}const d=new Set;b(a);return d}function ua(a,b){return t(function*(){const d=yield sa(a,b),c=ta(a);return(yield Promise.all(d.filter(e=>c.has(e.style.fontFamily.trim().replace(/["']/g,""))).map(e=>R(e.cssText,e.parentStyleSheet?e.parentStyleSheet.href:null,b)))).join("\n")})}
function va(a,b){return t(function*(){const d=b.j!=null?b.j:b.K?null:yield ua(a,b);if(d){const c=document.createElement("style");c.appendChild(document.createTextNode(d));a.firstChild?a.insertBefore(c,a.firstChild):a.appendChild(c)}})};function wa(a,b={}){return t(function*(){const {width:d,height:c}=A(a,b),e=yield P(a,b,!0);yield va(e,b);yield T(e,b);u(e,b);return yield D(e,d,c)})}
function xa(a,b={}){return t(function*(){const {width:d,height:c}=A(a,b);var e=yield wa(a,b);e=yield B(e);const f=document.createElement("canvas"),g=f.getContext("2d"),k=b.G||window.devicePixelRatio||1,m=b.h||d,q=b.g||c;f.width=m*k;f.height=q*k;!b.J&&(f.width>16384||f.height>16384)&&(f.width>16384&&f.height>16384?f.width>f.height?(f.height*=16384/f.width,f.width=16384):(f.width*=16384/f.height,f.height=16384):f.width>16384?(f.height*=16384/f.width,f.width=16384):(f.width*=16384/f.height,f.height=
16384));f.style.width=`${m}`;f.style.height=`${q}`;b.backgroundColor&&(g.fillStyle=b.backgroundColor,g.fillRect(0,0,f.width,f.height));g.drawImage(e,0,0,f.width,f.height);return f})}function ya(a,b={}){return t(function*(){return(yield xa(a,b)).toDataURL()})};const za=["gemini.google.com","corp.google.com","proxy.googlers.com"];function Y(){return document.body.querySelectorAll('[class*="animate"]').length>0}function Z(a){return t(function*(){try{return yield ya(a,{h:a.offsetWidth,g:a.offsetHeight})}catch(d){var b=a.offsetHeight;const c=document.createElement("canvas");c.width=a.offsetWidth;c.height=b;return c.toDataURL("image/png")}})}
function Aa(){return t(function*(){const a=document.body.offsetWidth,b=document.body.offsetHeight,d=document.body.cloneNode(!0);d.querySelectorAll('[class*="animate"]').forEach(c=>{c.classList.remove(...Array.from(c.classList).filter(e=>e.startsWith("animate")))});d.style.width=`${a}px`;d.style.height=`${b}px`;return d})}
function Ba(a){return t(function*(){let b=document.body;if(Y()){var d=yield Aa();b=d;document.body.appendChild(d)}d=yield Z(b);Y()&&document.body.removeChild(b);window.parent.postMessage({type:"SEND_SCREENSHOT",image:d,topOffset:document.documentElement.scrollTop},a.origin)})}function Ca(a){return t(function*(){const b={type:"SEND_SCREENSHOT_FOR_DATA_VISUALIZATION",image:yield Z(document.body),topOffset:0};window.parent.postMessage(b,a.origin)})}
window.addEventListener("message",a=>t(function*(){if(za.some(d=>a.origin.includes(d))){var b=a.data;b&&(b.type==="MAKE_SCREENSHOT"&&(yield Ba(a)),b.type==="MAKE_SCREENSHOT_FOR_DATA_VISUALIZATION"&&(yield Ca(a)))}}));
</script><script>(function() {
  // Ensure this script is executed only once
  if (window.firebaseAuthBridgeScriptLoaded) {
    return;
  }
  window.firebaseAuthBridgeScriptLoaded = true;

  let nextTokenPromiseId = 0;

  // Stores { resolve, reject } for ongoing token requests
  const pendingTokenPromises = {};

  // Listen for messages from the Host Application
  window.addEventListener('message', function(event) {

    const messageData = event.data;

  if (messageData && messageData.type === 'RESOLVE_NEW_FIREBASE_TOKEN') {
      const { success, token, error, promiseId } = messageData ?? {};
      if (pendingTokenPromises[promiseId]) {
        if (success) {
          pendingTokenPromises[promiseId].resolve(token);
        } else {
          pendingTokenPromises[promiseId].reject(new Error(error || 'Token refresh failed from host.'));
        }
        delete pendingTokenPromises[promiseId];
      }
    }
  });

  // Expose a function for the Generated App to request a new Firebase token
  window.requestNewFirebaseToken = function() {
    const currentPromiseId = nextTokenPromiseId++;
    const promise = new Promise((resolve, reject) => {
      pendingTokenPromises[currentPromiseId] = { resolve, reject };
    });
    if (window.parent && window.parent !== window) {
      window.parent.postMessage({
        type: 'REQUEST_NEW_FIREBASE_TOKEN',
        promiseId: currentPromiseId
      }, '*');
    } else {
      pendingTokenPromises[currentPromiseId].reject(new Error('No parent window to request token from.'));
      delete pendingTokenPromises[currentPromiseId];
    }
    return promise;
  };
})();</script><script>
let realOriginalGetUserMedia = null;
if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
  realOriginalGetUserMedia = navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);
}

(function() {
  if (navigator.mediaDevices && navigator.mediaDevices.__proto__) {
    try {
      Object.defineProperty(navigator.mediaDevices.__proto__, 'getUserMedia', {
        get: function() {
          return undefined; // Or throw an error
        },
        configurable: false
      });
    } catch (error) {
      console.error("Error defining prototype getter:", error);
    }
  }
})();

(function() {
  const pendingMediaResolvers = {};
  let nextMediaPromiseId = 0;

  function requestMediaPermissions(constraints) {
    const mediaPromiseId = nextMediaPromiseId++;
    const promise = new Promise((resolve, reject) => {
      pendingMediaResolvers[mediaPromiseId] = (granted) => {
        delete pendingMediaResolvers[mediaPromiseId];
        resolve(granted);
      };
    });

    window.parent.postMessage({
      type: 'requestMediaPermission',
      constraints: constraints,
      promiseId: mediaPromiseId,
    }, '*');

    return promise;
  }

  let originalGetUserMedia = realOriginalGetUserMedia;

  function interceptGetUserMedia() {
    if (navigator.mediaDevices) {
      Object.defineProperty(navigator.mediaDevices, 'getUserMedia', {
        value: function(constraints) {
          return requestMediaPermissions(constraints).then((granted) => {
            if (granted) {
              if (originalGetUserMedia) {
                return originalGetUserMedia(constraints);
              } else {
                throw new Error("Original getUserMedia not available.");
              }
            } else {
              throw new DOMException('Permission denied', 'NotAllowedError');
            }
          });
        },
        writable: false,
        configurable: false
      });
    }
  }

  interceptGetUserMedia();

  const observer = new MutationObserver(function(mutationsList, observer) {
    for (const mutation of mutationsList) {
      if (mutation.type === 'reconfigured' && mutation.name === 'getUserMedia' && mutation.object === navigator.mediaDevices) {
        interceptGetUserMedia();
      } else if (mutation.type === 'attributes' && mutation.attributeName === 'getUserMedia' && mutation.target === navigator.mediaDevices) {
        interceptGetUserMedia();
      } else if (mutation.type === 'childList' && mutation.addedNodes) {
        mutation.addedNodes.forEach(node => {
          if (node === navigator.mediaDevices) {
            interceptGetUserMedia();
          }
        });
      }
    }
  });

  function interceptSpeechRecognition() {
    if (!window.SpeechRecognition && !window.webkitSpeechRecognition) {
      return;
    }

    const OriginalSpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;

    const SpeechRecognitionWrapper = function(...args) {
      const recognizer = new OriginalSpeechRecognition(...args);
      const originalStart = recognizer.start.bind(recognizer);

      recognizer.start = function() {
        requestMediaPermissions({ audio: true }).then(granted => {
          if (granted) {
            originalStart();
          } else {
            const errorEvent = new SpeechRecognitionErrorEvent('error');
            errorEvent.error = 'not-allowed'; // This is the standard error for permission denial.
            recognizer.dispatchEvent(errorEvent);
          }
        });
      };

      return recognizer;
    };

    SpeechRecognitionWrapper.prototype = OriginalSpeechRecognition.prototype;
    SpeechRecognitionWrapper.prototype.constructor = SpeechRecognitionWrapper;

    if (window.SpeechRecognition) {
      window.SpeechRecognition = SpeechRecognitionWrapper;
    }
    if (window.webkitSpeechRecognition) {
      window.webkitSpeechRecognition = SpeechRecognitionWrapper;
    }
  }

  interceptSpeechRecognition();

  window.addEventListener('message', function(event) {
    if (event.data) {
      if (event.data.type === 'resolveMediaPermission') {
        const { promiseId, granted } = event.data;
        if (pendingMediaResolvers[promiseId]) {
          pendingMediaResolvers[promiseId](granted);
        }
      }
    }
  });

})();</script><script>((function(modelInformation) {
  const originalFetch = window.fetch;
  // TODO: b/421908508 - Move these out of the script and match all generative AI model calls.
  let googleLlmBaseApiUrls = [
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.textModelName + ':streamGenerateContent',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.textModelName + ':generateContent',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.imageModelName + ':predict',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.imageModelName + ':predictLongRunning',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.imageEditModelName + ':generateContent',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.imageTransformModelName + ':generateContent',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.videoModelName + ':predict',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.videoModelName + ':predictLongRunning',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.ttsModelName + ':generateContent',
  ];
  modelInformation.deprecatedTextModelNames.forEach((modelName) => {
    googleLlmBaseApiUrls.push(
      'https://generativelanguage.googleapis.com/v1beta/models/' + modelName + ':streamGenerateContent',
      'https://generativelanguage.googleapis.com/v1beta/models/' + modelName + ':generateContent',
    );
  });
  modelInformation.deprecatedImageModelNames.forEach((modelName) => {
    googleLlmBaseApiUrls.push(
      'https://generativelanguage.googleapis.com/v1beta/models/' + modelName + ':predict',
      'https://generativelanguage.googleapis.com/v1beta/models/' + modelName + ':predictLongRunning',
    );
  });

  const pendingFetchResolvers = {};
  let nextPromiseId = 0;

  function handleStringInput(input, optionsArgument) {
    const actualUrl = input;
    const fetchCallArgs = [actualUrl, optionsArgument];
    const effectiveOptions = optionsArgument || {};
    const bodyForApiKeyCheck = effectiveOptions.body;
    const bodyForPostMessage = effectiveOptions.body;
    return { actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage };
  }

  function handleRequestInput(input, optionsArgument) {
    const actualUrl = input.url;
    const fetchCallArgs = [input, optionsArgument];
    const effectiveOptions = { method: input.method, headers: new Headers(input.headers) };
    let bodyForApiKeyCheck;
    let bodyForPostMessage;

    if (optionsArgument) {
      if (optionsArgument.method) effectiveOptions.method = optionsArgument.method;
      if (optionsArgument.headers) effectiveOptions.headers = new Headers(optionsArgument.headers);
      if ('body' in optionsArgument) {
        bodyForApiKeyCheck = optionsArgument.body;
        bodyForPostMessage = optionsArgument.body;
      } else {
        bodyForApiKeyCheck = undefined;
        bodyForPostMessage = input.body;
      }
    } else {
      bodyForApiKeyCheck = undefined;
      bodyForPostMessage = input.body;
    }
    return { actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage };
  }

  window.fetch = function(input, optionsArgument) {
    let actualUrl;
    let fetchCallArgs;
    let effectiveOptions = {};
    let bodyForApiKeyCheck;
    let bodyForPostMessage;

    if (typeof input === 'string') {
      ({actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage} = handleStringInput(input, optionsArgument));
    } else if (input instanceof Request) {
      ({actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage} = handleRequestInput(input, optionsArgument));
    } else {
      return originalFetch.apply(window, [input, optionsArgument]);
    }

    effectiveOptions.method = effectiveOptions.method || 'GET';
    if (!effectiveOptions.headers) {
      effectiveOptions.headers = new Headers();
    }


    if (typeof actualUrl === 'string' && googleLlmBaseApiUrls.some((url) => actualUrl.startsWith(url))) {
      let apiKeyIsNull = true;

      const regex = new RegExp("models/([^:]+)");
      const modelNameMatch = actualUrl.match(regex);
      const modelName = modelNameMatch ? modelNameMatch[1] : 'unspecified';


      try {
        const urlObject = new URL(actualUrl);  // Use URL object for robust parsing
        const apiKeyParam = urlObject.searchParams.get('key');
        if (apiKeyParam) {
          apiKeyIsNull = false;
        }
      } catch (e) {
        // Continue checks even if URL parsing fails
      }

      if (apiKeyIsNull && effectiveOptions.headers) {
        const h = new Headers(effectiveOptions.headers);
        const apiKeyHeaderValue = h.get('X-API-Key') || h.get('x-api-key');
        if (apiKeyHeaderValue) {
          apiKeyIsNull = false;
          return originalFetch.apply(window, fetchCallArgs);
        }
      }

      if (apiKeyIsNull && effectiveOptions.method && ['POST', 'PUT', 'PATCH'].includes(effectiveOptions.method.toUpperCase()) && typeof bodyForApiKeyCheck === 'string') {
        try {
          const bodyData = JSON.parse(bodyForApiKeyCheck);
          if (bodyData && bodyData.apiKey) {
            apiKeyIsNull = false;
            return originalFetch.apply(window, fetchCallArgs);
          }
        } catch (e) {
          // Ignore JSON parsing errors
        }
      }

      if(apiKeyIsNull) {
        const promiseId = nextPromiseId++;
        const promise = new Promise((resolve) => {
          pendingFetchResolvers[promiseId] = (resolvedResponse) => {
            delete pendingFetchResolvers[promiseId];
            resolve(resolvedResponse);
          };
        });

        let serializedBodyForPostMessage;
        if (typeof bodyForPostMessage === 'string' || bodyForPostMessage == null) {
            serializedBodyForPostMessage = bodyForPostMessage;
        } else if (bodyForPostMessage instanceof ReadableStream) {
            serializedBodyForPostMessage = null;
        } else {
            try {
                serializedBodyForPostMessage = JSON.stringify(bodyForPostMessage);
            } catch (e) {
                serializedBodyForPostMessage = null;
            }
        }

        const messageOptions = {
            method: effectiveOptions.method,
            headers: Object.fromEntries(new Headers(effectiveOptions.headers).entries()),
            body: serializedBodyForPostMessage
        };

        window.parent.postMessage({
          type: 'requestFetch',
          url: actualUrl,
          modelName: modelName,
          options: messageOptions,
          promiseId: promiseId,
        }, '*');

        return promise;
      }
      return originalFetch.apply(window, fetchCallArgs);
    }
    return originalFetch.apply(window, fetchCallArgs);
  };

  window.addEventListener('message', function(event) {
    if (event.data && event.data.type === 'resolveFetch') {
      const { promiseId, response } = event.data;
      if (pendingFetchResolvers[promiseId]) {
        try {
          const reconstructedResponse = new Response(response.body, {
            status: response.status,
            statusText: response.statusText,
            headers: new Headers(response.headers),
          });
          pendingFetchResolvers[promiseId](reconstructedResponse);
        } catch (error) {
          pendingFetchResolvers[promiseId](new Response(null, { status: 500, statusText: "Interceptor Response Reconstruction Error" }));
        }
      }
    }
  });

}))({"textModelName":"gemini-2.5-flash-preview-09-2025","imageModelName":"imagen-4.0-generate-001","imageEditModelName":"gemini-2.5-flash-image-preview","imageTransformModelName":"gemini-3-pro-image-preview-11-2025","videoModelName":"veo-2.0-generate-001","ttsModelName":"gemini-2.5-flash-preview-tts","deprecatedTextModelNames":["gemini-2.0-flash","gemini-2.5-flash-preview-04-17","gemini-2.5-flash-preview-05-20"],"deprecatedImageModelNames":["imagen-3.0-generate-001","imagen-3.0-generate-002"]})</script><script>(function() {
  const originalConsoleLog = console.log;
  const originalConsoleError = console.error;

    /**
   * Normalizes an error event or a promise rejection reason into a structured error object.
   * @param {*} errorEventOrReason The error object or reason.
   * @return {object} Structured error data { message, name, stack }.
   */
  function getErrorObject(errorEventOrReason) {
    if (errorEventOrReason instanceof Error) {
      return {
        message: errorEventOrReason.message,
        name: errorEventOrReason.name,
        stack: errorEventOrReason.stack,
      };
    }
    // Fallback for non-Error objects.
    try {
      return {
        message: JSON.stringify(errorEventOrReason),
        name: 'UnknownErrorType',
        stack: null,
      };
    } catch (e) {
      return {
        message: String(errorEventOrReason),
        name: 'UnknownErrorTypeNonStringifiable',
        stack: null,
      };
    }
  }

  /**
   * Converts an array of arguments (from log/error) into a single string.
   * Handles Error objects specially to include their message and stack.
   * @param {Array<*>} args - Arguments passed to console methods.
   * @return {string} A string representation of the arguments.
   */
  function stringifyArgs(args) {
    return args
      .map((arg) => {
        if (arg instanceof Error) {
          const {message, stack} = arg;
          return `Error: ${message}${stack ? ('\nStack: ' + stack) : ''}`;
        }
        if (typeof arg === 'object' && arg !== null) {
          try {
            return JSON.stringify(arg);
          } catch (error) {
            return '[Circular Object]';
          }
        } else {
          return String(arg);
        }
      })
      .join(' ');
  }

  console.log = function(...args) {
    const logString = stringifyArgs(args);
    window.parent.postMessage({ type: 'log', message: logString }, '*');
    originalConsoleLog.apply(console, args);
  };

  console.error = function(...args) {
    let errorData;
    if (args.length > 0 && args[0] instanceof Error) {
      const err = args[0];
      // If the first arg is an Error, capture its details.
      errorData = {
        type: 'error',
        source: 'CONSOLE_ERROR',
        ...getErrorObject(err),
        rawArgsString: stringifyArgs(args.slice(1)),
        timestamp: new Date().toISOString(),
      };
    } else {
      // If not an Error object, treat all args as a general error message.
      errorData = {
        type: 'error',
        source: 'CONSOLE_ERROR',
        message: stringifyArgs(args),
        name: 'ConsoleLoggedError',
        stack: null,
        timestamp: new Date().toISOString(),
      };
    }
    window.parent.postMessage(errorData, '*');
    originalConsoleError.apply(console, args);
  };

  // Listen for global unhandled synchronous errors.
  window.addEventListener('error', function(event) {
    const errorDetails = event.error ? getErrorObject(event.error) : {
      message: event.message,
      name: 'GlobalError',
      stack: null,
      filename: event.filename,
      lineno: event.lineno,
      colno: event.colno,
    };

    window.parent.postMessage({
      type: 'error',
      source: 'global',
      ...errorDetails,
      message: errorDetails.message || event.message,
      timestamp: new Date().toISOString(),
    }, '*');
  });

  // Listen for unhandled promise rejections (asynchronous errors).
  window.addEventListener('unhandledrejection', function(event) {
    const errorDetails = getErrorObject(event.reason);

    window.parent.postMessage({
      type: 'error',
      source: 'unhandledrejection',
      ...errorDetails,
      message: errorDetails.message || 'Unhandled Promise Rejection',
      timestamp: new Date().toISOString(),
    }, '*');
  });

})();</script>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="theme-color" content="#fafaf9">
<title>Kotobako</title>
<script src="https://cdn.tailwindcss.com"></script>
<script>
  tailwind.config = {
    darkMode: 'class',
    theme: {
      extend: {
        colors: {
          stone: {
            850: '#1f1c1a', // カスタム: 深い墨色
            950: '#0c0a09',
          }
        },
        fontFamily: {
          serif: ['"Noto Serif JP"', 'serif'],
        },
        animation: {
          'fade-in': 'fadeIn 0.3s ease-out',
          'float-up': 'floatUp 0.6s cubic-bezier(0.16, 1, 0.3, 1) forwards',
        },
        keyframes: {
          fadeIn: {
            'from': { opacity: '0' },
            'to': { opacity: '1' },
          },
          floatUp: {
            'from': { transform: 'translateY(100px)', opacity: '0' },
            'to': { transform: 'translateY(0)', opacity: '1' },
          }
        }
      }
    }
  }
</script>
<link href="https://fonts.googleapis.com/css2?family=Noto+Serif+JP:wght@400;700&amp;display=swap" rel="stylesheet">
<!-- Import Map -->
<script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@18.2.0",
    "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
    "lucide-react": "https://esm.sh/lucide-react@0.263.1",
    "firebase/app": "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js",
    "firebase/auth": "https://www.gstatic.com/firebasejs/9.22.0/firebase-auth.js",
    "firebase/firestore": "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js"
  }
}
</script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js" crossorigin="anonymous"></script>
<style>
  body { font-family: 'Noto Serif JP', serif; -webkit-tap-highlight-color: transparent; }
  .pb-safe-area { padding-bottom: env(safe-area-inset-bottom); }
  .no-scrollbar::-webkit-scrollbar { display: none; }
  .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
  textarea::placeholder, input::placeholder { color: #d6d3d1; }
  /* Dark mode placeholder override */
  .dark textarea::placeholder, .dark input::placeholder { color: #57534e; }
</style>
<style>*, ::before, ::after{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }/* ! tailwindcss v3.4.17 | MIT License | https://tailwindcss.com */*,::after,::before{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}::after,::before{--tw-content:''}:host,html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;font-family:ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]:where(:not([hidden=until-found])){display:none}.pointer-events-none{pointer-events:none}.pointer-events-auto{pointer-events:auto}.fixed{position:fixed}.absolute{position:absolute}.relative{position:relative}.inset-0{inset:0px}.bottom-6{bottom:1.5rem}.left-0{left:0px}.right-0{right:0px}.top-0{top:0px}.left-1\/2{left:50%}.top-20{top:5rem}.z-40{z-index:40}.z-50{z-index:50}.z-\[100\]{z-index:100}.z-\[60\]{z-index:60}.mx-auto{margin-left:auto;margin-right:auto}.-mr-2{margin-right:-0.5rem}.mb-4{margin-bottom:1rem}.mb-1{margin-bottom:0.25rem}.mt-2{margin-top:0.5rem}.line-clamp-3{overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:3}.flex{display:flex}.grid{display:grid}.h-screen{height:100vh}.h-16{height:4rem}.h-\[100dvh\]{height:100dvh}.h-full{height:100%}.h-48{height:12rem}.max-h-\[80vh\]{max-height:80vh}.min-h-\[8rem\]{min-height:8rem}.w-20{width:5rem}.w-full{width:100%}.max-w-md{max-width:28rem}.max-w-sm{max-width:24rem}.flex-grow{flex-grow:1}.-translate-x-1\/2{--tw-translate-x:-50%;transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.transform{transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}@keyframes floatUp{from{transform:translateY(100px);opacity:0}to{transform:translateY(0);opacity:1}}.animate-float-up{animation:floatUp 0.6s cubic-bezier(0.16, 1, 0.3, 1) forwards}@keyframes fadeIn{from{opacity:0}to{opacity:1}}.animate-fade-in{animation:fadeIn 0.3s ease-out}.cursor-default{cursor:default}.cursor-not-allowed{cursor:not-allowed}.cursor-pointer{cursor:pointer}.select-none{-webkit-user-select:none;user-select:none}.resize-none{resize:none}.grid-cols-2{grid-template-columns:repeat(2, minmax(0, 1fr))}.flex-col{flex-direction:column}.items-end{align-items:flex-end}.items-center{align-items:center}.justify-start{justify-content:flex-start}.justify-end{justify-content:flex-end}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.gap-1{gap:0.25rem}.gap-3{gap:0.75rem}.gap-2{gap:0.5rem}.gap-6{gap:1.5rem}.gap-1\.5{gap:0.375rem}.space-y-3 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(0.75rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(0.75rem * var(--tw-space-y-reverse))}.space-y-6 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(1.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(1.5rem * var(--tw-space-y-reverse))}.space-y-2 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(0.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(0.5rem * var(--tw-space-y-reverse))}.overflow-hidden{overflow:hidden}.overflow-y-auto{overflow-y:auto}.whitespace-pre-wrap{white-space:pre-wrap}.rounded-full{border-radius:9999px}.rounded{border-radius:0.25rem}.rounded-lg{border-radius:0.5rem}.rounded-2xl{border-radius:1rem}.rounded-xl{border-radius:0.75rem}.border{border-width:1px}.border-b{border-bottom-width:1px}.border-t{border-top-width:1px}.border-stone-200{--tw-border-opacity:1;border-color:rgb(231 229 228 / var(--tw-border-opacity, 1))}.border-stone-700{--tw-border-opacity:1;border-color:rgb(68 64 60 / var(--tw-border-opacity, 1))}.border-stone-800{--tw-border-opacity:1;border-color:rgb(41 37 36 / var(--tw-border-opacity, 1))}.border-stone-100{--tw-border-opacity:1;border-color:rgb(245 245 244 / var(--tw-border-opacity, 1))}.border-stone-200\/50{border-color:rgb(231 229 228 / 0.5)}.border-stone-50{--tw-border-opacity:1;border-color:rgb(250 250 249 / var(--tw-border-opacity, 1))}.bg-stone-50{--tw-bg-opacity:1;background-color:rgb(250 250 249 / var(--tw-bg-opacity, 1))}.bg-stone-50\/90{background-color:rgb(250 250 249 / 0.9)}.bg-stone-900{--tw-bg-opacity:1;background-color:rgb(28 25 23 / var(--tw-bg-opacity, 1))}.bg-stone-200{--tw-bg-opacity:1;background-color:rgb(231 229 228 / var(--tw-bg-opacity, 1))}.bg-stone-800{--tw-bg-opacity:1;background-color:rgb(41 37 36 / var(--tw-bg-opacity, 1))}.bg-transparent{background-color:transparent}.bg-white{--tw-bg-opacity:1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}.bg-stone-100{--tw-bg-opacity:1;background-color:rgb(245 245 244 / var(--tw-bg-opacity, 1))}.bg-stone-100\/80{background-color:rgb(245 245 244 / 0.8)}.bg-stone-900\/20{background-color:rgb(28 25 23 / 0.2)}.p-2{padding:0.5rem}.p-6{padding:1.5rem}.p-2\.5{padding:0.625rem}.p-4{padding:1rem}.px-6{padding-left:1.5rem;padding-right:1.5rem}.px-8{padding-left:2rem;padding-right:2rem}.py-4{padding-top:1rem;padding-bottom:1rem}.px-2{padding-left:0.5rem;padding-right:0.5rem}.py-2{padding-top:0.5rem;padding-bottom:0.5rem}.py-3{padding-top:0.75rem;padding-bottom:0.75rem}.px-1{padding-left:0.25rem;padding-right:0.25rem}.px-3{padding-left:0.75rem;padding-right:0.75rem}.px-4{padding-left:1rem;padding-right:1rem}.px-5{padding-left:1.25rem;padding-right:1.25rem}.py-1{padding-top:0.25rem;padding-bottom:0.25rem}.py-1\.5{padding-top:0.375rem;padding-bottom:0.375rem}.pb-32{padding-bottom:8rem}.pb-24{padding-bottom:6rem}.pb-4{padding-bottom:1rem}.pt-6{padding-top:1.5rem}.pt-8{padding-top:2rem}.pt-3{padding-top:0.75rem}.pt-4{padding-top:1rem}.text-left{text-align:left}.text-center{text-align:center}.font-serif{font-family:"Noto Serif JP", serif}.font-sans{font-family:ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"}.font-mono{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace}.text-sm{font-size:0.875rem;line-height:1.25rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-xs{font-size:0.75rem;line-height:1rem}.text-\[10px\]{font-size:10px}.text-base{font-size:1rem;line-height:1.5rem}.font-bold{font-weight:700}.font-medium{font-weight:500}.uppercase{text-transform:uppercase}.italic{font-style:italic}.leading-relaxed{line-height:1.625}.tracking-tight{letter-spacing:-0.025em}.tracking-widest{letter-spacing:0.1em}.tracking-wide{letter-spacing:0.025em}.tracking-wider{letter-spacing:0.05em}.text-stone-400{--tw-text-opacity:1;color:rgb(168 162 158 / var(--tw-text-opacity, 1))}.text-stone-50{--tw-text-opacity:1;color:rgb(250 250 249 / var(--tw-text-opacity, 1))}.text-stone-800{--tw-text-opacity:1;color:rgb(41 37 36 / var(--tw-text-opacity, 1))}.text-stone-500{--tw-text-opacity:1;color:rgb(120 113 108 / var(--tw-text-opacity, 1))}.text-stone-600{--tw-text-opacity:1;color:rgb(87 83 78 / var(--tw-text-opacity, 1))}.text-stone-300{--tw-text-opacity:1;color:rgb(214 211 209 / var(--tw-text-opacity, 1))}.shadow-2xl{--tw-shadow:0 25px 50px -12px rgb(0 0 0 / 0.25);--tw-shadow-colored:0 25px 50px -12px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.shadow-sm{--tw-shadow:0 1px 2px 0 rgb(0 0 0 / 0.05);--tw-shadow-colored:0 1px 2px 0 var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.shadow-md{--tw-shadow:0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 4px 6px -1px var(--tw-shadow-color), 0 2px 4px -2px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.shadow-lg{--tw-shadow:0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.shadow-xl{--tw-shadow:0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 20px 25px -5px var(--tw-shadow-color), 0 8px 10px -6px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.backdrop-blur-md{--tw-backdrop-blur:blur(12px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.backdrop-blur-sm{--tw-backdrop-blur:blur(4px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.transition-colors{transition-property:color, background-color, border-color, fill, stroke, -webkit-text-decoration-color;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, -webkit-text-decoration-color;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.transition-all{transition-property:all;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.transition-opacity{transition-property:opacity;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.transition-transform{transition-property:transform;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.duration-300{transition-duration:300ms}.duration-200{transition-duration:200ms}.selection\:bg-stone-200 *::selection{--tw-bg-opacity:1;background-color:rgb(231 229 228 / var(--tw-bg-opacity, 1))}.selection\:bg-stone-200::selection{--tw-bg-opacity:1;background-color:rgb(231 229 228 / var(--tw-bg-opacity, 1))}.placeholder\:text-stone-200::placeholder{--tw-text-opacity:1;color:rgb(231 229 228 / var(--tw-text-opacity, 1))}.placeholder\:text-stone-300::placeholder{--tw-text-opacity:1;color:rgb(214 211 209 / var(--tw-text-opacity, 1))}.hover\:border-stone-400:hover{--tw-border-opacity:1;border-color:rgb(168 162 158 / var(--tw-border-opacity, 1))}.hover\:border-stone-300:hover{--tw-border-opacity:1;border-color:rgb(214 211 209 / var(--tw-border-opacity, 1))}.hover\:bg-stone-800:hover{--tw-bg-opacity:1;background-color:rgb(41 37 36 / var(--tw-bg-opacity, 1))}.hover\:bg-stone-700:hover{--tw-bg-opacity:1;background-color:rgb(68 64 60 / var(--tw-bg-opacity, 1))}.hover\:bg-stone-200:hover{--tw-bg-opacity:1;background-color:rgb(231 229 228 / var(--tw-bg-opacity, 1))}.hover\:bg-stone-50:hover{--tw-bg-opacity:1;background-color:rgb(250 250 249 / var(--tw-bg-opacity, 1))}.hover\:text-stone-800:hover{--tw-text-opacity:1;color:rgb(41 37 36 / var(--tw-text-opacity, 1))}.hover\:text-stone-600:hover{--tw-text-opacity:1;color:rgb(87 83 78 / var(--tw-text-opacity, 1))}.focus\:border-stone-400:focus{--tw-border-opacity:1;border-color:rgb(168 162 158 / var(--tw-border-opacity, 1))}.focus\:outline-none:focus{outline:2px solid transparent;outline-offset:2px}.active\:scale-95:active{--tw-scale-x:.95;--tw-scale-y:.95;transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.active\:scale-\[0\.98\]:active{--tw-scale-x:0.98;--tw-scale-y:0.98;transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.active\:bg-stone-50:active{--tw-bg-opacity:1;background-color:rgb(250 250 249 / var(--tw-bg-opacity, 1))}.active\:text-stone-800:active{--tw-text-opacity:1;color:rgb(41 37 36 / var(--tw-text-opacity, 1))}.active\:opacity-70:active{opacity:0.7}.group:hover .group-hover\:rotate-12{--tw-rotate:12deg;transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.group:hover .group-hover\:text-stone-50{--tw-text-opacity:1;color:rgb(250 250 249 / var(--tw-text-opacity, 1))}.dark\:border-stone-600:is(.dark *){--tw-border-opacity:1;border-color:rgb(87 83 78 / var(--tw-border-opacity, 1))}.dark\:border-stone-800:is(.dark *){--tw-border-opacity:1;border-color:rgb(41 37 36 / var(--tw-border-opacity, 1))}.dark\:border-stone-700:is(.dark *){--tw-border-opacity:1;border-color:rgb(68 64 60 / var(--tw-border-opacity, 1))}.dark\:border-stone-700\/50:is(.dark *){border-color:rgb(68 64 60 / 0.5)}.dark\:bg-stone-900:is(.dark *){--tw-bg-opacity:1;background-color:rgb(28 25 23 / var(--tw-bg-opacity, 1))}.dark\:bg-stone-700:is(.dark *){--tw-bg-opacity:1;background-color:rgb(68 64 60 / var(--tw-bg-opacity, 1))}.dark\:bg-stone-900\/90:is(.dark *){background-color:rgb(28 25 23 / 0.9)}.dark\:bg-stone-800:is(.dark *){--tw-bg-opacity:1;background-color:rgb(41 37 36 / var(--tw-bg-opacity, 1))}.dark\:bg-stone-800\/80:is(.dark *){background-color:rgb(41 37 36 / 0.8)}.dark\:bg-stone-850:is(.dark *){--tw-bg-opacity:1;background-color:rgb(31 28 26 / var(--tw-bg-opacity, 1))}.dark\:bg-black\/60:is(.dark *){background-color:rgb(0 0 0 / 0.6)}.dark\:text-stone-500:is(.dark *){--tw-text-opacity:1;color:rgb(120 113 108 / var(--tw-text-opacity, 1))}.dark\:text-stone-100:is(.dark *){--tw-text-opacity:1;color:rgb(245 245 244 / var(--tw-text-opacity, 1))}.dark\:text-stone-200:is(.dark *){--tw-text-opacity:1;color:rgb(231 229 228 / var(--tw-text-opacity, 1))}.dark\:text-stone-400:is(.dark *){--tw-text-opacity:1;color:rgb(168 162 158 / var(--tw-text-opacity, 1))}.dark\:text-stone-600:is(.dark *){--tw-text-opacity:1;color:rgb(87 83 78 / var(--tw-text-opacity, 1))}.dark\:selection\:bg-stone-700 *:is(.dark *)::selection{--tw-bg-opacity:1;background-color:rgb(68 64 60 / var(--tw-bg-opacity, 1))}.dark\:selection\:bg-stone-700:is(.dark *)::selection{--tw-bg-opacity:1;background-color:rgb(68 64 60 / var(--tw-bg-opacity, 1))}.dark\:placeholder\:text-stone-600:is(.dark *)::placeholder{--tw-text-opacity:1;color:rgb(87 83 78 / var(--tw-text-opacity, 1))}.dark\:placeholder\:text-stone-700:is(.dark *)::placeholder{--tw-text-opacity:1;color:rgb(68 64 60 / var(--tw-text-opacity, 1))}.dark\:hover\:border-stone-500:hover:is(.dark *){--tw-border-opacity:1;border-color:rgb(120 113 108 / var(--tw-border-opacity, 1))}.dark\:hover\:border-stone-600:hover:is(.dark *){--tw-border-opacity:1;border-color:rgb(87 83 78 / var(--tw-border-opacity, 1))}.dark\:hover\:bg-stone-600:hover:is(.dark *){--tw-bg-opacity:1;background-color:rgb(87 83 78 / var(--tw-bg-opacity, 1))}.dark\:hover\:bg-stone-700\/80:hover:is(.dark *){background-color:rgb(68 64 60 / 0.8)}.dark\:hover\:bg-stone-800:hover:is(.dark *){--tw-bg-opacity:1;background-color:rgb(41 37 36 / var(--tw-bg-opacity, 1))}.dark\:hover\:text-stone-200:hover:is(.dark *){--tw-text-opacity:1;color:rgb(231 229 228 / var(--tw-text-opacity, 1))}.dark\:hover\:text-stone-300:hover:is(.dark *){--tw-text-opacity:1;color:rgb(214 211 209 / var(--tw-text-opacity, 1))}.dark\:focus\:border-stone-500:focus:is(.dark *){--tw-border-opacity:1;border-color:rgb(120 113 108 / var(--tw-border-opacity, 1))}.dark\:active\:bg-stone-800:active:is(.dark *){--tw-bg-opacity:1;background-color:rgb(41 37 36 / var(--tw-bg-opacity, 1))}.dark\:active\:text-stone-200:active:is(.dark *){--tw-text-opacity:1;color:rgb(231 229 228 / var(--tw-text-opacity, 1))}.group:hover .dark\:group-hover\:text-stone-400:is(.dark *){--tw-text-opacity:1;color:rgb(168 162 158 / var(--tw-text-opacity, 1))}@media (min-width: 640px){.sm\:items-center{align-items:center}}</style><script type="module">function ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }
function _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }
function _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }
function _toPropertyKey(t) { var i = _toPrimitive(t, "string"); return "symbol" == typeof i ? i : i + ""; }
function _toPrimitive(t, r) { if ("object" != typeof t || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || "default"); if ("object" != typeof i) return i; throw new TypeError("@@toPrimitive must return a primitive value."); } return ("string" === r ? String : Number)(t); }
function asyncGeneratorStep(n, t, e, r, o, a, c) { try { var i = n[a](c), u = i.value; } catch (n) { return void e(n); } i.done ? t(u) : Promise.resolve(u).then(r, o); }
function _asyncToGenerator(n) { return function () { var t = this, e = arguments; return new Promise(function (r, o) { var a = n.apply(t, e); function _next(n) { asyncGeneratorStep(a, r, o, _next, _throw, "next", n); } function _throw(n) { asyncGeneratorStep(a, r, o, _next, _throw, "throw", n); } _next(void 0); }); }; }
import React, { useState, useEffect, useRef } from 'react';
import { createRoot } from 'react-dom/client';
import * as LucideIcons from 'lucide-react';
import { initializeApp } from 'firebase/app';
import { getAuth, signInAnonymously, onAuthStateChanged, setPersistence, browserLocalPersistence } from 'firebase/auth';
import { getFirestore, collection, doc, setDoc, getDoc, getDocs, addDoc, updateDoc, deleteDoc, onSnapshot, query } from 'firebase/firestore';
var {
  PenLine,
  Sparkles,
  Check,
  ChevronRight,
  ChevronLeft,
  ArrowLeft,
  Edit2,
  Trash2,
  Menu,
  Copy,
  RefreshCw,
  X,
  AlertCircle,
  Moon,
  Sun,
  ListFilter
} = LucideIcons;
var firebaseConfig = {
  "apiKey": "AIzaSyBLw99hdYwzQKaWFacV3HdIAsa_adAna9k",
  "authDomain": "kotobako-ec686.firebaseapp.com",
  "projectId": "kotobako-ec686",
  "storageBucket": "kotobako-ec686.firebasestorage.app",
  "messagingSenderId": "836620257824",
  "appId": "1:836620257824:web:5a76bf0e646e37f1fb4a45",
  "measurementId": "G-9XDCCZ1BDM"
};
var app = initializeApp(firebaseConfig);
var auth = getAuth(app);
var db = getFirestore(app);
var appId = 'koto-no-ha-app';
var CATEGORIES = ["心に残った", "新たな気づき", "おもしろい", "役立ちそう"];
var generateShortCode = () => {
  var chars = 'ABCDEFGHJKLMNPQRSTUVWXYZ23456789';
  var result = '';
  for (var i = 0; i < 4; i++) result += chars.charAt(Math.floor(Math.random() * chars.length));
  result += '-';
  for (var _i = 0; _i < 4; _i++) result += chars.charAt(Math.floor(Math.random() * chars.length));
  return result;
};
var Header = _ref => {
  var {
    onTitleClick,
    leftActions,
    rightActions
  } = _ref;
  return /*#__PURE__*/React.createElement("header", {
    className: "fixed top-0 left-0 right-0 z-50 h-16 bg-stone-50/90 dark:bg-stone-900/90 backdrop-blur-md border-b border-stone-200 dark:border-stone-800 px-6 flex items-center justify-between shadow-sm transition-colors duration-300"
  }, /*#__PURE__*/React.createElement("div", {
    className: "w-20 flex justify-start items-center"
  }, leftActions), /*#__PURE__*/React.createElement("h1", {
    onClick: onTitleClick,
    className: "text-xl font-serif font-bold tracking-tight text-stone-800 dark:text-stone-200 cursor-default select-none active:opacity-70 transition-opacity",
    title: "\u30C8\u30EA\u30D7\u30EB\u30AF\u30EA\u30C3\u30AF\u3067\u30C0\u30A6\u30F3\u30ED\u30FC\u30C9"
  }, "Kotobako"), /*#__PURE__*/React.createElement("div", {
    className: "w-20 flex justify-end items-center gap-1"
  }, rightActions));
};
var SyncSettingsView = _ref2 => {
  var {
    currentShortCode,
    isLoadingCode,
    errorMsg,
    onRetryCode,
    onSyncCode,
    onRequestReset,
    showToast
  } = _ref2;
  var [inputId, setInputId] = useState('');
  var handleCopy = () => {
    if (!currentShortCode || currentShortCode.length < 8) return;
    navigator.clipboard.writeText(currentShortCode);
    showToast("同期コードをコピーしました");
  };
  return /*#__PURE__*/React.createElement("div", {
    className: "flex flex-col h-full max-w-md mx-auto p-6 pt-6 pb-24 animate-fade-in overflow-y-auto no-scrollbar"
  }, /*#__PURE__*/React.createElement("div", {
    className: "space-y-8"
  }, /*#__PURE__*/React.createElement("div", {
    className: "space-y-3"
  }, /*#__PURE__*/React.createElement("label", {
    className: "text-stone-500 dark:text-stone-400 text-[10px] font-bold tracking-widest uppercase block ml-1"
  }, "\u3042\u306A\u305F\u306E\u540C\u671F\u30B3\u30FC\u30C9"), /*#__PURE__*/React.createElement("div", {
    className: "flex items-center gap-2 bg-white dark:bg-stone-800 p-4 rounded-xl border border-stone-200 dark:border-stone-700 shadow-sm transition-colors duration-300"
  }, /*#__PURE__*/React.createElement("code", {
    className: "flex-grow text-xl font-mono font-bold text-stone-800 dark:text-stone-200 tracking-tighter text-center"
  }, isLoadingCode ? '...' : errorMsg ? 'エラー' : currentShortCode), /*#__PURE__*/React.createElement("button", {
    onClick: handleCopy,
    disabled: !currentShortCode || currentShortCode.includes('...'),
    className: "p-2 text-stone-400 hover:text-stone-800 dark:hover:text-stone-200 bg-stone-50 dark:bg-stone-700 rounded-lg active:scale-95 transition-all disabled:opacity-30"
  }, /*#__PURE__*/React.createElement(Copy, {
    size: 20
  }))), errorMsg && /*#__PURE__*/React.createElement("div", {
    className: "flex items-center justify-center gap-2 text-red-400 text-xs mt-2"
  }, /*#__PURE__*/React.createElement(AlertCircle, {
    size: 14
  }), /*#__PURE__*/React.createElement("span", null, errorMsg), /*#__PURE__*/React.createElement("button", {
    onClick: onRetryCode,
    className: "underline"
  }, "\u518D\u8A66\u884C")), /*#__PURE__*/React.createElement("p", {
    className: "text-[10px] text-stone-400 dark:text-stone-500 leading-relaxed italic px-1"
  }, "\u3053\u306E8\u6587\u5B57\u3092\u5225\u306E\u7AEF\u672B\u3067\u5165\u529B\u3059\u308B\u3068\u3001\u8A00\u8449\u3092\u540C\u671F\u3067\u304D\u307E\u3059\u3002")), /*#__PURE__*/React.createElement("div", {
    className: "relative"
  }, /*#__PURE__*/React.createElement("div", {
    className: "absolute inset-0 flex items-center"
  }, /*#__PURE__*/React.createElement("div", {
    className: "w-full border-t border-stone-100 dark:border-stone-800"
  })), /*#__PURE__*/React.createElement("div", {
    className: "relative flex justify-center text-[10px] uppercase"
  }, /*#__PURE__*/React.createElement("span", {
    className: "bg-stone-50 dark:bg-stone-900 px-3 text-stone-300 dark:text-stone-600 font-bold tracking-widest transition-colors duration-300"
  }, "or"))), /*#__PURE__*/React.createElement("div", {
    className: "space-y-4"
  }, /*#__PURE__*/React.createElement("label", {
    className: "text-stone-500 dark:text-stone-400 text-[10px] font-bold tracking-widest uppercase block ml-1"
  }, "\u5225\u306E\u30B3\u30FC\u30C9\u3068\u540C\u671F\u3059\u308B"), /*#__PURE__*/React.createElement("input", {
    type: "text",
    value: inputId,
    onChange: e => setInputId(e.target.value.toUpperCase()),
    placeholder: "\u4F8B: ABCD-1234",
    className: "w-full bg-white dark:bg-stone-800 border border-stone-200 dark:border-stone-700 p-4 rounded-xl text-lg text-center focus:outline-none focus:border-stone-400 dark:focus:border-stone-500 text-stone-800 dark:text-stone-200 font-mono font-bold shadow-sm transition-colors duration-300"
  }), /*#__PURE__*/React.createElement("button", {
    onClick: () => onSyncCode(inputId),
    disabled: !inputId.trim() || inputId.length < 9,
    className: "w-full py-4 bg-stone-900 dark:bg-stone-700 text-stone-50 dark:text-stone-200 rounded-xl font-bold text-sm tracking-widest disabled:opacity-30 transition-all active:scale-[0.98] shadow-md hover:bg-stone-800 dark:hover:bg-stone-600"
  }, "\u540C\u671F\u3092\u958B\u59CB\u3059\u308B"), /*#__PURE__*/React.createElement("p", {
    className: "text-[10px] text-stone-400 dark:text-stone-500 leading-relaxed italic px-1 text-center"
  }, "\u203B\u5165\u529B\u3057\u305F\u30B3\u30FC\u30C9\u306E\u30C7\u30FC\u30BF\u306B\u5207\u308A\u66FF\u308F\u308A\u307E\u3059\u3002")), /*#__PURE__*/React.createElement("div", {
    className: "pt-8 mt-8 border-t border-stone-100 dark:border-stone-800"
  }, /*#__PURE__*/React.createElement("button", {
    onClick: onRequestReset,
    className: "w-full py-4 text-red-400 hover:text-red-600 dark:hover:text-red-300 text-xs font-bold tracking-widest transition-colors flex items-center justify-center gap-2"
  }, /*#__PURE__*/React.createElement(Trash2, {
    size: 16
  }), /*#__PURE__*/React.createElement("span", null, "\u5168\u30C7\u30FC\u30BF\u3092\u524A\u9664\u3057\u3066\u521D\u671F\u5316")))));
};
var Toast = _ref3 => {
  var {
    message,
    isVisible,
    onHide
  } = _ref3;
  useEffect(() => {
    if (isVisible) {
      var timer = setTimeout(onHide, 2000);
      return () => clearTimeout(timer);
    }
  }, [isVisible, onHide]);
  if (!isVisible) return null;
  return /*#__PURE__*/React.createElement("div", {
    className: "fixed top-20 left-1/2 transform -translate-x-1/2 z-[100] animate-fade-in pointer-events-none"
  }, /*#__PURE__*/React.createElement("div", {
    className: "bg-stone-800 dark:bg-stone-700 text-stone-50 dark:text-stone-100 px-4 py-2 rounded-full shadow-lg text-sm font-medium flex items-center gap-2 border border-stone-700 dark:border-stone-600"
  }, /*#__PURE__*/React.createElement(Check, {
    size: 14
  }), message));
};
var FilterSheet = _ref4 => {
  var {
    isVisible,
    currentCategory,
    onSelect,
    onClose
  } = _ref4;
  if (!isVisible) return null;
  return /*#__PURE__*/React.createElement("div", {
    className: "fixed inset-0 z-[60] flex items-end justify-center sm:items-center p-4 animate-fade-in"
  }, /*#__PURE__*/React.createElement("div", {
    className: "absolute inset-0 bg-stone-900/20 dark:bg-black/60 backdrop-blur-sm",
    onClick: onClose
  }), /*#__PURE__*/React.createElement("div", {
    className: "relative w-full max-w-sm bg-white dark:bg-stone-850 rounded-2xl p-6 shadow-xl animate-float-up space-y-2 max-h-[80vh] overflow-y-auto no-scrollbar"
  }, /*#__PURE__*/React.createElement("h3", {
    className: "text-xs font-bold text-stone-400 dark:text-stone-500 uppercase tracking-widest mb-4 flex items-center gap-2"
  }, /*#__PURE__*/React.createElement(ListFilter, {
    size: 14
  }), "\u8868\u793A\u3059\u308B\u8A00\u8449\u3092\u9078\u3076"), /*#__PURE__*/React.createElement("button", {
    onClick: () => onSelect(null),
    className: "w-full text-left p-4 rounded-xl transition-all flex justify-between items-center ".concat(!currentCategory ? 'bg-stone-100 dark:bg-stone-800 font-bold text-stone-800 dark:text-stone-200' : 'text-stone-600 dark:text-stone-400 hover:bg-stone-50 dark:hover:bg-stone-800')
  }, /*#__PURE__*/React.createElement("span", null, "\u3059\u3079\u3066\u306E\u8A00\u8449"), !currentCategory && /*#__PURE__*/React.createElement(Check, {
    size: 16
  })), CATEGORIES.map(cat => /*#__PURE__*/React.createElement("button", {
    key: cat,
    onClick: () => onSelect(cat),
    className: "w-full text-left p-4 rounded-xl transition-all flex justify-between items-center ".concat(currentCategory === cat ? 'bg-stone-100 dark:bg-stone-800 font-bold text-stone-800 dark:text-stone-200' : 'text-stone-600 dark:text-stone-400 hover:bg-stone-50 dark:hover:bg-stone-800')
  }, /*#__PURE__*/React.createElement("span", null, cat), currentCategory === cat && /*#__PURE__*/React.createElement(Check, {
    size: 16
  }))), /*#__PURE__*/React.createElement("div", {
    className: "pt-4 mt-2 border-t border-stone-50 dark:border-stone-800"
  }, /*#__PURE__*/React.createElement("button", {
    onClick: onClose,
    className: "w-full py-3 text-stone-400 hover:text-stone-600 dark:hover:text-stone-300 text-xs font-bold tracking-widest"
  }, "\u9589\u3058\u308B"))));
};
var ConfirmDialog = _ref5 => {
  var {
    isVisible,
    title,
    message,
    actionLabel,
    onConfirm,
    onCancel
  } = _ref5;
  if (!isVisible) return null;
  return /*#__PURE__*/React.createElement("div", {
    className: "fixed inset-0 z-[80] flex items-center justify-center p-6 bg-stone-900/40 dark:bg-black/60 backdrop-blur-sm animate-fade-in"
  }, /*#__PURE__*/React.createElement("div", {
    className: "bg-white dark:bg-stone-800 rounded-2xl p-8 max-w-xs w-full shadow-xl text-center"
  }, /*#__PURE__*/React.createElement("h3", {
    className: "text-lg font-bold text-stone-800 dark:text-stone-200 mb-2 font-serif"
  }, title), /*#__PURE__*/React.createElement("p", {
    className: "text-sm text-stone-500 dark:text-stone-400 mb-8 leading-relaxed"
  }, message), /*#__PURE__*/React.createElement("div", {
    className: "space-y-3"
  }, /*#__PURE__*/React.createElement("button", {
    onClick: onConfirm,
    className: "w-full py-3 bg-stone-900 dark:bg-stone-700 text-stone-50 rounded-lg font-bold text-sm hover:bg-stone-800 dark:hover:bg-stone-600 transition-colors"
  }, actionLabel), /*#__PURE__*/React.createElement("button", {
    onClick: onCancel,
    className: "w-full py-3 bg-stone-100 dark:bg-stone-900 text-stone-600 dark:text-stone-400 rounded-lg font-bold text-sm hover:bg-stone-200 dark:hover:bg-stone-950 transition-colors"
  }, "\u30AD\u30E3\u30F3\u30BB\u30EB"))));
};
var FloatingWriteButton = _ref6 => {
  var {
    onClick
  } = _ref6;
  return /*#__PURE__*/React.createElement("div", {
    className: "fixed bottom-6 left-0 right-0 flex justify-center z-40 px-6 pointer-events-none"
  }, /*#__PURE__*/React.createElement("button", {
    onClick: onClick,
    className: "bg-stone-900 dark:bg-stone-700 text-stone-50 dark:text-stone-100 px-8 py-4 rounded-full shadow-2xl flex items-center gap-3 border border-stone-700 dark:border-stone-600 pointer-events-auto active:scale-95 transition-all duration-300 hover:bg-stone-800 dark:hover:bg-stone-600 animate-float-up"
  }, /*#__PURE__*/React.createElement(PenLine, {
    size: 20,
    strokeWidth: 2.5
  }), /*#__PURE__*/React.createElement("span", {
    className: "text-sm font-bold tracking-widest"
  }, "\u8A18\u3059")));
};
var InputView = _ref7 => {
  var {
    onSave,
    initialData = null
  } = _ref7;
  var [text, setText] = useState(initialData ? initialData.text : '');
  var [source, setSource] = useState(initialData ? initialData.source : '');
  var [selectedCategory, setSelectedCategory] = useState(initialData ? initialData.category : CATEGORIES[0]);
  var textareaRef = useRef(null);
  useEffect(() => {
    if (initialData) {
      setText(initialData.text);
      setSource(initialData.source || '');
      setSelectedCategory(initialData.category);
    } else {
      setText('');
      setSource('');
      setSelectedCategory(CATEGORIES[0]);
    }
  }, [initialData]);
  useEffect(() => {
    if (textareaRef.current) {
      textareaRef.current.style.height = 'auto';
      textareaRef.current.style.height = "".concat(textareaRef.current.scrollHeight, "px");
    }
  }, [text]);
  var handleSave = () => {
    if (text.trim()) onSave(text, source, selectedCategory);
  };
  var isEditMode = !!initialData;
  return /*#__PURE__*/React.createElement("div", {
    className: "flex flex-col h-full max-w-md mx-auto p-6 pt-8 pb-24 animate-fade-in overflow-y-auto no-scrollbar"
  }, /*#__PURE__*/React.createElement("div", {
    className: "flex-grow flex flex-col gap-6"
  }, /*#__PURE__*/React.createElement("label", {
    className: "text-stone-500 dark:text-stone-400 text-xs font-bold tracking-widest uppercase select-none cursor-default active:text-stone-800 dark:active:text-stone-200 transition-colors"
  }, isEditMode ? '言葉を編集する' : '言葉を記す'), /*#__PURE__*/React.createElement("textarea", {
    ref: textareaRef,
    value: text,
    onChange: e => setText(e.target.value),
    placeholder: "\u5FC3\u306B\u6B8B\u3063\u305F\u8A00\u8449\u3092\u5165\u529B...",
    className: "w-full min-h-[8rem] bg-transparent text-lg leading-relaxed text-stone-800 dark:text-stone-200 placeholder:text-stone-300 dark:placeholder:text-stone-600 resize-none focus:outline-none font-serif overflow-hidden transition-colors",
    autoFocus: !isEditMode
  }), /*#__PURE__*/React.createElement("input", {
    type: "text",
    value: source,
    onChange: e => setSource(e.target.value),
    placeholder: "\u51FA\u5178\uFF08\u4EFB\u610F\uFF09",
    className: "w-full bg-transparent border-b border-stone-200 dark:border-stone-700 py-2 mb-4 focus:outline-none focus:border-stone-400 dark:focus:border-stone-500 text-sm font-serif text-stone-600 dark:text-stone-400 placeholder:text-stone-200 dark:placeholder:text-stone-700 transition-colors"
  }), /*#__PURE__*/React.createElement("div", {
    className: "space-y-3"
  }, /*#__PURE__*/React.createElement("div", {
    className: "grid grid-cols-2 gap-2"
  }, CATEGORIES.map(cat => /*#__PURE__*/React.createElement("button", {
    key: cat,
    onClick: () => setSelectedCategory(cat),
    className: "py-3 px-2 text-sm rounded transition-all duration-200 border ".concat(selectedCategory === cat ? 'bg-stone-800 dark:bg-stone-700 text-stone-50 dark:text-stone-100 border-stone-800 dark:border-stone-700 shadow-md' : 'bg-white dark:bg-stone-800 text-stone-600 dark:text-stone-400 border-stone-200 dark:border-stone-700 hover:border-stone-400 dark:hover:border-stone-500')
  }, cat))))), /*#__PURE__*/React.createElement("div", {
    className: "pt-6 pb-4"
  }, /*#__PURE__*/React.createElement("button", {
    onClick: handleSave,
    disabled: !text.trim(),
    className: "w-full py-4 rounded-lg font-bold tracking-widest transition-all duration-200 ".concat(text.trim() ? 'bg-stone-800 dark:bg-stone-700 text-stone-50 dark:text-stone-100 shadow-lg hover:bg-stone-700 dark:hover:bg-stone-600 active:scale-[0.98]' : 'bg-stone-200 dark:bg-stone-800 text-stone-400 dark:text-stone-600 cursor-not-allowed')
  }, isEditMode ? '更新する' : '保存する')));
};
var ListView = _ref8 => {
  var {
    quotes,
    onItemClick,
    onStartRandom,
    filterCategory,
    onOpenFilter
  } = _ref8;
  var displayQuotes = filterCategory ? quotes.filter(q => q.category === filterCategory) : quotes;
  return /*#__PURE__*/React.createElement("div", {
    className: "h-full overflow-y-auto max-w-md mx-auto p-6 pb-32 no-scrollbar"
  }, quotes.length > 0 && /*#__PURE__*/React.createElement("div", {
    className: "flex justify-end mb-4 px-1"
  }, /*#__PURE__*/React.createElement("button", {
    onClick: onOpenFilter,
    className: "flex items-center gap-1.5 text-[10px] font-bold text-stone-400 hover:text-stone-600 dark:text-stone-500 dark:hover:text-stone-300 transition-colors tracking-wide bg-stone-100/80 dark:bg-stone-800/80 px-3 py-1.5 rounded-full border border-stone-200/50 dark:border-stone-700/50"
  }, /*#__PURE__*/React.createElement(ListFilter, {
    size: 12
  }), /*#__PURE__*/React.createElement("span", null, filterCategory || 'すべての言葉'))), displayQuotes.length === 0 && quotes.length === 0 ? /*#__PURE__*/React.createElement("div", {
    className: "flex flex-col items-center justify-center h-full text-stone-400 dark:text-stone-500 p-6 text-center italic font-serif"
  }, "\u307E\u3060\u8A00\u8449\u304C\u3042\u308A\u307E\u305B\u3093\u3002\u4E0B\u306E\u300C\u8A18\u3059\u300D\u304B\u3089\u59CB\u3081\u307E\u3057\u3087\u3046\u3002") : displayQuotes.length === 0 ? /*#__PURE__*/React.createElement("div", {
    className: "flex flex-col items-center justify-center h-48 text-stone-400 dark:text-stone-500 p-6 text-center italic font-serif text-sm"
  }, "\u3053\u306E\u30AB\u30C6\u30B4\u30EA\u306E\u8A00\u8449\u306F\u3042\u308A\u307E\u305B\u3093\u3002") : /*#__PURE__*/React.createElement("div", {
    className: "space-y-6"
  }, /*#__PURE__*/React.createElement("button", {
    onClick: onStartRandom,
    className: "w-full flex items-center justify-between py-4 px-5 bg-stone-100 dark:bg-stone-800 border border-stone-200 dark:border-stone-700 rounded-2xl hover:bg-stone-200 dark:hover:bg-stone-700/80 transition-all group active:scale-[0.98]"
  }, /*#__PURE__*/React.createElement("div", {
    className: "flex items-center gap-3"
  }, /*#__PURE__*/React.createElement("div", {
    className: "bg-white dark:bg-stone-700 p-2.5 rounded-xl shadow-sm text-stone-800 dark:text-stone-200 group-hover:rotate-12 transition-transform"
  }, /*#__PURE__*/React.createElement(Sparkles, {
    size: 20
  })), /*#__PURE__*/React.createElement("div", {
    className: "text-left"
  }, /*#__PURE__*/React.createElement("p", {
    className: "text-sm font-bold text-stone-800 dark:text-stone-200 tracking-wider"
  }, "\u8A00\u8449\u3068\u306E\u518D\u4F1A"), /*#__PURE__*/React.createElement("p", {
    className: "text-[10px] text-stone-400 dark:text-stone-500 font-serif"
  }, "\u3044\u3064\u304B\u306E\u8A00\u8449\u306B\u3001\u307E\u305F\u51FA\u4F1A\u3046"))), /*#__PURE__*/React.createElement(ChevronRight, {
    className: "text-stone-300 dark:text-stone-600 group-hover:text-stone-50 dark:group-hover:text-stone-400 transition-colors",
    size: 18
  })), displayQuotes.map(quote => /*#__PURE__*/React.createElement("div", {
    key: quote.id,
    onClick: () => onItemClick(quote.id),
    className: "group bg-white dark:bg-stone-850 p-6 rounded-2xl border border-stone-100 dark:border-stone-800 hover:border-stone-300 dark:hover:border-stone-600 transition-all cursor-pointer active:bg-stone-50 dark:active:bg-stone-800 shadow-sm text-left"
  }, /*#__PURE__*/React.createElement("p", {
    className: "text-base leading-relaxed text-stone-800 dark:text-stone-200 whitespace-pre-wrap mb-1 font-serif line-clamp-3"
  }, quote.text), quote.source && /*#__PURE__*/React.createElement("p", {
    className: "text-[10px] text-stone-400 dark:text-stone-500 font-serif mb-3 tracking-wide"
  }, "\u2014 ", quote.source), /*#__PURE__*/React.createElement("div", {
    className: "flex justify-between items-end border-t border-stone-50 dark:border-stone-800 pt-3"
  }, /*#__PURE__*/React.createElement("span", {
    className: "text-xs text-stone-500 dark:text-stone-400 bg-stone-100 dark:bg-stone-800 px-2 py-1 rounded-lg font-medium"
  }, quote.category), /*#__PURE__*/React.createElement("span", {
    className: "text-[10px] text-stone-400 dark:text-stone-600 font-mono"
  }, new Date(quote.timestamp).toLocaleDateString('ja-JP')))))));
};
var SingleQuoteView = _ref9 => {
  var {
    quote,
    onNext,
    onPrev,
    hasNext,
    hasPrev,
    nextLabel,
    nextIcon: NextIcon,
    onClose
  } = _ref9;
  return /*#__PURE__*/React.createElement("div", {
    className: "flex flex-col h-full max-w-md mx-auto p-8 pb-8 relative animate-fade-in bg-stone-50 dark:bg-stone-900 overflow-y-auto no-scrollbar transition-colors duration-300"
  }, /*#__PURE__*/React.createElement("div", {
    className: "flex-grow flex flex-col items-center pt-5"
  }, /*#__PURE__*/React.createElement("div", {
    className: "w-full text-center"
  }, /*#__PURE__*/React.createElement("span", {
    className: "inline-block px-3 py-1 rounded-full border border-stone-200 dark:border-stone-700 text-xs text-stone-500 dark:text-stone-400 tracking-wide mb-8"
  }, quote.category), /*#__PURE__*/React.createElement("div", {
    className: "px-2"
  }, /*#__PURE__*/React.createElement("p", {
    className: "text-xl md:text-2xl font-serif text-stone-800 dark:text-stone-200 whitespace-pre-wrap mb-4 select-text",
    style: {
      lineHeight: '1.8'
    }
  }, quote.text), quote.source && /*#__PURE__*/React.createElement("p", {
    className: "text-sm text-stone-500 dark:text-stone-400 font-serif mb-8"
  }, "\u2014 ", quote.source), /*#__PURE__*/React.createElement("div", {
    className: "mt-8 flex justify-center text-stone-300 dark:text-stone-700"
  }, /*#__PURE__*/React.createElement("div", {
    className: "h-px w-12 bg-stone-300 dark:bg-stone-700"
  })), /*#__PURE__*/React.createElement("p", {
    className: "mt-4 text-[10px] text-stone-400 dark:text-stone-600 font-mono tracking-widest"
  }, new Date(quote.timestamp).toLocaleDateString('ja-JP'))))), /*#__PURE__*/React.createElement("div", {
    className: "pt-6 pb-32 text-center"
  }, /*#__PURE__*/React.createElement("div", {
    className: "flex gap-3 mb-6 min-h-[64px]"
  }, /*#__PURE__*/React.createElement("div", {
    className: "w-16"
  }, /*#__PURE__*/React.createElement("button", {
    onClick: onPrev,
    disabled: !hasPrev,
    className: "w-full h-full border border-stone-300 dark:border-stone-700 rounded-lg text-stone-400 dark:text-stone-500 enabled:hover:text-stone-800 dark:enabled:hover:text-stone-200 transition-all duration-200 bg-white dark:bg-stone-800 flex items-center justify-center disabled:opacity-30"
  }, /*#__PURE__*/React.createElement(ChevronLeft, {
    size: 20
  }))), /*#__PURE__*/React.createElement("div", {
    className: "flex-grow"
  }, /*#__PURE__*/React.createElement("button", {
    onClick: onNext,
    disabled: !hasNext,
    className: "w-full h-full border border-stone-300 dark:border-stone-700 rounded-lg text-stone-600 dark:text-stone-400 enabled:hover:text-stone-800 dark:enabled:hover:text-stone-200 hover:border-stone-400 dark:hover:border-stone-500 transition-all duration-200 flex items-center justify-center gap-2 bg-white dark:bg-stone-800 shadow-sm disabled:opacity-30"
  }, /*#__PURE__*/React.createElement("span", {
    className: "text-sm font-bold tracking-widest"
  }, nextLabel), /*#__PURE__*/React.createElement(NextIcon, {
    size: 16
  })))), /*#__PURE__*/React.createElement("button", {
    onClick: onClose,
    className: "text-xs text-stone-400 dark:text-stone-500 hover:text-stone-600 dark:hover:text-stone-300 transition-colors tracking-widest font-bold py-2 px-4"
  }, "\u4E00\u89A7\u306B\u623B\u308B")));
};
var App = () => {
  var [user, setUser] = useState(null);
  var [shortCode, setShortCode] = useState('');
  var [isLoadingCode, setIsLoadingCode] = useState(false);
  var [codeError, setCodeError] = useState(null);
  var [syncUserId, setSyncUserId] = useState(null);
  var [viewMode, setViewMode] = useState('list');
  var [selectedQuoteId, setSelectedQuoteId] = useState(null);
  var [randomHistory, setRandomHistory] = useState([]);
  var [quotes, setQuotes] = useState([]);
  var [toast, setToast] = useState({
    show: false,
    message: ''
  });
  var [dialogState, setDialogState] = useState({
    isVisible: false,
    type: null,
    id: null
  });
  var [isDarkMode, setIsDarkMode] = useState(false);
  var [filterCategory, setFilterCategory] = useState(null);
  var [isFilterVisible, setIsFilterVisible] = useState(false);

  // テーマの初期化と切り替え
  useEffect(() => {
    var savedTheme = localStorage.getItem('theme');
    // Dayモードをデフォルトにするため、保存がない場合はDay（elseブロック）へ誘導
    if (savedTheme === 'dark') {
      setIsDarkMode(true);
      document.documentElement.classList.add('dark');
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0c0a09');
    } else {
      setIsDarkMode(false);
      document.documentElement.classList.remove('dark');
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#fafaf9');
    }
  }, []);
  var toggleTheme = () => {
    var newMode = !isDarkMode;
    setIsDarkMode(newMode);
    if (newMode) {
      document.documentElement.classList.add('dark');
      localStorage.setItem('theme', 'dark');
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0c0a09');
    } else {
      document.documentElement.classList.remove('dark');
      localStorage.setItem('theme', 'light');
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#fafaf9');
    }
  };
  var fetchUserData = /*#__PURE__*/function () {
    var _ref0 = _asyncToGenerator(function* (currentUser) {
      if (!currentUser) return;
      setIsLoadingCode(true);
      setCodeError(null);
      try {
        var userCodeRef = doc(db, 'artifacts', appId, 'public', 'data', 'userCodes', currentUser.uid);
        var codeSnap = yield getDoc(userCodeRef);
        if (codeSnap.exists()) {
          setShortCode(codeSnap.data().code);
        } else {
          var newCode = generateShortCode();
          yield setDoc(doc(db, 'artifacts', appId, 'public', 'data', 'syncCodes', newCode), {
            uid: currentUser.uid
          });
          yield setDoc(userCodeRef, {
            code: newCode
          });
          setShortCode(newCode);
        }
      } catch (e) {
        console.error("Fetch Error:", e);
        var msg = "接続エラー";
        if (e.code === 'permission-denied') msg = "権限がありません";
        setCodeError(msg);
      } finally {
        setIsLoadingCode(false);
      }
    });
    return function fetchUserData(_x) {
      return _ref0.apply(this, arguments);
    };
  }();
  useEffect(() => {
    setPersistence(auth, browserLocalPersistence).then(() => {
      var unsubscribe = onAuthStateChanged(auth, u => {
        if (u) {
          setUser(u);
          fetchUserData(u);
        } else {
          signInAnonymously(auth).catch(e => {
            console.error("Auth Error:", e);
            var msg = "認証エラー";
            if (e.code === 'auth/operation-not-allowed') msg = "匿名ログインが無効です";
            setCodeError(msg);
          });
        }
      });
      return () => unsubscribe();
    }).catch(error => {
      console.error("Persistence Error:", error);
      onAuthStateChanged(auth, u => {
        if (u) {
          setUser(u);
          fetchUserData(u);
        }
      });
    });
  }, []);
  var activeUserId = syncUserId || (user ? user.uid : null);
  useEffect(() => {
    if (!activeUserId) {
      setQuotes([]);
      return;
    }
    var q = query(collection(db, 'artifacts', appId, 'users', activeUserId, 'quotes'));
    var unsubscribe = onSnapshot(q, snapshot => {
      var docs = snapshot.docs.map(doc => _objectSpread({
        id: doc.id
      }, doc.data()));
      setQuotes(docs.sort((a, b) => (b.timestamp || 0) - (a.timestamp || 0)));
    }, err => {
      console.error("Firestore Sync Error:", err);
    });
    return () => unsubscribe();
  }, [activeUserId]);
  var showToast = message => setToast({
    show: true,
    message
  });
  var handleSyncByCode = /*#__PURE__*/function () {
    var _ref1 = _asyncToGenerator(function* (code) {
      if (!user) return;
      var cleanCode = code.trim().toUpperCase();
      try {
        var mappingRef = doc(db, 'artifacts', appId, 'public', 'data', 'syncCodes', cleanCode);
        var mappingSnap = yield getDoc(mappingRef);
        if (mappingSnap.exists()) {
          setSyncUserId(mappingSnap.data().uid);
          setViewMode('list');
          showToast("同期を開始しました");
        } else {
          showToast("コードが見つかりません");
        }
      } catch (e) {
        showToast("同期エラーが発生しました");
      }
    });
    return function handleSyncByCode(_x2) {
      return _ref1.apply(this, arguments);
    };
  }();
  var addQuote = /*#__PURE__*/function () {
    var _ref10 = _asyncToGenerator(function* (text, source, category) {
      if (!activeUserId) return;
      yield addDoc(collection(db, 'artifacts', appId, 'users', activeUserId, 'quotes'), {
        text,
        source,
        category,
        timestamp: Date.now()
      });
      showToast("言葉を保存しました");
      setViewMode('list');
    });
    return function addQuote(_x3, _x4, _x5) {
      return _ref10.apply(this, arguments);
    };
  }();
  var updateQuote = /*#__PURE__*/function () {
    var _ref11 = _asyncToGenerator(function* (text, source, category) {
      if (!activeUserId || !selectedQuoteId) return;
      yield updateDoc(doc(db, 'artifacts', appId, 'users', activeUserId, 'quotes', selectedQuoteId), {
        text,
        source,
        category
      });
      showToast("言葉を更新しました");
      setViewMode(randomHistory.length > 0 ? 'random' : 'detail');
    });
    return function updateQuote(_x6, _x7, _x8) {
      return _ref11.apply(this, arguments);
    };
  }();
  var handleConfirmAction = /*#__PURE__*/function () {
    var _ref12 = _asyncToGenerator(function* () {
      if (dialogState.type === 'quote') yield confirmDeleteQuote();else if (dialogState.type === 'account') yield confirmResetAccount();
    });
    return function handleConfirmAction() {
      return _ref12.apply(this, arguments);
    };
  }();
  var confirmDeleteQuote = /*#__PURE__*/function () {
    var _ref13 = _asyncToGenerator(function* () {
      if (!activeUserId || !dialogState.id) return;
      yield deleteDoc(doc(db, 'artifacts', appId, 'users', activeUserId, 'quotes', dialogState.id));
      showToast("削除しました");
      setDialogState({
        isVisible: false,
        type: null,
        id: null
      });
      setViewMode('list');
      setSelectedQuoteId(null);
    });
    return function confirmDeleteQuote() {
      return _ref13.apply(this, arguments);
    };
  }();
  var confirmResetAccount = /*#__PURE__*/function () {
    var _ref14 = _asyncToGenerator(function* () {
      if (!user || !shortCode) return;
      try {
        var quotesRef = collection(db, 'artifacts', appId, 'users', user.uid, 'quotes');
        var snap = yield getDocs(quotesRef);
        var deletePromises = snap.docs.map(d => deleteDoc(d.ref));
        yield Promise.all(deletePromises);
        yield deleteDoc(doc(db, 'artifacts', appId, 'public', 'data', 'syncCodes', shortCode));
        yield deleteDoc(doc(db, 'artifacts', appId, 'public', 'data', 'userCodes', user.uid));
        showToast("初期化しました。リロードします...");
        setTimeout(() => window.location.reload(), 1500);
      } catch (e) {
        console.error(e);
        showToast("初期化に失敗しました");
        setDialogState({
          isVisible: false,
          type: null,
          id: null
        });
      }
    });
    return function confirmResetAccount() {
      return _ref14.apply(this, arguments);
    };
  }();
  var handleTitleClick = e => {
    if (e.detail === 3) {
      var htmlContent = document.documentElement.outerHTML;
      var blob = new Blob([htmlContent], {
        type: 'text/html'
      });
      var url = URL.createObjectURL(blob);
      var a = document.createElement('a');
      a.href = url;
      a.download = 'index.html';
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
      showToast("HTMLファイルをダウンロードしました");
    }
  };
  var ThemeToggle = () => /*#__PURE__*/React.createElement("button", {
    onClick: toggleTheme,
    className: "p-2 text-stone-400 hover:text-stone-800 dark:hover:text-stone-200 transition-colors"
  }, isDarkMode ? /*#__PURE__*/React.createElement(Sun, {
    size: 24
  }) : /*#__PURE__*/React.createElement(Moon, {
    size: 24
  }));
  var currentQuoteIndex = quotes.findIndex(q => q.id === selectedQuoteId);
  var currentQuote = quotes[currentQuoteIndex];
  var leftActions = null;
  var rightActions = null;
  switch (viewMode) {
    case 'list':
      leftActions = /*#__PURE__*/React.createElement(ThemeToggle, null);
      rightActions = /*#__PURE__*/React.createElement("button", {
        onClick: () => setViewMode('settings'),
        className: "p-2 -mr-2 text-stone-400 hover:text-stone-800 dark:hover:text-stone-200 transition-colors"
      }, /*#__PURE__*/React.createElement(Menu, {
        size: 24
      }));
      break;
    case 'input':
    case 'settings':
      rightActions = /*#__PURE__*/React.createElement("button", {
        onClick: () => setViewMode('list'),
        className: "p-2 -mr-2 text-stone-400 hover:text-stone-800 dark:hover:text-stone-200 transition-colors"
      }, /*#__PURE__*/React.createElement(X, {
        size: 24
      }));
      break;
    case 'edit':
      rightActions = /*#__PURE__*/React.createElement("button", {
        onClick: () => setViewMode(randomHistory.length > 0 ? 'random' : 'detail'),
        className: "p-2 -mr-2 text-stone-400 hover:text-stone-800 dark:hover:text-stone-200 transition-colors"
      }, /*#__PURE__*/React.createElement(X, {
        size: 24
      }));
      break;
    case 'detail':
    case 'random':
      leftActions = /*#__PURE__*/React.createElement("button", {
        onClick: () => {
          setViewMode('list');
          setRandomHistory([]);
          setSelectedQuoteId(null);
        },
        className: "p-2 -ml-2 text-stone-400 hover:text-stone-800 dark:hover:text-stone-200 transition-colors"
      }, /*#__PURE__*/React.createElement(ArrowLeft, {
        size: 24
      }));
      rightActions = /*#__PURE__*/React.createElement("div", {
        className: "flex gap-1 -mr-2"
      }, /*#__PURE__*/React.createElement("button", {
        onClick: () => setDialogState({
          isVisible: true,
          type: 'quote',
          id: selectedQuoteId
        }),
        className: "p-2 text-stone-400 hover:text-red-500 transition-colors"
      }, /*#__PURE__*/React.createElement(Trash2, {
        size: 20
      })), /*#__PURE__*/React.createElement("button", {
        onClick: () => setViewMode('edit'),
        className: "p-2 text-stone-400 hover:text-stone-800 dark:hover:text-stone-200 transition-colors"
      }, /*#__PURE__*/React.createElement(Edit2, {
        size: 20
      })));
      break;
  }
  if (!user) return /*#__PURE__*/React.createElement("div", {
    className: "h-screen flex items-center justify-center font-serif text-stone-400 dark:text-stone-500 italic bg-stone-50 dark:bg-stone-900"
  }, "\u8AAD\u307F\u8FBC\u307F\u4E2D...");
  return /*#__PURE__*/React.createElement("div", {
    className: "h-[100dvh] bg-stone-50 dark:bg-stone-900 text-stone-800 dark:text-stone-200 font-sans selection:bg-stone-200 dark:selection:bg-stone-700 overflow-hidden flex flex-col transition-colors duration-300"
  }, /*#__PURE__*/React.createElement("style", null, "@media (min-width: 640px) { body { padding-top: 16px; } }"), /*#__PURE__*/React.createElement(Header, {
    onTitleClick: handleTitleClick,
    leftActions: leftActions,
    rightActions: rightActions
  }), /*#__PURE__*/React.createElement("div", {
    className: "flex-grow overflow-hidden relative",
    style: {
      paddingTop: '64px'
    }
  }, /*#__PURE__*/React.createElement("main", {
    className: "h-full relative overflow-hidden"
  }, viewMode === 'input' && /*#__PURE__*/React.createElement(InputView, {
    onSave: addQuote
  }), viewMode === 'list' && /*#__PURE__*/React.createElement(ListView, {
    quotes: quotes,
    onItemClick: id => {
      setSelectedQuoteId(id);
      setViewMode('detail');
    },
    onStartRandom: () => {
      if (quotes.length > 0) {
        var first = quotes[Math.floor(Math.random() * quotes.length)];
        setSelectedQuoteId(first.id);
        setRandomHistory([first.id]);
        setViewMode('random');
      }
    },
    filterCategory: filterCategory,
    onOpenFilter: () => setIsFilterVisible(true)
  }), viewMode === 'detail' && currentQuote && /*#__PURE__*/React.createElement(SingleQuoteView, {
    quote: currentQuote,
    onNext: () => setSelectedQuoteId(quotes[(currentQuoteIndex + 1) % quotes.length].id),
    onPrev: () => setSelectedQuoteId(quotes[(currentQuoteIndex - 1 + quotes.length) % quotes.length].id),
    hasNext: currentQuoteIndex < quotes.length - 1,
    hasPrev: currentQuoteIndex > 0,
    nextLabel: "\u6B21\u306E\u8A00\u8449\u3078",
    nextIcon: ChevronRight,
    onClose: () => setViewMode('list')
  }), viewMode === 'random' && currentQuote && /*#__PURE__*/React.createElement(SingleQuoteView, {
    quote: currentQuote,
    onNext: () => {
      var n;
      do {
        n = quotes[Math.floor(Math.random() * quotes.length)].id;
      } while (n === selectedQuoteId && quotes.length > 1);
      setSelectedQuoteId(n);
      setRandomHistory(p => [...p, n]);
    },
    onPrev: () => {
      var h = [...randomHistory];
      h.pop();
      var p = h[h.length - 1];
      setSelectedQuoteId(p);
      setRandomHistory(h);
    },
    hasNext: quotes.length > 1,
    hasPrev: randomHistory.length > 1,
    nextLabel: "\u5225\u306E\u8A00\u8449\u306B\u51FA\u4F1A\u3046",
    nextIcon: Sparkles,
    onClose: () => setViewMode('list')
  }), viewMode === 'edit' && currentQuote && /*#__PURE__*/React.createElement(InputView, {
    initialData: currentQuote,
    onSave: updateQuote
  }), viewMode === 'settings' && /*#__PURE__*/React.createElement(SyncSettingsView, {
    currentShortCode: shortCode,
    isLoadingCode: isLoadingCode,
    errorMsg: codeError,
    onRetryCode: () => fetchUserData(user),
    onSyncCode: handleSyncByCode,
    onRequestReset: () => setDialogState({
      isVisible: true,
      type: 'account',
      id: null
    }),
    showToast: showToast
  }))), /*#__PURE__*/React.createElement(FilterSheet, {
    isVisible: isFilterVisible,
    currentCategory: filterCategory,
    onSelect: cat => {
      setFilterCategory(cat);
      setIsFilterVisible(false);
    },
    onClose: () => setIsFilterVisible(false)
  }), viewMode === 'list' && /*#__PURE__*/React.createElement(FloatingWriteButton, {
    onClick: () => setViewMode('input')
  }), /*#__PURE__*/React.createElement(ConfirmDialog, {
    isVisible: dialogState.isVisible,
    title: dialogState.type === 'account' ? "全データを削除しますか？" : "言葉を削除しますか？",
    message: dialogState.type === 'account' ? "あなたの言葉、設定、同期コードがすべて削除され、アプリが初期化されます。この操作は取り消せません。" : "一度削除した言葉は元に戻すことができません。",
    actionLabel: dialogState.type === 'account' ? "全削除して初期化" : "削除する",
    onConfirm: handleConfirmAction,
    onCancel: () => setDialogState({
      isVisible: false,
      type: null,
      id: null
    })
  }), /*#__PURE__*/React.createElement(Toast, {
    message: toast.message,
    isVisible: toast.show,
    onHide: () => setToast(p => _objectSpread(_objectSpread({}, p), {}, {
      show: false
    }))
  }));
};
var root = createRoot(document.getElementById('root'));
root.render(/*#__PURE__*/React.createElement(App, null));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJSZWFjdCIsInVzZVN0YXRlIiwidXNlRWZmZWN0IiwidXNlUmVmIiwiY3JlYXRlUm9vdCIsIkx1Y2lkZUljb25zIiwiaW5pdGlhbGl6ZUFwcCIsImdldEF1dGgiLCJzaWduSW5Bbm9ueW1vdXNseSIsIm9uQXV0aFN0YXRlQ2hhbmdlZCIsInNldFBlcnNpc3RlbmNlIiwiYnJvd3NlckxvY2FsUGVyc2lzdGVuY2UiLCJnZXRGaXJlc3RvcmUiLCJjb2xsZWN0aW9uIiwiZG9jIiwic2V0RG9jIiwiZ2V0RG9jIiwiZ2V0RG9jcyIsImFkZERvYyIsInVwZGF0ZURvYyIsImRlbGV0ZURvYyIsIm9uU25hcHNob3QiLCJxdWVyeSIsIlBlbkxpbmUiLCJTcGFya2xlcyIsIkNoZWNrIiwiQ2hldnJvblJpZ2h0IiwiQ2hldnJvbkxlZnQiLCJBcnJvd0xlZnQiLCJFZGl0MiIsIlRyYXNoMiIsIk1lbnUiLCJDb3B5IiwiUmVmcmVzaEN3IiwiWCIsIkFsZXJ0Q2lyY2xlIiwiTW9vbiIsIlN1biIsIkxpc3RGaWx0ZXIiLCJmaXJlYmFzZUNvbmZpZyIsImFwcCIsImF1dGgiLCJkYiIsImFwcElkIiwiQ0FURUdPUklFUyIsImdlbmVyYXRlU2hvcnRDb2RlIiwiY2hhcnMiLCJyZXN1bHQiLCJpIiwiY2hhckF0IiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwibGVuZ3RoIiwiSGVhZGVyIiwiX3JlZiIsIm9uVGl0bGVDbGljayIsImxlZnRBY3Rpb25zIiwicmlnaHRBY3Rpb25zIiwiY3JlYXRlRWxlbWVudCIsImNsYXNzTmFtZSIsIm9uQ2xpY2siLCJ0aXRsZSIsIlN5bmNTZXR0aW5nc1ZpZXciLCJfcmVmMiIsImN1cnJlbnRTaG9ydENvZGUiLCJpc0xvYWRpbmdDb2RlIiwiZXJyb3JNc2ciLCJvblJldHJ5Q29kZSIsIm9uU3luY0NvZGUiLCJvblJlcXVlc3RSZXNldCIsInNob3dUb2FzdCIsImlucHV0SWQiLCJzZXRJbnB1dElkIiwiaGFuZGxlQ29weSIsIm5hdmlnYXRvciIsImNsaXBib2FyZCIsIndyaXRlVGV4dCIsImRpc2FibGVkIiwiaW5jbHVkZXMiLCJzaXplIiwidHlwZSIsInZhbHVlIiwib25DaGFuZ2UiLCJlIiwidGFyZ2V0IiwidG9VcHBlckNhc2UiLCJwbGFjZWhvbGRlciIsInRyaW0iLCJUb2FzdCIsIl9yZWYzIiwibWVzc2FnZSIsImlzVmlzaWJsZSIsIm9uSGlkZSIsInRpbWVyIiwic2V0VGltZW91dCIsImNsZWFyVGltZW91dCIsIkZpbHRlclNoZWV0IiwiX3JlZjQiLCJjdXJyZW50Q2F0ZWdvcnkiLCJvblNlbGVjdCIsIm9uQ2xvc2UiLCJjb25jYXQiLCJtYXAiLCJjYXQiLCJrZXkiLCJDb25maXJtRGlhbG9nIiwiX3JlZjUiLCJhY3Rpb25MYWJlbCIsIm9uQ29uZmlybSIsIm9uQ2FuY2VsIiwiRmxvYXRpbmdXcml0ZUJ1dHRvbiIsIl9yZWY2Iiwic3Ryb2tlV2lkdGgiLCJJbnB1dFZpZXciLCJfcmVmNyIsIm9uU2F2ZSIsImluaXRpYWxEYXRhIiwidGV4dCIsInNldFRleHQiLCJzb3VyY2UiLCJzZXRTb3VyY2UiLCJzZWxlY3RlZENhdGVnb3J5Iiwic2V0U2VsZWN0ZWRDYXRlZ29yeSIsImNhdGVnb3J5IiwidGV4dGFyZWFSZWYiLCJjdXJyZW50Iiwic3R5bGUiLCJoZWlnaHQiLCJzY3JvbGxIZWlnaHQiLCJoYW5kbGVTYXZlIiwiaXNFZGl0TW9kZSIsInJlZiIsImF1dG9Gb2N1cyIsIkxpc3RWaWV3IiwiX3JlZjgiLCJxdW90ZXMiLCJvbkl0ZW1DbGljayIsIm9uU3RhcnRSYW5kb20iLCJmaWx0ZXJDYXRlZ29yeSIsIm9uT3BlbkZpbHRlciIsImRpc3BsYXlRdW90ZXMiLCJmaWx0ZXIiLCJxIiwicXVvdGUiLCJpZCIsIkRhdGUiLCJ0aW1lc3RhbXAiLCJ0b0xvY2FsZURhdGVTdHJpbmciLCJTaW5nbGVRdW90ZVZpZXciLCJfcmVmOSIsIm9uTmV4dCIsIm9uUHJldiIsImhhc05leHQiLCJoYXNQcmV2IiwibmV4dExhYmVsIiwibmV4dEljb24iLCJOZXh0SWNvbiIsImxpbmVIZWlnaHQiLCJBcHAiLCJ1c2VyIiwic2V0VXNlciIsInNob3J0Q29kZSIsInNldFNob3J0Q29kZSIsInNldElzTG9hZGluZ0NvZGUiLCJjb2RlRXJyb3IiLCJzZXRDb2RlRXJyb3IiLCJzeW5jVXNlcklkIiwic2V0U3luY1VzZXJJZCIsInZpZXdNb2RlIiwic2V0Vmlld01vZGUiLCJzZWxlY3RlZFF1b3RlSWQiLCJzZXRTZWxlY3RlZFF1b3RlSWQiLCJyYW5kb21IaXN0b3J5Iiwic2V0UmFuZG9tSGlzdG9yeSIsInNldFF1b3RlcyIsInRvYXN0Iiwic2V0VG9hc3QiLCJzaG93IiwiZGlhbG9nU3RhdGUiLCJzZXREaWFsb2dTdGF0ZSIsImlzRGFya01vZGUiLCJzZXRJc0RhcmtNb2RlIiwic2V0RmlsdGVyQ2F0ZWdvcnkiLCJpc0ZpbHRlclZpc2libGUiLCJzZXRJc0ZpbHRlclZpc2libGUiLCJzYXZlZFRoZW1lIiwibG9jYWxTdG9yYWdlIiwiZ2V0SXRlbSIsImRvY3VtZW50IiwiZG9jdW1lbnRFbGVtZW50IiwiY2xhc3NMaXN0IiwiYWRkIiwicXVlcnlTZWxlY3RvciIsInNldEF0dHJpYnV0ZSIsInJlbW92ZSIsInRvZ2dsZVRoZW1lIiwibmV3TW9kZSIsInNldEl0ZW0iLCJmZXRjaFVzZXJEYXRhIiwiX3JlZjAiLCJfYXN5bmNUb0dlbmVyYXRvciIsImN1cnJlbnRVc2VyIiwidXNlckNvZGVSZWYiLCJ1aWQiLCJjb2RlU25hcCIsImV4aXN0cyIsImRhdGEiLCJjb2RlIiwibmV3Q29kZSIsImNvbnNvbGUiLCJlcnJvciIsIm1zZyIsIl94IiwiYXBwbHkiLCJhcmd1bWVudHMiLCJ0aGVuIiwidW5zdWJzY3JpYmUiLCJ1IiwiY2F0Y2giLCJhY3RpdmVVc2VySWQiLCJzbmFwc2hvdCIsImRvY3MiLCJfb2JqZWN0U3ByZWFkIiwic29ydCIsImEiLCJiIiwiZXJyIiwiaGFuZGxlU3luY0J5Q29kZSIsIl9yZWYxIiwiY2xlYW5Db2RlIiwibWFwcGluZ1JlZiIsIm1hcHBpbmdTbmFwIiwiX3gyIiwiYWRkUXVvdGUiLCJfcmVmMTAiLCJub3ciLCJfeDMiLCJfeDQiLCJfeDUiLCJ1cGRhdGVRdW90ZSIsIl9yZWYxMSIsIl94NiIsIl94NyIsIl94OCIsImhhbmRsZUNvbmZpcm1BY3Rpb24iLCJfcmVmMTIiLCJjb25maXJtRGVsZXRlUXVvdGUiLCJjb25maXJtUmVzZXRBY2NvdW50IiwiX3JlZjEzIiwiX3JlZjE0IiwicXVvdGVzUmVmIiwic25hcCIsImRlbGV0ZVByb21pc2VzIiwiZCIsIlByb21pc2UiLCJhbGwiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsInJlbG9hZCIsImhhbmRsZVRpdGxlQ2xpY2siLCJkZXRhaWwiLCJodG1sQ29udGVudCIsIm91dGVySFRNTCIsImJsb2IiLCJCbG9iIiwidXJsIiwiVVJMIiwiY3JlYXRlT2JqZWN0VVJMIiwiaHJlZiIsImRvd25sb2FkIiwiYm9keSIsImFwcGVuZENoaWxkIiwiY2xpY2siLCJyZW1vdmVDaGlsZCIsInJldm9rZU9iamVjdFVSTCIsIlRoZW1lVG9nZ2xlIiwiY3VycmVudFF1b3RlSW5kZXgiLCJmaW5kSW5kZXgiLCJjdXJyZW50UXVvdGUiLCJwYWRkaW5nVG9wIiwiZmlyc3QiLCJuIiwicCIsImgiLCJwb3AiLCJyb290IiwiZ2V0RWxlbWVudEJ5SWQiLCJyZW5kZXIiXSwic291cmNlcyI6WyJJbmxpbmUgQmFiZWwgc2NyaXB0Il0sInNvdXJjZXNDb250ZW50IjpbIlxuICBpbXBvcnQgUmVhY3QsIHsgdXNlU3RhdGUsIHVzZUVmZmVjdCwgdXNlUmVmIH0gZnJvbSAncmVhY3QnO1xuICBpbXBvcnQgeyBjcmVhdGVSb290IH0gZnJvbSAncmVhY3QtZG9tL2NsaWVudCc7XG4gIGltcG9ydCAqIGFzIEx1Y2lkZUljb25zIGZyb20gJ2x1Y2lkZS1yZWFjdCc7XG4gIGltcG9ydCB7IGluaXRpYWxpemVBcHAgfSBmcm9tICdmaXJlYmFzZS9hcHAnO1xuICBpbXBvcnQgeyBnZXRBdXRoLCBzaWduSW5Bbm9ueW1vdXNseSwgb25BdXRoU3RhdGVDaGFuZ2VkLCBzZXRQZXJzaXN0ZW5jZSwgYnJvd3NlckxvY2FsUGVyc2lzdGVuY2UgfSBmcm9tICdmaXJlYmFzZS9hdXRoJztcbiAgaW1wb3J0IHsgZ2V0RmlyZXN0b3JlLCBjb2xsZWN0aW9uLCBkb2MsIHNldERvYywgZ2V0RG9jLCBnZXREb2NzLCBhZGREb2MsIHVwZGF0ZURvYywgZGVsZXRlRG9jLCBvblNuYXBzaG90LCBxdWVyeSB9IGZyb20gJ2ZpcmViYXNlL2ZpcmVzdG9yZSc7XG5cbiAgY29uc3QgeyBQZW5MaW5lLCBTcGFya2xlcywgQ2hlY2ssIENoZXZyb25SaWdodCwgQ2hldnJvbkxlZnQsIEFycm93TGVmdCwgRWRpdDIsIFRyYXNoMiwgTWVudSwgQ29weSwgUmVmcmVzaEN3LCBYLCBBbGVydENpcmNsZSwgTW9vbiwgU3VuLCBMaXN0RmlsdGVyIH0gPSBMdWNpZGVJY29ucztcblxuICBjb25zdCBmaXJlYmFzZUNvbmZpZyA9IHtcImFwaUtleVwiOlwiQUl6YVN5Qkx3OTloZFl3elFLYVdGYWNWM0hkSUFzYV9hZEFuYTlrXCIsXCJhdXRoRG9tYWluXCI6XCJrb3RvYmFrby1lYzY4Ni5maXJlYmFzZWFwcC5jb21cIixcInByb2plY3RJZFwiOlwia290b2Jha28tZWM2ODZcIixcInN0b3JhZ2VCdWNrZXRcIjpcImtvdG9iYWtvLWVjNjg2LmZpcmViYXNlc3RvcmFnZS5hcHBcIixcIm1lc3NhZ2luZ1NlbmRlcklkXCI6XCI4MzY2MjAyNTc4MjRcIixcImFwcElkXCI6XCIxOjgzNjYyMDI1NzgyNDp3ZWI6NWE3NmJmMGU2NDZlMzdmMWZiNGE0NVwiLFwibWVhc3VyZW1lbnRJZFwiOlwiRy05WERDQ1oxQkRNXCJ9O1xuICBjb25zdCBhcHAgPSBpbml0aWFsaXplQXBwKGZpcmViYXNlQ29uZmlnKTtcbiAgY29uc3QgYXV0aCA9IGdldEF1dGgoYXBwKTtcbiAgY29uc3QgZGIgPSBnZXRGaXJlc3RvcmUoYXBwKTtcbiAgY29uc3QgYXBwSWQgPSAna290by1uby1oYS1hcHAnO1xuICBjb25zdCBDQVRFR09SSUVTID0gW1wi5b+D44Gr5q6L44Gj44GfXCIsIFwi5paw44Gf44Gq5rCX44Gl44GNXCIsIFwi44GK44KC44GX44KN44GEXCIsIFwi5b2556uL44Gh44Gd44GGXCJdO1xuXG4gIGNvbnN0IGdlbmVyYXRlU2hvcnRDb2RlID0gKCkgPT4ge1xuICAgICAgY29uc3QgY2hhcnMgPSAnQUJDREVGR0hKS0xNTlBRUlNUVVZXWFlaMjM0NTY3ODknO1xuICAgICAgbGV0IHJlc3VsdCA9ICcnO1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCA0OyBpKyspIHJlc3VsdCArPSBjaGFycy5jaGFyQXQoTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogY2hhcnMubGVuZ3RoKSk7XG4gICAgICByZXN1bHQgKz0gJy0nO1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCA0OyBpKyspIHJlc3VsdCArPSBjaGFycy5jaGFyQXQoTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogY2hhcnMubGVuZ3RoKSk7XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICB9O1xuXG4gIGNvbnN0IEhlYWRlciA9ICh7IG9uVGl0bGVDbGljaywgbGVmdEFjdGlvbnMsIHJpZ2h0QWN0aW9ucyB9KSA9PiAoXG4gICAgICA8aGVhZGVyIGNsYXNzTmFtZT1cImZpeGVkIHRvcC0wIGxlZnQtMCByaWdodC0wIHotNTAgaC0xNiBiZy1zdG9uZS01MC85MCBkYXJrOmJnLXN0b25lLTkwMC85MCBiYWNrZHJvcC1ibHVyLW1kIGJvcmRlci1iIGJvcmRlci1zdG9uZS0yMDAgZGFyazpib3JkZXItc3RvbmUtODAwIHB4LTYgZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1iZXR3ZWVuIHNoYWRvdy1zbSB0cmFuc2l0aW9uLWNvbG9ycyBkdXJhdGlvbi0zMDBcIj5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInctMjAgZmxleCBqdXN0aWZ5LXN0YXJ0IGl0ZW1zLWNlbnRlclwiPntsZWZ0QWN0aW9uc308L2Rpdj5cbiAgICAgICAgICA8aDEgb25DbGljaz17b25UaXRsZUNsaWNrfSBjbGFzc05hbWU9XCJ0ZXh0LXhsIGZvbnQtc2VyaWYgZm9udC1ib2xkIHRyYWNraW5nLXRpZ2h0IHRleHQtc3RvbmUtODAwIGRhcms6dGV4dC1zdG9uZS0yMDAgY3Vyc29yLWRlZmF1bHQgc2VsZWN0LW5vbmUgYWN0aXZlOm9wYWNpdHktNzAgdHJhbnNpdGlvbi1vcGFjaXR5XCIgdGl0bGU9XCLjg4jjg6rjg5fjg6vjgq/jg6rjg4Pjgq/jgafjg4Djgqbjg7Pjg63jg7zjg4lcIj5Lb3RvYmFrbzwvaDE+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ3LTIwIGZsZXgganVzdGlmeS1lbmQgaXRlbXMtY2VudGVyIGdhcC0xXCI+e3JpZ2h0QWN0aW9uc308L2Rpdj5cbiAgICAgIDwvaGVhZGVyPlxuICApO1xuXG4gIGNvbnN0IFN5bmNTZXR0aW5nc1ZpZXcgPSAoeyBjdXJyZW50U2hvcnRDb2RlLCBpc0xvYWRpbmdDb2RlLCBlcnJvck1zZywgb25SZXRyeUNvZGUsIG9uU3luY0NvZGUsIG9uUmVxdWVzdFJlc2V0LCBzaG93VG9hc3QgfSkgPT4ge1xuICAgICAgY29uc3QgW2lucHV0SWQsIHNldElucHV0SWRdID0gdXNlU3RhdGUoJycpO1xuICAgICAgY29uc3QgaGFuZGxlQ29weSA9ICgpID0+IHsgaWYgKCFjdXJyZW50U2hvcnRDb2RlIHx8IGN1cnJlbnRTaG9ydENvZGUubGVuZ3RoIDwgOCkgcmV0dXJuOyBuYXZpZ2F0b3IuY2xpcGJvYXJkLndyaXRlVGV4dChjdXJyZW50U2hvcnRDb2RlKTsgc2hvd1RvYXN0KFwi5ZCM5pyf44Kz44O844OJ44KS44Kz44OU44O844GX44G+44GX44GfXCIpOyB9O1xuICAgICAgcmV0dXJuIChcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggZmxleC1jb2wgaC1mdWxsIG1heC13LW1kIG14LWF1dG8gcC02IHB0LTYgcGItMjQgYW5pbWF0ZS1mYWRlLWluIG92ZXJmbG93LXktYXV0byBuby1zY3JvbGxiYXJcIj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3BhY2UteS04XCI+XG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3BhY2UteS0zXCI+XG4gICAgICAgICAgICAgICAgPGxhYmVsIGNsYXNzTmFtZT1cInRleHQtc3RvbmUtNTAwIGRhcms6dGV4dC1zdG9uZS00MDAgdGV4dC1bMTBweF0gZm9udC1ib2xkIHRyYWNraW5nLXdpZGVzdCB1cHBlcmNhc2UgYmxvY2sgbWwtMVwiPuOBguOBquOBn+OBruWQjOacn+OCs+ODvOODiTwvbGFiZWw+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMiBiZy13aGl0ZSBkYXJrOmJnLXN0b25lLTgwMCBwLTQgcm91bmRlZC14bCBib3JkZXIgYm9yZGVyLXN0b25lLTIwMCBkYXJrOmJvcmRlci1zdG9uZS03MDAgc2hhZG93LXNtIHRyYW5zaXRpb24tY29sb3JzIGR1cmF0aW9uLTMwMFwiPlxuICAgICAgICAgICAgICAgICAgPGNvZGUgY2xhc3NOYW1lPVwiZmxleC1ncm93IHRleHQteGwgZm9udC1tb25vIGZvbnQtYm9sZCB0ZXh0LXN0b25lLTgwMCBkYXJrOnRleHQtc3RvbmUtMjAwIHRyYWNraW5nLXRpZ2h0ZXIgdGV4dC1jZW50ZXJcIj57aXNMb2FkaW5nQ29kZSA/ICcuLi4nIDogKGVycm9yTXNnID8gJ+OCqOODqeODvCcgOiBjdXJyZW50U2hvcnRDb2RlKX08L2NvZGU+XG4gICAgICAgICAgICAgICAgICA8YnV0dG9uIG9uQ2xpY2s9e2hhbmRsZUNvcHl9IGRpc2FibGVkPXshY3VycmVudFNob3J0Q29kZSB8fCBjdXJyZW50U2hvcnRDb2RlLmluY2x1ZGVzKCcuLi4nKX0gY2xhc3NOYW1lPVwicC0yIHRleHQtc3RvbmUtNDAwIGhvdmVyOnRleHQtc3RvbmUtODAwIGRhcms6aG92ZXI6dGV4dC1zdG9uZS0yMDAgYmctc3RvbmUtNTAgZGFyazpiZy1zdG9uZS03MDAgcm91bmRlZC1sZyBhY3RpdmU6c2NhbGUtOTUgdHJhbnNpdGlvbi1hbGwgZGlzYWJsZWQ6b3BhY2l0eS0zMFwiPjxDb3B5IHNpemU9ezIwfSAvPjwvYnV0dG9uPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIHtlcnJvck1zZyAmJiA8ZGl2IGNsYXNzTmFtZT1cImZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktY2VudGVyIGdhcC0yIHRleHQtcmVkLTQwMCB0ZXh0LXhzIG10LTJcIj48QWxlcnRDaXJjbGUgc2l6ZT17MTR9IC8+PHNwYW4+e2Vycm9yTXNnfTwvc3Bhbj48YnV0dG9uIG9uQ2xpY2s9e29uUmV0cnlDb2RlfSBjbGFzc05hbWU9XCJ1bmRlcmxpbmVcIj7lho3oqabooYw8L2J1dHRvbj48L2Rpdj59XG4gICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwidGV4dC1bMTBweF0gdGV4dC1zdG9uZS00MDAgZGFyazp0ZXh0LXN0b25lLTUwMCBsZWFkaW5nLXJlbGF4ZWQgaXRhbGljIHB4LTFcIj7jgZPjga445paH5a2X44KS5Yil44Gu56uv5pyr44Gn5YWl5Yqb44GZ44KL44Go44CB6KiA6JGJ44KS5ZCM5pyf44Gn44GN44G+44GZ44CCPC9wPlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJyZWxhdGl2ZVwiPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYWJzb2x1dGUgaW5zZXQtMCBmbGV4IGl0ZW1zLWNlbnRlclwiPjxkaXYgY2xhc3NOYW1lPVwidy1mdWxsIGJvcmRlci10IGJvcmRlci1zdG9uZS0xMDAgZGFyazpib3JkZXItc3RvbmUtODAwXCI+PC9kaXY+PC9kaXY+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJyZWxhdGl2ZSBmbGV4IGp1c3RpZnktY2VudGVyIHRleHQtWzEwcHhdIHVwcGVyY2FzZVwiPjxzcGFuIGNsYXNzTmFtZT1cImJnLXN0b25lLTUwIGRhcms6Ymctc3RvbmUtOTAwIHB4LTMgdGV4dC1zdG9uZS0zMDAgZGFyazp0ZXh0LXN0b25lLTYwMCBmb250LWJvbGQgdHJhY2tpbmctd2lkZXN0IHRyYW5zaXRpb24tY29sb3JzIGR1cmF0aW9uLTMwMFwiPm9yPC9zcGFuPjwvZGl2PlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzcGFjZS15LTRcIj5cbiAgICAgICAgICAgICAgICA8bGFiZWwgY2xhc3NOYW1lPVwidGV4dC1zdG9uZS01MDAgZGFyazp0ZXh0LXN0b25lLTQwMCB0ZXh0LVsxMHB4XSBmb250LWJvbGQgdHJhY2tpbmctd2lkZXN0IHVwcGVyY2FzZSBibG9jayBtbC0xXCI+5Yil44Gu44Kz44O844OJ44Go5ZCM5pyf44GZ44KLPC9sYWJlbD5cbiAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT1cInRleHRcIiB2YWx1ZT17aW5wdXRJZH0gb25DaGFuZ2U9eyhlKSA9PiBzZXRJbnB1dElkKGUudGFyZ2V0LnZhbHVlLnRvVXBwZXJDYXNlKCkpfSBwbGFjZWhvbGRlcj1cIuS+izogQUJDRC0xMjM0XCIgY2xhc3NOYW1lPVwidy1mdWxsIGJnLXdoaXRlIGRhcms6Ymctc3RvbmUtODAwIGJvcmRlciBib3JkZXItc3RvbmUtMjAwIGRhcms6Ym9yZGVyLXN0b25lLTcwMCBwLTQgcm91bmRlZC14bCB0ZXh0LWxnIHRleHQtY2VudGVyIGZvY3VzOm91dGxpbmUtbm9uZSBmb2N1czpib3JkZXItc3RvbmUtNDAwIGRhcms6Zm9jdXM6Ym9yZGVyLXN0b25lLTUwMCB0ZXh0LXN0b25lLTgwMCBkYXJrOnRleHQtc3RvbmUtMjAwIGZvbnQtbW9ubyBmb250LWJvbGQgc2hhZG93LXNtIHRyYW5zaXRpb24tY29sb3JzIGR1cmF0aW9uLTMwMFwiIC8+XG4gICAgICAgICAgICAgICAgPGJ1dHRvbiBvbkNsaWNrPXsoKSA9PiBvblN5bmNDb2RlKGlucHV0SWQpfSBkaXNhYmxlZD17IWlucHV0SWQudHJpbSgpIHx8IGlucHV0SWQubGVuZ3RoIDwgOX0gY2xhc3NOYW1lPVwidy1mdWxsIHB5LTQgYmctc3RvbmUtOTAwIGRhcms6Ymctc3RvbmUtNzAwIHRleHQtc3RvbmUtNTAgZGFyazp0ZXh0LXN0b25lLTIwMCByb3VuZGVkLXhsIGZvbnQtYm9sZCB0ZXh0LXNtIHRyYWNraW5nLXdpZGVzdCBkaXNhYmxlZDpvcGFjaXR5LTMwIHRyYW5zaXRpb24tYWxsIGFjdGl2ZTpzY2FsZS1bMC45OF0gc2hhZG93LW1kIGhvdmVyOmJnLXN0b25lLTgwMCBkYXJrOmhvdmVyOmJnLXN0b25lLTYwMFwiPuWQjOacn+OCkumWi+Wni+OBmeOCizwvYnV0dG9uPlxuICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cInRleHQtWzEwcHhdIHRleHQtc3RvbmUtNDAwIGRhcms6dGV4dC1zdG9uZS01MDAgbGVhZGluZy1yZWxheGVkIGl0YWxpYyBweC0xIHRleHQtY2VudGVyXCI+4oC75YWl5Yqb44GX44Gf44Kz44O844OJ44Gu44OH44O844K/44Gr5YiH44KK5pu/44KP44KK44G+44GZ44CCPC9wPlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJwdC04IG10LTggYm9yZGVyLXQgYm9yZGVyLXN0b25lLTEwMCBkYXJrOmJvcmRlci1zdG9uZS04MDBcIj5cbiAgICAgICAgICAgICAgICA8YnV0dG9uIG9uQ2xpY2s9e29uUmVxdWVzdFJlc2V0fSBjbGFzc05hbWU9XCJ3LWZ1bGwgcHktNCB0ZXh0LXJlZC00MDAgaG92ZXI6dGV4dC1yZWQtNjAwIGRhcms6aG92ZXI6dGV4dC1yZWQtMzAwIHRleHQteHMgZm9udC1ib2xkIHRyYWNraW5nLXdpZGVzdCB0cmFuc2l0aW9uLWNvbG9ycyBmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlciBnYXAtMlwiPjxUcmFzaDIgc2l6ZT17MTZ9IC8+PHNwYW4+5YWo44OH44O844K/44KS5YmK6Zmk44GX44Gm5Yid5pyf5YyWPC9zcGFuPjwvYnV0dG9uPlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgKTtcbiAgfTtcbiAgXG4gIGNvbnN0IFRvYXN0ID0gKHsgbWVzc2FnZSwgaXNWaXNpYmxlLCBvbkhpZGUgfSkgPT4ge1xuICAgICAgdXNlRWZmZWN0KCgpID0+IHsgaWYgKGlzVmlzaWJsZSkgeyBjb25zdCB0aW1lciA9IHNldFRpbWVvdXQob25IaWRlLCAyMDAwKTsgcmV0dXJuICgpID0+IGNsZWFyVGltZW91dCh0aW1lcik7IH0gfSwgW2lzVmlzaWJsZSwgb25IaWRlXSk7XG4gICAgICBpZiAoIWlzVmlzaWJsZSkgcmV0dXJuIG51bGw7XG4gICAgICByZXR1cm4gPGRpdiBjbGFzc05hbWU9XCJmaXhlZCB0b3AtMjAgbGVmdC0xLzIgdHJhbnNmb3JtIC10cmFuc2xhdGUteC0xLzIgei1bMTAwXSBhbmltYXRlLWZhZGUtaW4gcG9pbnRlci1ldmVudHMtbm9uZVwiPjxkaXYgY2xhc3NOYW1lPVwiYmctc3RvbmUtODAwIGRhcms6Ymctc3RvbmUtNzAwIHRleHQtc3RvbmUtNTAgZGFyazp0ZXh0LXN0b25lLTEwMCBweC00IHB5LTIgcm91bmRlZC1mdWxsIHNoYWRvdy1sZyB0ZXh0LXNtIGZvbnQtbWVkaXVtIGZsZXggaXRlbXMtY2VudGVyIGdhcC0yIGJvcmRlciBib3JkZXItc3RvbmUtNzAwIGRhcms6Ym9yZGVyLXN0b25lLTYwMFwiPjxDaGVjayBzaXplPXsxNH0gLz57bWVzc2FnZX08L2Rpdj48L2Rpdj47XG4gIH07XG5cbiAgY29uc3QgRmlsdGVyU2hlZXQgPSAoeyBpc1Zpc2libGUsIGN1cnJlbnRDYXRlZ29yeSwgb25TZWxlY3QsIG9uQ2xvc2UgfSkgPT4ge1xuICAgIGlmICghaXNWaXNpYmxlKSByZXR1cm4gbnVsbDtcbiAgICByZXR1cm4gKFxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJmaXhlZCBpbnNldC0wIHotWzYwXSBmbGV4IGl0ZW1zLWVuZCBqdXN0aWZ5LWNlbnRlciBzbTppdGVtcy1jZW50ZXIgcC00IGFuaW1hdGUtZmFkZS1pblwiPlxuICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJhYnNvbHV0ZSBpbnNldC0wIGJnLXN0b25lLTkwMC8yMCBkYXJrOmJnLWJsYWNrLzYwIGJhY2tkcm9wLWJsdXItc21cIiBvbkNsaWNrPXtvbkNsb3NlfT48L2Rpdj5cbiAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwicmVsYXRpdmUgdy1mdWxsIG1heC13LXNtIGJnLXdoaXRlIGRhcms6Ymctc3RvbmUtODUwIHJvdW5kZWQtMnhsIHAtNiBzaGFkb3cteGwgYW5pbWF0ZS1mbG9hdC11cCBzcGFjZS15LTIgbWF4LWgtWzgwdmhdIG92ZXJmbG93LXktYXV0byBuby1zY3JvbGxiYXJcIj5cbiAgICAgICAgICAgPGgzIGNsYXNzTmFtZT1cInRleHQteHMgZm9udC1ib2xkIHRleHQtc3RvbmUtNDAwIGRhcms6dGV4dC1zdG9uZS01MDAgdXBwZXJjYXNlIHRyYWNraW5nLXdpZGVzdCBtYi00IGZsZXggaXRlbXMtY2VudGVyIGdhcC0yXCI+PExpc3RGaWx0ZXIgc2l6ZT17MTR9IC8+6KGo56S644GZ44KL6KiA6JGJ44KS6YG444G2PC9oMz5cbiAgICAgICAgICAgPGJ1dHRvbiBcbiAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiBvblNlbGVjdChudWxsKX0gXG4gICAgICAgICAgICAgY2xhc3NOYW1lPXtgdy1mdWxsIHRleHQtbGVmdCBwLTQgcm91bmRlZC14bCB0cmFuc2l0aW9uLWFsbCBmbGV4IGp1c3RpZnktYmV0d2VlbiBpdGVtcy1jZW50ZXIgJHshY3VycmVudENhdGVnb3J5ID8gJ2JnLXN0b25lLTEwMCBkYXJrOmJnLXN0b25lLTgwMCBmb250LWJvbGQgdGV4dC1zdG9uZS04MDAgZGFyazp0ZXh0LXN0b25lLTIwMCcgOiAndGV4dC1zdG9uZS02MDAgZGFyazp0ZXh0LXN0b25lLTQwMCBob3ZlcjpiZy1zdG9uZS01MCBkYXJrOmhvdmVyOmJnLXN0b25lLTgwMCd9YH1cbiAgICAgICAgICAgPlxuICAgICAgICAgICAgIDxzcGFuPuOBmeOBueOBpuOBruiogOiRiTwvc3Bhbj5cbiAgICAgICAgICAgICB7IWN1cnJlbnRDYXRlZ29yeSAmJiA8Q2hlY2sgc2l6ZT17MTZ9IC8+fVxuICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICAge0NBVEVHT1JJRVMubWFwKGNhdCA9PiAoXG4gICAgICAgICAgICAgPGJ1dHRvbiBcbiAgICAgICAgICAgICAgIGtleT17Y2F0fSBcbiAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IG9uU2VsZWN0KGNhdCl9XG4gICAgICAgICAgICAgICBjbGFzc05hbWU9e2B3LWZ1bGwgdGV4dC1sZWZ0IHAtNCByb3VuZGVkLXhsIHRyYW5zaXRpb24tYWxsIGZsZXgganVzdGlmeS1iZXR3ZWVuIGl0ZW1zLWNlbnRlciAke2N1cnJlbnRDYXRlZ29yeSA9PT0gY2F0ID8gJ2JnLXN0b25lLTEwMCBkYXJrOmJnLXN0b25lLTgwMCBmb250LWJvbGQgdGV4dC1zdG9uZS04MDAgZGFyazp0ZXh0LXN0b25lLTIwMCcgOiAndGV4dC1zdG9uZS02MDAgZGFyazp0ZXh0LXN0b25lLTQwMCBob3ZlcjpiZy1zdG9uZS01MCBkYXJrOmhvdmVyOmJnLXN0b25lLTgwMCd9YH1cbiAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICA8c3Bhbj57Y2F0fTwvc3Bhbj5cbiAgICAgICAgICAgICAgIHtjdXJyZW50Q2F0ZWdvcnkgPT09IGNhdCAmJiA8Q2hlY2sgc2l6ZT17MTZ9IC8+fVxuICAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgICApKX1cbiAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJwdC00IG10LTIgYm9yZGVyLXQgYm9yZGVyLXN0b25lLTUwIGRhcms6Ym9yZGVyLXN0b25lLTgwMFwiPlxuICAgICAgICAgICAgICA8YnV0dG9uIG9uQ2xpY2s9e29uQ2xvc2V9IGNsYXNzTmFtZT1cInctZnVsbCBweS0zIHRleHQtc3RvbmUtNDAwIGhvdmVyOnRleHQtc3RvbmUtNjAwIGRhcms6aG92ZXI6dGV4dC1zdG9uZS0zMDAgdGV4dC14cyBmb250LWJvbGQgdHJhY2tpbmctd2lkZXN0XCI+6ZaJ44GY44KLPC9idXR0b24+XG4gICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5cbiAgICApO1xuICB9O1xuXG4gIGNvbnN0IENvbmZpcm1EaWFsb2cgPSAoeyBpc1Zpc2libGUsIHRpdGxlLCBtZXNzYWdlLCBhY3Rpb25MYWJlbCwgb25Db25maXJtLCBvbkNhbmNlbCB9KSA9PiB7XG4gICAgICBpZiAoIWlzVmlzaWJsZSkgcmV0dXJuIG51bGw7XG4gICAgICByZXR1cm4gPGRpdiBjbGFzc05hbWU9XCJmaXhlZCBpbnNldC0wIHotWzgwXSBmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlciBwLTYgYmctc3RvbmUtOTAwLzQwIGRhcms6YmctYmxhY2svNjAgYmFja2Ryb3AtYmx1ci1zbSBhbmltYXRlLWZhZGUtaW5cIj48ZGl2IGNsYXNzTmFtZT1cImJnLXdoaXRlIGRhcms6Ymctc3RvbmUtODAwIHJvdW5kZWQtMnhsIHAtOCBtYXgtdy14cyB3LWZ1bGwgc2hhZG93LXhsIHRleHQtY2VudGVyXCI+PGgzIGNsYXNzTmFtZT1cInRleHQtbGcgZm9udC1ib2xkIHRleHQtc3RvbmUtODAwIGRhcms6dGV4dC1zdG9uZS0yMDAgbWItMiBmb250LXNlcmlmXCI+e3RpdGxlfTwvaDM+PHAgY2xhc3NOYW1lPVwidGV4dC1zbSB0ZXh0LXN0b25lLTUwMCBkYXJrOnRleHQtc3RvbmUtNDAwIG1iLTggbGVhZGluZy1yZWxheGVkXCI+e21lc3NhZ2V9PC9wPjxkaXYgY2xhc3NOYW1lPVwic3BhY2UteS0zXCI+PGJ1dHRvbiBvbkNsaWNrPXtvbkNvbmZpcm19IGNsYXNzTmFtZT1cInctZnVsbCBweS0zIGJnLXN0b25lLTkwMCBkYXJrOmJnLXN0b25lLTcwMCB0ZXh0LXN0b25lLTUwIHJvdW5kZWQtbGcgZm9udC1ib2xkIHRleHQtc20gaG92ZXI6Ymctc3RvbmUtODAwIGRhcms6aG92ZXI6Ymctc3RvbmUtNjAwIHRyYW5zaXRpb24tY29sb3JzXCI+e2FjdGlvbkxhYmVsfTwvYnV0dG9uPjxidXR0b24gb25DbGljaz17b25DYW5jZWx9IGNsYXNzTmFtZT1cInctZnVsbCBweS0zIGJnLXN0b25lLTEwMCBkYXJrOmJnLXN0b25lLTkwMCB0ZXh0LXN0b25lLTYwMCBkYXJrOnRleHQtc3RvbmUtNDAwIHJvdW5kZWQtbGcgZm9udC1ib2xkIHRleHQtc20gaG92ZXI6Ymctc3RvbmUtMjAwIGRhcms6aG92ZXI6Ymctc3RvbmUtOTUwIHRyYW5zaXRpb24tY29sb3JzXCI+44Kt44Oj44Oz44K744OrPC9idXR0b24+PC9kaXY+PC9kaXY+PC9kaXY+O1xuICB9O1xuICBjb25zdCBGbG9hdGluZ1dyaXRlQnV0dG9uID0gKHsgb25DbGljayB9KSA9PiAoPGRpdiBjbGFzc05hbWU9XCJmaXhlZCBib3R0b20tNiBsZWZ0LTAgcmlnaHQtMCBmbGV4IGp1c3RpZnktY2VudGVyIHotNDAgcHgtNiBwb2ludGVyLWV2ZW50cy1ub25lXCI+PGJ1dHRvbiBvbkNsaWNrPXtvbkNsaWNrfSBjbGFzc05hbWU9XCJiZy1zdG9uZS05MDAgZGFyazpiZy1zdG9uZS03MDAgdGV4dC1zdG9uZS01MCBkYXJrOnRleHQtc3RvbmUtMTAwIHB4LTggcHktNCByb3VuZGVkLWZ1bGwgc2hhZG93LTJ4bCBmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMyBib3JkZXIgYm9yZGVyLXN0b25lLTcwMCBkYXJrOmJvcmRlci1zdG9uZS02MDAgcG9pbnRlci1ldmVudHMtYXV0byBhY3RpdmU6c2NhbGUtOTUgdHJhbnNpdGlvbi1hbGwgZHVyYXRpb24tMzAwIGhvdmVyOmJnLXN0b25lLTgwMCBkYXJrOmhvdmVyOmJnLXN0b25lLTYwMCBhbmltYXRlLWZsb2F0LXVwXCI+PFBlbkxpbmUgc2l6ZT17MjB9IHN0cm9rZVdpZHRoPXsyLjV9IC8+PHNwYW4gY2xhc3NOYW1lPVwidGV4dC1zbSBmb250LWJvbGQgdHJhY2tpbmctd2lkZXN0XCI+6KiY44GZPC9zcGFuPjwvYnV0dG9uPjwvZGl2Pik7XG4gIFxuICBjb25zdCBJbnB1dFZpZXcgPSAoeyBvblNhdmUsIGluaXRpYWxEYXRhID0gbnVsbCB9KSA9PiB7XG4gICAgICBjb25zdCBbdGV4dCwgc2V0VGV4dF0gPSB1c2VTdGF0ZShpbml0aWFsRGF0YSA/IGluaXRpYWxEYXRhLnRleHQgOiAnJyk7XG4gICAgICBjb25zdCBbc291cmNlLCBzZXRTb3VyY2VdID0gdXNlU3RhdGUoaW5pdGlhbERhdGEgPyBpbml0aWFsRGF0YS5zb3VyY2UgOiAnJyk7XG4gICAgICBjb25zdCBbc2VsZWN0ZWRDYXRlZ29yeSwgc2V0U2VsZWN0ZWRDYXRlZ29yeV0gPSB1c2VTdGF0ZShpbml0aWFsRGF0YSA/IGluaXRpYWxEYXRhLmNhdGVnb3J5IDogQ0FURUdPUklFU1swXSk7XG4gICAgICBjb25zdCB0ZXh0YXJlYVJlZiA9IHVzZVJlZihudWxsKTtcbiAgICAgIHVzZUVmZmVjdCgoKSA9PiB7IGlmIChpbml0aWFsRGF0YSkgeyBzZXRUZXh0KGluaXRpYWxEYXRhLnRleHQpOyBzZXRTb3VyY2UoaW5pdGlhbERhdGEuc291cmNlIHx8ICcnKTsgc2V0U2VsZWN0ZWRDYXRlZ29yeShpbml0aWFsRGF0YS5jYXRlZ29yeSk7IH0gZWxzZSB7IHNldFRleHQoJycpOyBzZXRTb3VyY2UoJycpOyBzZXRTZWxlY3RlZENhdGVnb3J5KENBVEVHT1JJRVNbMF0pOyB9IH0sIFtpbml0aWFsRGF0YV0pO1xuICAgICAgdXNlRWZmZWN0KCgpID0+IHsgaWYgKHRleHRhcmVhUmVmLmN1cnJlbnQpIHsgdGV4dGFyZWFSZWYuY3VycmVudC5zdHlsZS5oZWlnaHQgPSAnYXV0byc7IHRleHRhcmVhUmVmLmN1cnJlbnQuc3R5bGUuaGVpZ2h0ID0gYCR7dGV4dGFyZWFSZWYuY3VycmVudC5zY3JvbGxIZWlnaHR9cHhgOyB9IH0sIFt0ZXh0XSk7XG4gICAgICBjb25zdCBoYW5kbGVTYXZlID0gKCkgPT4geyBpZiAodGV4dC50cmltKCkpIG9uU2F2ZSh0ZXh0LCBzb3VyY2UsIHNlbGVjdGVkQ2F0ZWdvcnkpOyB9O1xuICAgICAgY29uc3QgaXNFZGl0TW9kZSA9ICEhaW5pdGlhbERhdGE7XG4gICAgICByZXR1cm4gKFxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBmbGV4LWNvbCBoLWZ1bGwgbWF4LXctbWQgbXgtYXV0byBwLTYgcHQtOCBwYi0yNCBhbmltYXRlLWZhZGUtaW4gb3ZlcmZsb3cteS1hdXRvIG5vLXNjcm9sbGJhclwiPlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4LWdyb3cgZmxleCBmbGV4LWNvbCBnYXAtNlwiPlxuICAgICAgICAgICAgICA8bGFiZWwgY2xhc3NOYW1lPVwidGV4dC1zdG9uZS01MDAgZGFyazp0ZXh0LXN0b25lLTQwMCB0ZXh0LXhzIGZvbnQtYm9sZCB0cmFja2luZy13aWRlc3QgdXBwZXJjYXNlIHNlbGVjdC1ub25lIGN1cnNvci1kZWZhdWx0IGFjdGl2ZTp0ZXh0LXN0b25lLTgwMCBkYXJrOmFjdGl2ZTp0ZXh0LXN0b25lLTIwMCB0cmFuc2l0aW9uLWNvbG9yc1wiPntpc0VkaXRNb2RlID8gJ+iogOiRieOCkue3qOmbhuOBmeOCiycgOiAn6KiA6JGJ44KS6KiY44GZJ308L2xhYmVsPlxuICAgICAgICAgICAgICA8dGV4dGFyZWEgcmVmPXt0ZXh0YXJlYVJlZn0gdmFsdWU9e3RleHR9IG9uQ2hhbmdlPXsoZSkgPT4gc2V0VGV4dChlLnRhcmdldC52YWx1ZSl9IHBsYWNlaG9sZGVyPVwi5b+D44Gr5q6L44Gj44Gf6KiA6JGJ44KS5YWl5YqbLi4uXCIgY2xhc3NOYW1lPVwidy1mdWxsIG1pbi1oLVs4cmVtXSBiZy10cmFuc3BhcmVudCB0ZXh0LWxnIGxlYWRpbmctcmVsYXhlZCB0ZXh0LXN0b25lLTgwMCBkYXJrOnRleHQtc3RvbmUtMjAwIHBsYWNlaG9sZGVyOnRleHQtc3RvbmUtMzAwIGRhcms6cGxhY2Vob2xkZXI6dGV4dC1zdG9uZS02MDAgcmVzaXplLW5vbmUgZm9jdXM6b3V0bGluZS1ub25lIGZvbnQtc2VyaWYgb3ZlcmZsb3ctaGlkZGVuIHRyYW5zaXRpb24tY29sb3JzXCIgYXV0b0ZvY3VzPXshaXNFZGl0TW9kZX0gLz5cbiAgICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJ0ZXh0XCIgdmFsdWU9e3NvdXJjZX0gb25DaGFuZ2U9eyhlKSA9PiBzZXRTb3VyY2UoZS50YXJnZXQudmFsdWUpfSBwbGFjZWhvbGRlcj1cIuWHuuWFuO+8iOS7u+aEj++8iVwiIGNsYXNzTmFtZT1cInctZnVsbCBiZy10cmFuc3BhcmVudCBib3JkZXItYiBib3JkZXItc3RvbmUtMjAwIGRhcms6Ym9yZGVyLXN0b25lLTcwMCBweS0yIG1iLTQgZm9jdXM6b3V0bGluZS1ub25lIGZvY3VzOmJvcmRlci1zdG9uZS00MDAgZGFyazpmb2N1czpib3JkZXItc3RvbmUtNTAwIHRleHQtc20gZm9udC1zZXJpZiB0ZXh0LXN0b25lLTYwMCBkYXJrOnRleHQtc3RvbmUtNDAwIHBsYWNlaG9sZGVyOnRleHQtc3RvbmUtMjAwIGRhcms6cGxhY2Vob2xkZXI6dGV4dC1zdG9uZS03MDAgdHJhbnNpdGlvbi1jb2xvcnNcIiAvPlxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInNwYWNlLXktM1wiPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZ3JpZCBncmlkLWNvbHMtMiBnYXAtMlwiPlxuICAgICAgICAgICAgICAgICAge0NBVEVHT1JJRVMubWFwKChjYXQpID0+IChcbiAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBrZXk9e2NhdH0gb25DbGljaz17KCkgPT4gc2V0U2VsZWN0ZWRDYXRlZ29yeShjYXQpfSBjbGFzc05hbWU9e2BweS0zIHB4LTIgdGV4dC1zbSByb3VuZGVkIHRyYW5zaXRpb24tYWxsIGR1cmF0aW9uLTIwMCBib3JkZXIgJHtzZWxlY3RlZENhdGVnb3J5ID09PSBjYXQgPyAnYmctc3RvbmUtODAwIGRhcms6Ymctc3RvbmUtNzAwIHRleHQtc3RvbmUtNTAgZGFyazp0ZXh0LXN0b25lLTEwMCBib3JkZXItc3RvbmUtODAwIGRhcms6Ym9yZGVyLXN0b25lLTcwMCBzaGFkb3ctbWQnIDogJ2JnLXdoaXRlIGRhcms6Ymctc3RvbmUtODAwIHRleHQtc3RvbmUtNjAwIGRhcms6dGV4dC1zdG9uZS00MDAgYm9yZGVyLXN0b25lLTIwMCBkYXJrOmJvcmRlci1zdG9uZS03MDAgaG92ZXI6Ym9yZGVyLXN0b25lLTQwMCBkYXJrOmhvdmVyOmJvcmRlci1zdG9uZS01MDAnfWB9PntjYXR9PC9idXR0b24+XG4gICAgICAgICAgICAgICAgICApKX1cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwicHQtNiBwYi00XCI+XG4gICAgICAgICAgICAgIDxidXR0b24gb25DbGljaz17aGFuZGxlU2F2ZX0gZGlzYWJsZWQ9eyF0ZXh0LnRyaW0oKX0gY2xhc3NOYW1lPXtgdy1mdWxsIHB5LTQgcm91bmRlZC1sZyBmb250LWJvbGQgdHJhY2tpbmctd2lkZXN0IHRyYW5zaXRpb24tYWxsIGR1cmF0aW9uLTIwMCAke3RleHQudHJpbSgpID8gJ2JnLXN0b25lLTgwMCBkYXJrOmJnLXN0b25lLTcwMCB0ZXh0LXN0b25lLTUwIGRhcms6dGV4dC1zdG9uZS0xMDAgc2hhZG93LWxnIGhvdmVyOmJnLXN0b25lLTcwMCBkYXJrOmhvdmVyOmJnLXN0b25lLTYwMCBhY3RpdmU6c2NhbGUtWzAuOThdJyA6ICdiZy1zdG9uZS0yMDAgZGFyazpiZy1zdG9uZS04MDAgdGV4dC1zdG9uZS00MDAgZGFyazp0ZXh0LXN0b25lLTYwMCBjdXJzb3Itbm90LWFsbG93ZWQnfWB9Pntpc0VkaXRNb2RlID8gJ+abtOaWsOOBmeOCiycgOiAn5L+d5a2Y44GZ44KLJ308L2J1dHRvbj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgKTtcbiAgfTtcbiAgY29uc3QgTGlzdFZpZXcgPSAoeyBxdW90ZXMsIG9uSXRlbUNsaWNrLCBvblN0YXJ0UmFuZG9tLCBmaWx0ZXJDYXRlZ29yeSwgb25PcGVuRmlsdGVyIH0pID0+IHtcbiAgICAgIGNvbnN0IGRpc3BsYXlRdW90ZXMgPSBmaWx0ZXJDYXRlZ29yeSA/IHF1b3Rlcy5maWx0ZXIocSA9PiBxLmNhdGVnb3J5ID09PSBmaWx0ZXJDYXRlZ29yeSkgOiBxdW90ZXM7XG4gICAgICBcbiAgICAgIHJldHVybiAoXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJoLWZ1bGwgb3ZlcmZsb3cteS1hdXRvIG1heC13LW1kIG14LWF1dG8gcC02IHBiLTMyIG5vLXNjcm9sbGJhclwiPlxuICAgICAgICAgICAge3F1b3Rlcy5sZW5ndGggPiAwICYmIChcbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGp1c3RpZnktZW5kIG1iLTQgcHgtMVwiPlxuICAgICAgICAgICAgICAgIDxidXR0b24gb25DbGljaz17b25PcGVuRmlsdGVyfSBjbGFzc05hbWU9XCJmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMS41IHRleHQtWzEwcHhdIGZvbnQtYm9sZCB0ZXh0LXN0b25lLTQwMCBob3Zlcjp0ZXh0LXN0b25lLTYwMCBkYXJrOnRleHQtc3RvbmUtNTAwIGRhcms6aG92ZXI6dGV4dC1zdG9uZS0zMDAgdHJhbnNpdGlvbi1jb2xvcnMgdHJhY2tpbmctd2lkZSBiZy1zdG9uZS0xMDAvODAgZGFyazpiZy1zdG9uZS04MDAvODAgcHgtMyBweS0xLjUgcm91bmRlZC1mdWxsIGJvcmRlciBib3JkZXItc3RvbmUtMjAwLzUwIGRhcms6Ym9yZGVyLXN0b25lLTcwMC81MFwiPlxuICAgICAgICAgICAgICAgICAgPExpc3RGaWx0ZXIgc2l6ZT17MTJ9IC8+XG4gICAgICAgICAgICAgICAgICA8c3Bhbj57ZmlsdGVyQ2F0ZWdvcnkgfHwgJ+OBmeOBueOBpuOBruiogOiRiSd9PC9zcGFuPlxuICAgICAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICl9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHtkaXNwbGF5UXVvdGVzLmxlbmd0aCA9PT0gMCAmJiBxdW90ZXMubGVuZ3RoID09PSAwID8gKFxuICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGZsZXgtY29sIGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlciBoLWZ1bGwgdGV4dC1zdG9uZS00MDAgZGFyazp0ZXh0LXN0b25lLTUwMCBwLTYgdGV4dC1jZW50ZXIgaXRhbGljIGZvbnQtc2VyaWZcIj7jgb7jgaDoqIDokYnjgYzjgYLjgorjgb7jgZvjgpPjgILkuIvjga7jgIzoqJjjgZnjgI3jgYvjgonlp4vjgoHjgb7jgZfjgofjgYbjgII8L2Rpdj5cbiAgICAgICAgICAgICkgOiBkaXNwbGF5UXVvdGVzLmxlbmd0aCA9PT0gMCA/IChcbiAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBmbGV4LWNvbCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXIgaC00OCB0ZXh0LXN0b25lLTQwMCBkYXJrOnRleHQtc3RvbmUtNTAwIHAtNiB0ZXh0LWNlbnRlciBpdGFsaWMgZm9udC1zZXJpZiB0ZXh0LXNtXCI+44GT44Gu44Kr44OG44K044Oq44Gu6KiA6JGJ44Gv44GC44KK44G+44Gb44KT44CCPC9kaXY+XG4gICAgICAgICAgICApIDogKFxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInNwYWNlLXktNlwiPlxuICAgICAgICAgICAgICAgIDxidXR0b24gb25DbGljaz17b25TdGFydFJhbmRvbX0gY2xhc3NOYW1lPVwidy1mdWxsIGZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktYmV0d2VlbiBweS00IHB4LTUgYmctc3RvbmUtMTAwIGRhcms6Ymctc3RvbmUtODAwIGJvcmRlciBib3JkZXItc3RvbmUtMjAwIGRhcms6Ym9yZGVyLXN0b25lLTcwMCByb3VuZGVkLTJ4bCBob3ZlcjpiZy1zdG9uZS0yMDAgZGFyazpob3ZlcjpiZy1zdG9uZS03MDAvODAgdHJhbnNpdGlvbi1hbGwgZ3JvdXAgYWN0aXZlOnNjYWxlLVswLjk4XVwiPlxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGl0ZW1zLWNlbnRlciBnYXAtM1wiPlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImJnLXdoaXRlIGRhcms6Ymctc3RvbmUtNzAwIHAtMi41IHJvdW5kZWQteGwgc2hhZG93LXNtIHRleHQtc3RvbmUtODAwIGRhcms6dGV4dC1zdG9uZS0yMDAgZ3JvdXAtaG92ZXI6cm90YXRlLTEyIHRyYW5zaXRpb24tdHJhbnNmb3JtXCI+PFNwYXJrbGVzIHNpemU9ezIwfSAvPjwvZGl2PlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInRleHQtbGVmdFwiPlxuICAgICAgICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cInRleHQtc20gZm9udC1ib2xkIHRleHQtc3RvbmUtODAwIGRhcms6dGV4dC1zdG9uZS0yMDAgdHJhY2tpbmctd2lkZXJcIj7oqIDokYnjgajjga7lho3kvJo8L3A+XG4gICAgICAgICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwidGV4dC1bMTBweF0gdGV4dC1zdG9uZS00MDAgZGFyazp0ZXh0LXN0b25lLTUwMCBmb250LXNlcmlmXCI+44GE44Gk44GL44Gu6KiA6JGJ44Gr44CB44G+44Gf5Ye65Lya44GGPC9wPlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgPENoZXZyb25SaWdodCBjbGFzc05hbWU9XCJ0ZXh0LXN0b25lLTMwMCBkYXJrOnRleHQtc3RvbmUtNjAwIGdyb3VwLWhvdmVyOnRleHQtc3RvbmUtNTAgZGFyazpncm91cC1ob3Zlcjp0ZXh0LXN0b25lLTQwMCB0cmFuc2l0aW9uLWNvbG9yc1wiIHNpemU9ezE4fSAvPlxuICAgICAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgICAgICAgIHtkaXNwbGF5UXVvdGVzLm1hcCgocXVvdGUpID0+IChcbiAgICAgICAgICAgICAgICAgIDxkaXYga2V5PXtxdW90ZS5pZH0gb25DbGljaz17KCkgPT4gb25JdGVtQ2xpY2socXVvdGUuaWQpfSBjbGFzc05hbWU9XCJncm91cCBiZy13aGl0ZSBkYXJrOmJnLXN0b25lLTg1MCBwLTYgcm91bmRlZC0yeGwgYm9yZGVyIGJvcmRlci1zdG9uZS0xMDAgZGFyazpib3JkZXItc3RvbmUtODAwIGhvdmVyOmJvcmRlci1zdG9uZS0zMDAgZGFyazpob3Zlcjpib3JkZXItc3RvbmUtNjAwIHRyYW5zaXRpb24tYWxsIGN1cnNvci1wb2ludGVyIGFjdGl2ZTpiZy1zdG9uZS01MCBkYXJrOmFjdGl2ZTpiZy1zdG9uZS04MDAgc2hhZG93LXNtIHRleHQtbGVmdFwiPlxuICAgICAgICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJ0ZXh0LWJhc2UgbGVhZGluZy1yZWxheGVkIHRleHQtc3RvbmUtODAwIGRhcms6dGV4dC1zdG9uZS0yMDAgd2hpdGVzcGFjZS1wcmUtd3JhcCBtYi0xIGZvbnQtc2VyaWYgbGluZS1jbGFtcC0zXCI+e3F1b3RlLnRleHR9PC9wPlxuICAgICAgICAgICAgICAgICAgICB7cXVvdGUuc291cmNlICYmIDxwIGNsYXNzTmFtZT1cInRleHQtWzEwcHhdIHRleHQtc3RvbmUtNDAwIGRhcms6dGV4dC1zdG9uZS01MDAgZm9udC1zZXJpZiBtYi0zIHRyYWNraW5nLXdpZGVcIj7igJQge3F1b3RlLnNvdXJjZX08L3A+fVxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXgganVzdGlmeS1iZXR3ZWVuIGl0ZW1zLWVuZCBib3JkZXItdCBib3JkZXItc3RvbmUtNTAgZGFyazpib3JkZXItc3RvbmUtODAwIHB0LTNcIj5cbiAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJ0ZXh0LXhzIHRleHQtc3RvbmUtNTAwIGRhcms6dGV4dC1zdG9uZS00MDAgYmctc3RvbmUtMTAwIGRhcms6Ymctc3RvbmUtODAwIHB4LTIgcHktMSByb3VuZGVkLWxnIGZvbnQtbWVkaXVtXCI+e3F1b3RlLmNhdGVnb3J5fTwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJ0ZXh0LVsxMHB4XSB0ZXh0LXN0b25lLTQwMCBkYXJrOnRleHQtc3RvbmUtNjAwIGZvbnQtbW9ub1wiPntuZXcgRGF0ZShxdW90ZS50aW1lc3RhbXApLnRvTG9jYWxlRGF0ZVN0cmluZygnamEtSlAnKX08L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgKSl9XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgKX1cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICk7XG4gIH07XG4gIGNvbnN0IFNpbmdsZVF1b3RlVmlldyA9ICh7IHF1b3RlLCBvbk5leHQsIG9uUHJldiwgaGFzTmV4dCwgaGFzUHJldiwgbmV4dExhYmVsLCBuZXh0SWNvbjogTmV4dEljb24sIG9uQ2xvc2UgfSkgPT4gKFxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGZsZXgtY29sIGgtZnVsbCBtYXgtdy1tZCBteC1hdXRvIHAtOCBwYi04IHJlbGF0aXZlIGFuaW1hdGUtZmFkZS1pbiBiZy1zdG9uZS01MCBkYXJrOmJnLXN0b25lLTkwMCBvdmVyZmxvdy15LWF1dG8gbm8tc2Nyb2xsYmFyIHRyYW5zaXRpb24tY29sb3JzIGR1cmF0aW9uLTMwMFwiPlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleC1ncm93IGZsZXggZmxleC1jb2wgaXRlbXMtY2VudGVyIHB0LTVcIj5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ3LWZ1bGwgdGV4dC1jZW50ZXJcIj5cbiAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cImlubGluZS1ibG9jayBweC0zIHB5LTEgcm91bmRlZC1mdWxsIGJvcmRlciBib3JkZXItc3RvbmUtMjAwIGRhcms6Ym9yZGVyLXN0b25lLTcwMCB0ZXh0LXhzIHRleHQtc3RvbmUtNTAwIGRhcms6dGV4dC1zdG9uZS00MDAgdHJhY2tpbmctd2lkZSBtYi04XCI+e3F1b3RlLmNhdGVnb3J5fTwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwicHgtMlwiPlxuICAgICAgICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cInRleHQteGwgbWQ6dGV4dC0yeGwgZm9udC1zZXJpZiB0ZXh0LXN0b25lLTgwMCBkYXJrOnRleHQtc3RvbmUtMjAwIHdoaXRlc3BhY2UtcHJlLXdyYXAgbWItNCBzZWxlY3QtdGV4dFwiIHN0eWxlPXt7IGxpbmVIZWlnaHQ6ICcxLjgnIH19PntxdW90ZS50ZXh0fTwvcD5cbiAgICAgICAgICAgICAgICAgICAgICB7cXVvdGUuc291cmNlICYmIDxwIGNsYXNzTmFtZT1cInRleHQtc20gdGV4dC1zdG9uZS01MDAgZGFyazp0ZXh0LXN0b25lLTQwMCBmb250LXNlcmlmIG1iLThcIj7igJQge3F1b3RlLnNvdXJjZX08L3A+fVxuICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibXQtOCBmbGV4IGp1c3RpZnktY2VudGVyIHRleHQtc3RvbmUtMzAwIGRhcms6dGV4dC1zdG9uZS03MDBcIj48ZGl2IGNsYXNzTmFtZT1cImgtcHggdy0xMiBiZy1zdG9uZS0zMDAgZGFyazpiZy1zdG9uZS03MDBcIj48L2Rpdj48L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJtdC00IHRleHQtWzEwcHhdIHRleHQtc3RvbmUtNDAwIGRhcms6dGV4dC1zdG9uZS02MDAgZm9udC1tb25vIHRyYWNraW5nLXdpZGVzdFwiPntuZXcgRGF0ZShxdW90ZS50aW1lc3RhbXApLnRvTG9jYWxlRGF0ZVN0cmluZygnamEtSlAnKX08L3A+XG4gICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJwdC02IHBiLTMyIHRleHQtY2VudGVyXCI+XG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBnYXAtMyBtYi02IG1pbi1oLVs2NHB4XVwiPlxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ3LTE2XCI+XG4gICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBvbkNsaWNrPXtvblByZXZ9IGRpc2FibGVkPXshaGFzUHJldn0gY2xhc3NOYW1lPVwidy1mdWxsIGgtZnVsbCBib3JkZXIgYm9yZGVyLXN0b25lLTMwMCBkYXJrOmJvcmRlci1zdG9uZS03MDAgcm91bmRlZC1sZyB0ZXh0LXN0b25lLTQwMCBkYXJrOnRleHQtc3RvbmUtNTAwIGVuYWJsZWQ6aG92ZXI6dGV4dC1zdG9uZS04MDAgZGFyazplbmFibGVkOmhvdmVyOnRleHQtc3RvbmUtMjAwIHRyYW5zaXRpb24tYWxsIGR1cmF0aW9uLTIwMCBiZy13aGl0ZSBkYXJrOmJnLXN0b25lLTgwMCBmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlciBkaXNhYmxlZDpvcGFjaXR5LTMwXCI+PENoZXZyb25MZWZ0IHNpemU9ezIwfSAvPjwvYnV0dG9uPlxuICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXgtZ3Jvd1wiPlxuICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gb25DbGljaz17b25OZXh0fSBkaXNhYmxlZD17IWhhc05leHR9IGNsYXNzTmFtZT1cInctZnVsbCBoLWZ1bGwgYm9yZGVyIGJvcmRlci1zdG9uZS0zMDAgZGFyazpib3JkZXItc3RvbmUtNzAwIHJvdW5kZWQtbGcgdGV4dC1zdG9uZS02MDAgZGFyazp0ZXh0LXN0b25lLTQwMCBlbmFibGVkOmhvdmVyOnRleHQtc3RvbmUtODAwIGRhcms6ZW5hYmxlZDpob3Zlcjp0ZXh0LXN0b25lLTIwMCBob3Zlcjpib3JkZXItc3RvbmUtNDAwIGRhcms6aG92ZXI6Ym9yZGVyLXN0b25lLTUwMCB0cmFuc2l0aW9uLWFsbCBkdXJhdGlvbi0yMDAgZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXIgZ2FwLTIgYmctd2hpdGUgZGFyazpiZy1zdG9uZS04MDAgc2hhZG93LXNtIGRpc2FibGVkOm9wYWNpdHktMzBcIj48c3BhbiBjbGFzc05hbWU9XCJ0ZXh0LXNtIGZvbnQtYm9sZCB0cmFja2luZy13aWRlc3RcIj57bmV4dExhYmVsfTwvc3Bhbj48TmV4dEljb24gc2l6ZT17MTZ9IC8+PC9idXR0b24+XG4gICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgIDxidXR0b24gb25DbGljaz17b25DbG9zZX0gY2xhc3NOYW1lPVwidGV4dC14cyB0ZXh0LXN0b25lLTQwMCBkYXJrOnRleHQtc3RvbmUtNTAwIGhvdmVyOnRleHQtc3RvbmUtNjAwIGRhcms6aG92ZXI6dGV4dC1zdG9uZS0zMDAgdHJhbnNpdGlvbi1jb2xvcnMgdHJhY2tpbmctd2lkZXN0IGZvbnQtYm9sZCBweS0yIHB4LTRcIj7kuIDopqfjgavmiLvjgos8L2J1dHRvbj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PlxuICApO1xuXG4gIGNvbnN0IEFwcCA9ICgpID0+IHtcbiAgICAgICAgY29uc3QgW3VzZXIsIHNldFVzZXJdID0gdXNlU3RhdGUobnVsbCk7XG4gICAgICAgIGNvbnN0IFtzaG9ydENvZGUsIHNldFNob3J0Q29kZV0gPSB1c2VTdGF0ZSgnJyk7IFxuICAgICAgICBjb25zdCBbaXNMb2FkaW5nQ29kZSwgc2V0SXNMb2FkaW5nQ29kZV0gPSB1c2VTdGF0ZShmYWxzZSk7XG4gICAgICAgIGNvbnN0IFtjb2RlRXJyb3IsIHNldENvZGVFcnJvcl0gPSB1c2VTdGF0ZShudWxsKTtcbiAgICAgICAgY29uc3QgW3N5bmNVc2VySWQsIHNldFN5bmNVc2VySWRdID0gdXNlU3RhdGUobnVsbCk7IFxuICAgICAgICBjb25zdCBbdmlld01vZGUsIHNldFZpZXdNb2RlXSA9IHVzZVN0YXRlKCdsaXN0Jyk7XG4gICAgICAgIGNvbnN0IFtzZWxlY3RlZFF1b3RlSWQsIHNldFNlbGVjdGVkUXVvdGVJZF0gPSB1c2VTdGF0ZShudWxsKTtcbiAgICAgICAgY29uc3QgW3JhbmRvbUhpc3RvcnksIHNldFJhbmRvbUhpc3RvcnldID0gdXNlU3RhdGUoW10pO1xuICAgICAgICBjb25zdCBbcXVvdGVzLCBzZXRRdW90ZXNdID0gdXNlU3RhdGUoW10pO1xuICAgICAgICBjb25zdCBbdG9hc3QsIHNldFRvYXN0XSA9IHVzZVN0YXRlKHsgc2hvdzogZmFsc2UsIG1lc3NhZ2U6ICcnIH0pO1xuICAgICAgICBjb25zdCBbZGlhbG9nU3RhdGUsIHNldERpYWxvZ1N0YXRlXSA9IHVzZVN0YXRlKHsgaXNWaXNpYmxlOiBmYWxzZSwgdHlwZTogbnVsbCwgaWQ6IG51bGwgfSk7XG4gICAgICAgIGNvbnN0IFtpc0RhcmtNb2RlLCBzZXRJc0RhcmtNb2RlXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgICAgICAgY29uc3QgW2ZpbHRlckNhdGVnb3J5LCBzZXRGaWx0ZXJDYXRlZ29yeV0gPSB1c2VTdGF0ZShudWxsKTtcbiAgICAgICAgY29uc3QgW2lzRmlsdGVyVmlzaWJsZSwgc2V0SXNGaWx0ZXJWaXNpYmxlXSA9IHVzZVN0YXRlKGZhbHNlKTtcblxuICAgICAgICAvLyDjg4bjg7zjg57jga7liJ3mnJ/ljJbjgajliIfjgormm7/jgYhcbiAgICAgICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgICAgICBjb25zdCBzYXZlZFRoZW1lID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3RoZW1lJyk7XG4gICAgICAgICAgLy8gRGF544Oi44O844OJ44KS44OH44OV44Kp44Or44OI44Gr44GZ44KL44Gf44KB44CB5L+d5a2Y44GM44Gq44GE5aC05ZCI44GvRGF577yIZWxzZeODluODreODg+OCr++8ieOBuOiqmOWwjlxuICAgICAgICAgIGlmIChzYXZlZFRoZW1lID09PSAnZGFyaycpIHtcbiAgICAgICAgICAgIHNldElzRGFya01vZGUodHJ1ZSk7XG4gICAgICAgICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnZGFyaycpO1xuICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignbWV0YVtuYW1lPVwidGhlbWUtY29sb3JcIl0nKS5zZXRBdHRyaWJ1dGUoJ2NvbnRlbnQnLCAnIzBjMGEwOScpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzZXRJc0RhcmtNb2RlKGZhbHNlKTtcbiAgICAgICAgICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdkYXJrJyk7XG4gICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdtZXRhW25hbWU9XCJ0aGVtZS1jb2xvclwiXScpLnNldEF0dHJpYnV0ZSgnY29udGVudCcsICcjZmFmYWY5Jyk7XG4gICAgICAgICAgfVxuICAgICAgICB9LCBbXSk7XG5cbiAgICAgICAgY29uc3QgdG9nZ2xlVGhlbWUgPSAoKSA9PiB7XG4gICAgICAgICAgY29uc3QgbmV3TW9kZSA9ICFpc0RhcmtNb2RlO1xuICAgICAgICAgIHNldElzRGFya01vZGUobmV3TW9kZSk7XG4gICAgICAgICAgaWYgKG5ld01vZGUpIHtcbiAgICAgICAgICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGFzc0xpc3QuYWRkKCdkYXJrJyk7XG4gICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgndGhlbWUnLCAnZGFyaycpO1xuICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignbWV0YVtuYW1lPVwidGhlbWUtY29sb3JcIl0nKS5zZXRBdHRyaWJ1dGUoJ2NvbnRlbnQnLCAnIzBjMGEwOScpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnZGFyaycpO1xuICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3RoZW1lJywgJ2xpZ2h0Jyk7XG4gICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdtZXRhW25hbWU9XCJ0aGVtZS1jb2xvclwiXScpLnNldEF0dHJpYnV0ZSgnY29udGVudCcsICcjZmFmYWY5Jyk7XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIGNvbnN0IGZldGNoVXNlckRhdGEgPSBhc3luYyAoY3VycmVudFVzZXIpID0+IHtcbiAgICAgICAgICBpZiAoIWN1cnJlbnRVc2VyKSByZXR1cm47XG4gICAgICAgICAgc2V0SXNMb2FkaW5nQ29kZSh0cnVlKTsgXG4gICAgICAgICAgc2V0Q29kZUVycm9yKG51bGwpO1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCB1c2VyQ29kZVJlZiA9IGRvYyhkYiwgJ2FydGlmYWN0cycsIGFwcElkLCAncHVibGljJywgJ2RhdGEnLCAndXNlckNvZGVzJywgY3VycmVudFVzZXIudWlkKTtcbiAgICAgICAgICAgIGNvbnN0IGNvZGVTbmFwID0gYXdhaXQgZ2V0RG9jKHVzZXJDb2RlUmVmKTtcbiAgICAgICAgICAgIGlmIChjb2RlU25hcC5leGlzdHMoKSkgeyBcbiAgICAgICAgICAgICAgICBzZXRTaG9ydENvZGUoY29kZVNuYXAuZGF0YSgpLmNvZGUpOyBcbiAgICAgICAgICAgIH0gZWxzZSB7IFxuICAgICAgICAgICAgICAgIGNvbnN0IG5ld0NvZGUgPSBnZW5lcmF0ZVNob3J0Q29kZSgpOyBcbiAgICAgICAgICAgICAgICBhd2FpdCBzZXREb2MoZG9jKGRiLCAnYXJ0aWZhY3RzJywgYXBwSWQsICdwdWJsaWMnLCAnZGF0YScsICdzeW5jQ29kZXMnLCBuZXdDb2RlKSwgeyB1aWQ6IGN1cnJlbnRVc2VyLnVpZCB9KTsgXG4gICAgICAgICAgICAgICAgYXdhaXQgc2V0RG9jKHVzZXJDb2RlUmVmLCB7IGNvZGU6IG5ld0NvZGUgfSk7IFxuICAgICAgICAgICAgICAgIHNldFNob3J0Q29kZShuZXdDb2RlKTsgXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBjYXRjaCAoZSkgeyBcbiAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIkZldGNoIEVycm9yOlwiLCBlKTsgXG4gICAgICAgICAgICAgIGxldCBtc2cgPSBcIuaOpee2muOCqOODqeODvFwiOyBcbiAgICAgICAgICAgICAgaWYgKGUuY29kZSA9PT0gJ3Blcm1pc3Npb24tZGVuaWVkJykgbXNnID0gXCLmqKnpmZDjgYzjgYLjgorjgb7jgZvjgpNcIjsgXG4gICAgICAgICAgICAgIHNldENvZGVFcnJvcihtc2cpOyBcbiAgICAgICAgICB9IGZpbmFsbHkgeyBcbiAgICAgICAgICAgICAgc2V0SXNMb2FkaW5nQ29kZShmYWxzZSk7IFxuICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgICAgICAgc2V0UGVyc2lzdGVuY2UoYXV0aCwgYnJvd3NlckxvY2FsUGVyc2lzdGVuY2UpXG4gICAgICAgICAgICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB1bnN1YnNjcmliZSA9IG9uQXV0aFN0YXRlQ2hhbmdlZChhdXRoLCAodSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRVc2VyKHUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZldGNoVXNlckRhdGEodSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpZ25JbkFub255bW91c2x5KGF1dGgpLmNhdGNoKChlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJBdXRoIEVycm9yOlwiLCBlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG1zZyA9IFwi6KqN6Ki844Ko44Op44O8XCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlLmNvZGUgPT09ICdhdXRoL29wZXJhdGlvbi1ub3QtYWxsb3dlZCcpIG1zZyA9IFwi5Yy/5ZCN44Ot44Kw44Kk44Oz44GM54Sh5Yq544Gn44GZXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldENvZGVFcnJvcihtc2cpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICgpID0+IHVuc3Vic2NyaWJlKCk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJQZXJzaXN0ZW5jZSBFcnJvcjpcIiwgZXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICBvbkF1dGhTdGF0ZUNoYW5nZWQoYXV0aCwgKHUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHUpIHsgc2V0VXNlcih1KTsgZmV0Y2hVc2VyRGF0YSh1KTsgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfSwgW10pO1xuXG4gICAgICAgIGNvbnN0IGFjdGl2ZVVzZXJJZCA9IHN5bmNVc2VySWQgfHwgKHVzZXIgPyB1c2VyLnVpZCA6IG51bGwpO1xuICAgICAgICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgICAgIGlmICghYWN0aXZlVXNlcklkKSB7IHNldFF1b3RlcyhbXSk7IHJldHVybjsgfVxuICAgICAgICAgIGNvbnN0IHEgPSBxdWVyeShjb2xsZWN0aW9uKGRiLCAnYXJ0aWZhY3RzJywgYXBwSWQsICd1c2VycycsIGFjdGl2ZVVzZXJJZCwgJ3F1b3RlcycpKTtcbiAgICAgICAgICBjb25zdCB1bnN1YnNjcmliZSA9IG9uU25hcHNob3QocSwgKHNuYXBzaG90KSA9PiB7XG4gICAgICAgICAgICBjb25zdCBkb2NzID0gc25hcHNob3QuZG9jcy5tYXAoZG9jID0+ICh7IGlkOiBkb2MuaWQsIC4uLmRvYy5kYXRhKCkgfSkpO1xuICAgICAgICAgICAgc2V0UXVvdGVzKGRvY3Muc29ydCgoYSwgYikgPT4gKGIudGltZXN0YW1wIHx8IDApIC0gKGEudGltZXN0YW1wIHx8IDApKSk7XG4gICAgICAgICAgfSwgKGVycikgPT4geyBjb25zb2xlLmVycm9yKFwiRmlyZXN0b3JlIFN5bmMgRXJyb3I6XCIsIGVycik7IH0pO1xuICAgICAgICAgIHJldHVybiAoKSA9PiB1bnN1YnNjcmliZSgpO1xuICAgICAgICB9LCBbYWN0aXZlVXNlcklkXSk7XG5cbiAgICAgICAgY29uc3Qgc2hvd1RvYXN0ID0gKG1lc3NhZ2UpID0+IHNldFRvYXN0KHsgc2hvdzogdHJ1ZSwgbWVzc2FnZSB9KTtcbiAgICAgICAgY29uc3QgaGFuZGxlU3luY0J5Q29kZSA9IGFzeW5jIChjb2RlKSA9PiB7IGlmICghdXNlcikgcmV0dXJuOyBjb25zdCBjbGVhbkNvZGUgPSBjb2RlLnRyaW0oKS50b1VwcGVyQ2FzZSgpOyB0cnkgeyBjb25zdCBtYXBwaW5nUmVmID0gZG9jKGRiLCAnYXJ0aWZhY3RzJywgYXBwSWQsICdwdWJsaWMnLCAnZGF0YScsICdzeW5jQ29kZXMnLCBjbGVhbkNvZGUpOyBjb25zdCBtYXBwaW5nU25hcCA9IGF3YWl0IGdldERvYyhtYXBwaW5nUmVmKTsgaWYgKG1hcHBpbmdTbmFwLmV4aXN0cygpKSB7IHNldFN5bmNVc2VySWQobWFwcGluZ1NuYXAuZGF0YSgpLnVpZCk7IHNldFZpZXdNb2RlKCdsaXN0Jyk7IHNob3dUb2FzdChcIuWQjOacn+OCkumWi+Wni+OBl+OBvuOBl+OBn1wiKTsgfSBlbHNlIHsgc2hvd1RvYXN0KFwi44Kz44O844OJ44GM6KaL44Gk44GL44KK44G+44Gb44KTXCIpOyB9IH0gY2F0Y2ggKGUpIHsgc2hvd1RvYXN0KFwi5ZCM5pyf44Ko44Op44O844GM55m655Sf44GX44G+44GX44GfXCIpOyB9IH07XG4gICAgICAgIGNvbnN0IGFkZFF1b3RlID0gYXN5bmMgKHRleHQsIHNvdXJjZSwgY2F0ZWdvcnkpID0+IHsgaWYgKCFhY3RpdmVVc2VySWQpIHJldHVybjsgYXdhaXQgYWRkRG9jKGNvbGxlY3Rpb24oZGIsICdhcnRpZmFjdHMnLCBhcHBJZCwgJ3VzZXJzJywgYWN0aXZlVXNlcklkLCAncXVvdGVzJyksIHsgdGV4dCwgc291cmNlLCBjYXRlZ29yeSwgdGltZXN0YW1wOiBEYXRlLm5vdygpIH0pOyBzaG93VG9hc3QoXCLoqIDokYnjgpLkv53lrZjjgZfjgb7jgZfjgZ9cIik7IHNldFZpZXdNb2RlKCdsaXN0Jyk7IH07XG4gICAgICAgIGNvbnN0IHVwZGF0ZVF1b3RlID0gYXN5bmMgKHRleHQsIHNvdXJjZSwgY2F0ZWdvcnkpID0+IHsgaWYgKCFhY3RpdmVVc2VySWQgfHwgIXNlbGVjdGVkUXVvdGVJZCkgcmV0dXJuOyBhd2FpdCB1cGRhdGVEb2MoZG9jKGRiLCAnYXJ0aWZhY3RzJywgYXBwSWQsICd1c2VycycsIGFjdGl2ZVVzZXJJZCwgJ3F1b3RlcycsIHNlbGVjdGVkUXVvdGVJZCksIHsgdGV4dCwgc291cmNlLCBjYXRlZ29yeSB9KTsgc2hvd1RvYXN0KFwi6KiA6JGJ44KS5pu05paw44GX44G+44GX44GfXCIpOyBzZXRWaWV3TW9kZShyYW5kb21IaXN0b3J5Lmxlbmd0aCA+IDAgPyAncmFuZG9tJyA6ICdkZXRhaWwnKTsgfTtcbiAgICAgICAgY29uc3QgaGFuZGxlQ29uZmlybUFjdGlvbiA9IGFzeW5jICgpID0+IHsgaWYgKGRpYWxvZ1N0YXRlLnR5cGUgPT09ICdxdW90ZScpIGF3YWl0IGNvbmZpcm1EZWxldGVRdW90ZSgpOyBlbHNlIGlmIChkaWFsb2dTdGF0ZS50eXBlID09PSAnYWNjb3VudCcpIGF3YWl0IGNvbmZpcm1SZXNldEFjY291bnQoKTsgfTtcbiAgICAgICAgY29uc3QgY29uZmlybURlbGV0ZVF1b3RlID0gYXN5bmMgKCkgPT4geyBpZiAoIWFjdGl2ZVVzZXJJZCB8fCAhZGlhbG9nU3RhdGUuaWQpIHJldHVybjsgYXdhaXQgZGVsZXRlRG9jKGRvYyhkYiwgJ2FydGlmYWN0cycsIGFwcElkLCAndXNlcnMnLCBhY3RpdmVVc2VySWQsICdxdW90ZXMnLCBkaWFsb2dTdGF0ZS5pZCkpOyBzaG93VG9hc3QoXCLliYrpmaTjgZfjgb7jgZfjgZ9cIik7IHNldERpYWxvZ1N0YXRlKHsgaXNWaXNpYmxlOiBmYWxzZSwgdHlwZTogbnVsbCwgaWQ6IG51bGwgfSk7IHNldFZpZXdNb2RlKCdsaXN0Jyk7IHNldFNlbGVjdGVkUXVvdGVJZChudWxsKTsgfTtcbiAgICAgICAgY29uc3QgY29uZmlybVJlc2V0QWNjb3VudCA9IGFzeW5jICgpID0+IHsgaWYgKCF1c2VyIHx8ICFzaG9ydENvZGUpIHJldHVybjsgdHJ5IHsgY29uc3QgcXVvdGVzUmVmID0gY29sbGVjdGlvbihkYiwgJ2FydGlmYWN0cycsIGFwcElkLCAndXNlcnMnLCB1c2VyLnVpZCwgJ3F1b3RlcycpOyBjb25zdCBzbmFwID0gYXdhaXQgZ2V0RG9jcyhxdW90ZXNSZWYpOyBjb25zdCBkZWxldGVQcm9taXNlcyA9IHNuYXAuZG9jcy5tYXAoZCA9PiBkZWxldGVEb2MoZC5yZWYpKTsgYXdhaXQgUHJvbWlzZS5hbGwoZGVsZXRlUHJvbWlzZXMpOyBhd2FpdCBkZWxldGVEb2MoZG9jKGRiLCAnYXJ0aWZhY3RzJywgYXBwSWQsICdwdWJsaWMnLCAnZGF0YScsICdzeW5jQ29kZXMnLCBzaG9ydENvZGUpKTsgYXdhaXQgZGVsZXRlRG9jKGRvYyhkYiwgJ2FydGlmYWN0cycsIGFwcElkLCAncHVibGljJywgJ2RhdGEnLCAndXNlckNvZGVzJywgdXNlci51aWQpKTsgc2hvd1RvYXN0KFwi5Yid5pyf5YyW44GX44G+44GX44Gf44CC44Oq44Ot44O844OJ44GX44G+44GZLi4uXCIpOyBzZXRUaW1lb3V0KCgpID0+IHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKSwgMTUwMCk7IH0gY2F0Y2ggKGUpIHsgY29uc29sZS5lcnJvcihlKTsgc2hvd1RvYXN0KFwi5Yid5pyf5YyW44Gr5aSx5pWX44GX44G+44GX44GfXCIpOyBzZXREaWFsb2dTdGF0ZSh7IGlzVmlzaWJsZTogZmFsc2UsIHR5cGU6IG51bGwsIGlkOiBudWxsIH0pOyB9IH07XG4gICAgICAgIFxuICAgICAgICBjb25zdCBoYW5kbGVUaXRsZUNsaWNrID0gKGUpID0+IHtcbiAgICAgICAgICAgIGlmIChlLmRldGFpbCA9PT0gMykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGh0bWxDb250ZW50ID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50Lm91dGVySFRNTDtcbiAgICAgICAgICAgICAgICBjb25zdCBibG9iID0gbmV3IEJsb2IoW2h0bWxDb250ZW50XSwgeyB0eXBlOiAndGV4dC9odG1sJyB9KTtcbiAgICAgICAgICAgICAgICBjb25zdCB1cmwgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XG4gICAgICAgICAgICAgICAgYS5ocmVmID0gdXJsO1xuICAgICAgICAgICAgICAgIGEuZG93bmxvYWQgPSAnaW5kZXguaHRtbCc7XG4gICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChhKTtcbiAgICAgICAgICAgICAgICBhLmNsaWNrKCk7XG4gICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChhKTtcbiAgICAgICAgICAgICAgICBVUkwucmV2b2tlT2JqZWN0VVJMKHVybCk7XG4gICAgICAgICAgICAgICAgc2hvd1RvYXN0KFwiSFRNTOODleOCoeOCpOODq+OCkuODgOOCpuODs+ODreODvOODieOBl+OBvuOBl+OBn1wiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICBjb25zdCBUaGVtZVRvZ2dsZSA9ICgpID0+IChcbiAgICAgICAgICA8YnV0dG9uIG9uQ2xpY2s9e3RvZ2dsZVRoZW1lfSBjbGFzc05hbWU9XCJwLTIgdGV4dC1zdG9uZS00MDAgaG92ZXI6dGV4dC1zdG9uZS04MDAgZGFyazpob3Zlcjp0ZXh0LXN0b25lLTIwMCB0cmFuc2l0aW9uLWNvbG9yc1wiPlxuICAgICAgICAgICAge2lzRGFya01vZGUgPyA8U3VuIHNpemU9ezI0fSAvPiA6IDxNb29uIHNpemU9ezI0fSAvPn1cbiAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgKTtcblxuICAgICAgICBjb25zdCBjdXJyZW50UXVvdGVJbmRleCA9IHF1b3Rlcy5maW5kSW5kZXgocSA9PiBxLmlkID09PSBzZWxlY3RlZFF1b3RlSWQpO1xuICAgICAgICBjb25zdCBjdXJyZW50UXVvdGUgPSBxdW90ZXNbY3VycmVudFF1b3RlSW5kZXhdO1xuXG4gICAgICAgIGxldCBsZWZ0QWN0aW9ucyA9IG51bGw7IGxldCByaWdodEFjdGlvbnMgPSBudWxsO1xuICAgICAgICBzd2l0Y2ggKHZpZXdNb2RlKSB7XG4gICAgICAgICAgY2FzZSAnbGlzdCc6IFxuICAgICAgICAgICAgbGVmdEFjdGlvbnMgPSA8VGhlbWVUb2dnbGUgLz47XG4gICAgICAgICAgICByaWdodEFjdGlvbnMgPSA8YnV0dG9uIG9uQ2xpY2s9eygpID0+IHNldFZpZXdNb2RlKCdzZXR0aW5ncycpfSBjbGFzc05hbWU9XCJwLTIgLW1yLTIgdGV4dC1zdG9uZS00MDAgaG92ZXI6dGV4dC1zdG9uZS04MDAgZGFyazpob3Zlcjp0ZXh0LXN0b25lLTIwMCB0cmFuc2l0aW9uLWNvbG9yc1wiPjxNZW51IHNpemU9ezI0fSAvPjwvYnV0dG9uPjsgXG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlICdpbnB1dCc6IGNhc2UgJ3NldHRpbmdzJzogXG4gICAgICAgICAgICByaWdodEFjdGlvbnMgPSA8YnV0dG9uIG9uQ2xpY2s9eygpID0+IHNldFZpZXdNb2RlKCdsaXN0Jyl9IGNsYXNzTmFtZT1cInAtMiAtbXItMiB0ZXh0LXN0b25lLTQwMCBob3Zlcjp0ZXh0LXN0b25lLTgwMCBkYXJrOmhvdmVyOnRleHQtc3RvbmUtMjAwIHRyYW5zaXRpb24tY29sb3JzXCI+PFggc2l6ZT17MjR9IC8+PC9idXR0b24+OyBcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgJ2VkaXQnOiBcbiAgICAgICAgICAgIHJpZ2h0QWN0aW9ucyA9IDxidXR0b24gb25DbGljaz17KCkgPT4gc2V0Vmlld01vZGUocmFuZG9tSGlzdG9yeS5sZW5ndGggPiAwID8gJ3JhbmRvbScgOiAnZGV0YWlsJyl9IGNsYXNzTmFtZT1cInAtMiAtbXItMiB0ZXh0LXN0b25lLTQwMCBob3Zlcjp0ZXh0LXN0b25lLTgwMCBkYXJrOmhvdmVyOnRleHQtc3RvbmUtMjAwIHRyYW5zaXRpb24tY29sb3JzXCI+PFggc2l6ZT17MjR9IC8+PC9idXR0b24+OyBcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgJ2RldGFpbCc6IGNhc2UgJ3JhbmRvbSc6IFxuICAgICAgICAgICAgbGVmdEFjdGlvbnMgPSA8YnV0dG9uIG9uQ2xpY2s9eygpID0+IHsgc2V0Vmlld01vZGUoJ2xpc3QnKTsgc2V0UmFuZG9tSGlzdG9yeShbXSk7IHNldFNlbGVjdGVkUXVvdGVJZChudWxsKTsgfX0gY2xhc3NOYW1lPVwicC0yIC1tbC0yIHRleHQtc3RvbmUtNDAwIGhvdmVyOnRleHQtc3RvbmUtODAwIGRhcms6aG92ZXI6dGV4dC1zdG9uZS0yMDAgdHJhbnNpdGlvbi1jb2xvcnNcIj48QXJyb3dMZWZ0IHNpemU9ezI0fSAvPjwvYnV0dG9uPjsgXG4gICAgICAgICAgICByaWdodEFjdGlvbnMgPSAoPGRpdiBjbGFzc05hbWU9XCJmbGV4IGdhcC0xIC1tci0yXCI+PGJ1dHRvbiBvbkNsaWNrPXsoKSA9PiBzZXREaWFsb2dTdGF0ZSh7IGlzVmlzaWJsZTogdHJ1ZSwgdHlwZTogJ3F1b3RlJywgaWQ6IHNlbGVjdGVkUXVvdGVJZCB9KX0gY2xhc3NOYW1lPVwicC0yIHRleHQtc3RvbmUtNDAwIGhvdmVyOnRleHQtcmVkLTUwMCB0cmFuc2l0aW9uLWNvbG9yc1wiPjxUcmFzaDIgc2l6ZT17MjB9IC8+PC9idXR0b24+PGJ1dHRvbiBvbkNsaWNrPXsoKSA9PiBzZXRWaWV3TW9kZSgnZWRpdCcpfSBjbGFzc05hbWU9XCJwLTIgdGV4dC1zdG9uZS00MDAgaG92ZXI6dGV4dC1zdG9uZS04MDAgZGFyazpob3Zlcjp0ZXh0LXN0b25lLTIwMCB0cmFuc2l0aW9uLWNvbG9yc1wiPjxFZGl0MiBzaXplPXsyMH0gLz48L2J1dHRvbj48L2Rpdj4pOyBcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCF1c2VyKSByZXR1cm4gPGRpdiBjbGFzc05hbWU9XCJoLXNjcmVlbiBmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlciBmb250LXNlcmlmIHRleHQtc3RvbmUtNDAwIGRhcms6dGV4dC1zdG9uZS01MDAgaXRhbGljIGJnLXN0b25lLTUwIGRhcms6Ymctc3RvbmUtOTAwXCI+6Kqt44G/6L6844G/5LitLi4uPC9kaXY+O1xuXG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJoLVsxMDBkdmhdIGJnLXN0b25lLTUwIGRhcms6Ymctc3RvbmUtOTAwIHRleHQtc3RvbmUtODAwIGRhcms6dGV4dC1zdG9uZS0yMDAgZm9udC1zYW5zIHNlbGVjdGlvbjpiZy1zdG9uZS0yMDAgZGFyazpzZWxlY3Rpb246Ymctc3RvbmUtNzAwIG92ZXJmbG93LWhpZGRlbiBmbGV4IGZsZXgtY29sIHRyYW5zaXRpb24tY29sb3JzIGR1cmF0aW9uLTMwMFwiPlxuICAgICAgICAgICAgICA8c3R5bGU+e2BAbWVkaWEgKG1pbi13aWR0aDogNjQwcHgpIHsgYm9keSB7IHBhZGRpbmctdG9wOiAxNnB4OyB9IH1gfTwvc3R5bGU+XG4gICAgICAgICAgICAgIDxIZWFkZXIgb25UaXRsZUNsaWNrPXtoYW5kbGVUaXRsZUNsaWNrfSBsZWZ0QWN0aW9ucz17bGVmdEFjdGlvbnN9IHJpZ2h0QWN0aW9ucz17cmlnaHRBY3Rpb25zfSAvPlxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXgtZ3JvdyBvdmVyZmxvdy1oaWRkZW4gcmVsYXRpdmVcIiBzdHlsZT17eyBwYWRkaW5nVG9wOiAnNjRweCcgfX0+XG4gICAgICAgICAgICAgICAgICA8bWFpbiBjbGFzc05hbWU9XCJoLWZ1bGwgcmVsYXRpdmUgb3ZlcmZsb3ctaGlkZGVuXCI+XG4gICAgICAgICAgICAgICAgICAgICAge3ZpZXdNb2RlID09PSAnaW5wdXQnICYmIDxJbnB1dFZpZXcgb25TYXZlPXthZGRRdW90ZX0gLz59XG4gICAgICAgICAgICAgICAgICAgICAge3ZpZXdNb2RlID09PSAnbGlzdCcgJiYgKFxuICAgICAgICAgICAgICAgICAgICAgICAgPExpc3RWaWV3IFxuICAgICAgICAgICAgICAgICAgICAgICAgICBxdW90ZXM9e3F1b3Rlc30gXG4gICAgICAgICAgICAgICAgICAgICAgICAgIG9uSXRlbUNsaWNrPXsoaWQpID0+IHsgc2V0U2VsZWN0ZWRRdW90ZUlkKGlkKTsgc2V0Vmlld01vZGUoJ2RldGFpbCcpOyB9fSBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgb25TdGFydFJhbmRvbT17KCkgPT4geyBpZiAocXVvdGVzLmxlbmd0aCA+IDApIHsgY29uc3QgZmlyc3QgPSBxdW90ZXNbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogcXVvdGVzLmxlbmd0aCldOyBzZXRTZWxlY3RlZFF1b3RlSWQoZmlyc3QuaWQpOyBzZXRSYW5kb21IaXN0b3J5KFtmaXJzdC5pZF0pOyBzZXRWaWV3TW9kZSgncmFuZG9tJyk7IH0gfX0gXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGZpbHRlckNhdGVnb3J5PXtmaWx0ZXJDYXRlZ29yeX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgb25PcGVuRmlsdGVyPXsoKSA9PiBzZXRJc0ZpbHRlclZpc2libGUodHJ1ZSl9XG4gICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAge3ZpZXdNb2RlID09PSAnZGV0YWlsJyAmJiBjdXJyZW50UXVvdGUgJiYgPFNpbmdsZVF1b3RlVmlldyBxdW90ZT17Y3VycmVudFF1b3RlfSBvbk5leHQ9eygpID0+IHNldFNlbGVjdGVkUXVvdGVJZChxdW90ZXNbKGN1cnJlbnRRdW90ZUluZGV4ICsgMSkgJSBxdW90ZXMubGVuZ3RoXS5pZCl9IG9uUHJldj17KCkgPT4gc2V0U2VsZWN0ZWRRdW90ZUlkKHF1b3Rlc1soY3VycmVudFF1b3RlSW5kZXggLSAxICsgcXVvdGVzLmxlbmd0aCkgJSBxdW90ZXMubGVuZ3RoXS5pZCl9IGhhc05leHQ9e2N1cnJlbnRRdW90ZUluZGV4IDwgcXVvdGVzLmxlbmd0aCAtIDF9IGhhc1ByZXY9e2N1cnJlbnRRdW90ZUluZGV4ID4gMH0gbmV4dExhYmVsPVwi5qyh44Gu6KiA6JGJ44G4XCIgbmV4dEljb249e0NoZXZyb25SaWdodH0gb25DbG9zZT17KCkgPT4gc2V0Vmlld01vZGUoJ2xpc3QnKX0gLz59XG4gICAgICAgICAgICAgICAgICAgICAge3ZpZXdNb2RlID09PSAncmFuZG9tJyAmJiBjdXJyZW50UXVvdGUgJiYgPFNpbmdsZVF1b3RlVmlldyBxdW90ZT17Y3VycmVudFF1b3RlfSBvbk5leHQ9eygpID0+IHsgbGV0IG47IGRvIHsgbiA9IHF1b3Rlc1tNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBxdW90ZXMubGVuZ3RoKV0uaWQ7IH0gd2hpbGUgKG4gPT09IHNlbGVjdGVkUXVvdGVJZCAmJiBxdW90ZXMubGVuZ3RoID4gMSk7IHNldFNlbGVjdGVkUXVvdGVJZChuKTsgc2V0UmFuZG9tSGlzdG9yeShwID0+IFsuLi5wLCBuXSk7IH19IG9uUHJldj17KCkgPT4geyBjb25zdCBoID0gWy4uLnJhbmRvbUhpc3RvcnldOyBoLnBvcCgpOyBjb25zdCBwID0gaFtoLmxlbmd0aCAtIDFdOyBzZXRTZWxlY3RlZFF1b3RlSWQocCk7IHNldFJhbmRvbUhpc3RvcnkoaCk7IH19IGhhc05leHQ9e3F1b3Rlcy5sZW5ndGggPiAxfSBoYXNQcmV2PXtyYW5kb21IaXN0b3J5Lmxlbmd0aCA+IDF9IG5leHRMYWJlbD1cIuWIpeOBruiogOiRieOBq+WHuuS8muOBhlwiIG5leHRJY29uPXtTcGFya2xlc30gb25DbG9zZT17KCkgPT4gc2V0Vmlld01vZGUoJ2xpc3QnKX0gLz59XG4gICAgICAgICAgICAgICAgICAgICAge3ZpZXdNb2RlID09PSAnZWRpdCcgJiYgY3VycmVudFF1b3RlICYmIDxJbnB1dFZpZXcgaW5pdGlhbERhdGE9e2N1cnJlbnRRdW90ZX0gb25TYXZlPXt1cGRhdGVRdW90ZX0gLz59XG4gICAgICAgICAgICAgICAgICAgICAge3ZpZXdNb2RlID09PSAnc2V0dGluZ3MnICYmIDxTeW5jU2V0dGluZ3NWaWV3IGN1cnJlbnRTaG9ydENvZGU9e3Nob3J0Q29kZX0gaXNMb2FkaW5nQ29kZT17aXNMb2FkaW5nQ29kZX0gZXJyb3JNc2c9e2NvZGVFcnJvcn0gb25SZXRyeUNvZGU9eygpID0+IGZldGNoVXNlckRhdGEodXNlcil9IG9uU3luY0NvZGU9e2hhbmRsZVN5bmNCeUNvZGV9IG9uUmVxdWVzdFJlc2V0PXsoKSA9PiBzZXREaWFsb2dTdGF0ZSh7IGlzVmlzaWJsZTogdHJ1ZSwgdHlwZTogJ2FjY291bnQnLCBpZDogbnVsbCB9KX0gc2hvd1RvYXN0PXtzaG93VG9hc3R9IC8+fVxuICAgICAgICAgICAgICAgICAgPC9tYWluPlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgPEZpbHRlclNoZWV0IGlzVmlzaWJsZT17aXNGaWx0ZXJWaXNpYmxlfSBjdXJyZW50Q2F0ZWdvcnk9e2ZpbHRlckNhdGVnb3J5fSBvblNlbGVjdD17KGNhdCkgPT4geyBzZXRGaWx0ZXJDYXRlZ29yeShjYXQpOyBzZXRJc0ZpbHRlclZpc2libGUoZmFsc2UpOyB9fSBvbkNsb3NlPXsoKSA9PiBzZXRJc0ZpbHRlclZpc2libGUoZmFsc2UpfSAvPlxuICAgICAgICAgICAgICB7dmlld01vZGUgPT09ICdsaXN0JyAmJiA8RmxvYXRpbmdXcml0ZUJ1dHRvbiBvbkNsaWNrPXsoKSA9PiBzZXRWaWV3TW9kZSgnaW5wdXQnKX0gLz59XG4gICAgICAgICAgICAgIDxDb25maXJtRGlhbG9nIGlzVmlzaWJsZT17ZGlhbG9nU3RhdGUuaXNWaXNpYmxlfSB0aXRsZT17ZGlhbG9nU3RhdGUudHlwZSA9PT0gJ2FjY291bnQnID8gXCLlhajjg4fjg7zjgr/jgpLliYrpmaTjgZfjgb7jgZnjgYvvvJ9cIiA6IFwi6KiA6JGJ44KS5YmK6Zmk44GX44G+44GZ44GL77yfXCJ9IG1lc3NhZ2U9e2RpYWxvZ1N0YXRlLnR5cGUgPT09ICdhY2NvdW50JyA/IFwi44GC44Gq44Gf44Gu6KiA6JGJ44CB6Kit5a6a44CB5ZCM5pyf44Kz44O844OJ44GM44GZ44G544Gm5YmK6Zmk44GV44KM44CB44Ki44OX44Oq44GM5Yid5pyf5YyW44GV44KM44G+44GZ44CC44GT44Gu5pON5L2c44Gv5Y+W44KK5raI44Gb44G+44Gb44KT44CCXCIgOiBcIuS4gOW6puWJiumZpOOBl+OBn+iogOiRieOBr+WFg+OBq+aIu+OBmeOBk+OBqOOBjOOBp+OBjeOBvuOBm+OCk+OAglwifSBhY3Rpb25MYWJlbD17ZGlhbG9nU3RhdGUudHlwZSA9PT0gJ2FjY291bnQnID8gXCLlhajliYrpmaTjgZfjgabliJ3mnJ/ljJZcIiA6IFwi5YmK6Zmk44GZ44KLXCJ9IG9uQ29uZmlybT17aGFuZGxlQ29uZmlybUFjdGlvbn0gb25DYW5jZWw9eygpID0+IHNldERpYWxvZ1N0YXRlKHsgaXNWaXNpYmxlOiBmYWxzZSwgdHlwZTogbnVsbCwgaWQ6IG51bGwgfSl9IC8+XG4gICAgICAgICAgICAgIDxUb2FzdCBtZXNzYWdlPXt0b2FzdC5tZXNzYWdlfSBpc1Zpc2libGU9e3RvYXN0LnNob3d9IG9uSGlkZT17KCkgPT4gc2V0VG9hc3QocCA9PiAoeyAuLi5wLCBzaG93OiBmYWxzZSB9KSl9IC8+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICk7XG4gIH07XG4gIGNvbnN0IHJvb3QgPSBjcmVhdGVSb290KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyb290JykpOyByb290LnJlbmRlcig8QXBwIC8+KTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUNFLE9BQU9BLEtBQUssSUFBSUMsUUFBUSxFQUFFQyxTQUFTLEVBQUVDLE1BQU0sUUFBUSxPQUFPO0FBQzFELFNBQVNDLFVBQVUsUUFBUSxrQkFBa0I7QUFDN0MsT0FBTyxLQUFLQyxXQUFXLE1BQU0sY0FBYztBQUMzQyxTQUFTQyxhQUFhLFFBQVEsY0FBYztBQUM1QyxTQUFTQyxPQUFPLEVBQUVDLGlCQUFpQixFQUFFQyxrQkFBa0IsRUFBRUMsY0FBYyxFQUFFQyx1QkFBdUIsUUFBUSxlQUFlO0FBQ3ZILFNBQVNDLFlBQVksRUFBRUMsVUFBVSxFQUFFQyxHQUFHLEVBQUVDLE1BQU0sRUFBRUMsTUFBTSxFQUFFQyxPQUFPLEVBQUVDLE1BQU0sRUFBRUMsU0FBUyxFQUFFQyxTQUFTLEVBQUVDLFVBQVUsRUFBRUMsS0FBSyxRQUFRLG9CQUFvQjtBQUU1SSxJQUFNO0VBQUVDLE9BQU87RUFBRUMsUUFBUTtFQUFFQyxLQUFLO0VBQUVDLFlBQVk7RUFBRUMsV0FBVztFQUFFQyxTQUFTO0VBQUVDLEtBQUs7RUFBRUMsTUFBTTtFQUFFQyxJQUFJO0VBQUVDLElBQUk7RUFBRUMsU0FBUztFQUFFQyxDQUFDO0VBQUVDLFdBQVc7RUFBRUMsSUFBSTtFQUFFQyxHQUFHO0VBQUVDO0FBQVcsQ0FBQyxHQUFHakMsV0FBVztBQUVuSyxJQUFNa0MsY0FBYyxHQUFHO0VBQUMsUUFBUSxFQUFDLHlDQUF5QztFQUFDLFlBQVksRUFBQyxnQ0FBZ0M7RUFBQyxXQUFXLEVBQUMsZ0JBQWdCO0VBQUMsZUFBZSxFQUFDLG9DQUFvQztFQUFDLG1CQUFtQixFQUFDLGNBQWM7RUFBQyxPQUFPLEVBQUMsMkNBQTJD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</script></head>
<body class="bg-stone-50 dark:bg-stone-900 transition-colors duration-300">
<div id="root"><div class="h-[100dvh] bg-stone-50 dark:bg-stone-900 text-stone-800 dark:text-stone-200 font-sans selection:bg-stone-200 dark:selection:bg-stone-700 overflow-hidden flex flex-col transition-colors duration-300"><style>@media (min-width: 640px) { body { padding-top: 16px; } }</style><header class="fixed top-0 left-0 right-0 z-50 h-16 bg-stone-50/90 dark:bg-stone-900/90 backdrop-blur-md border-b border-stone-200 dark:border-stone-800 px-6 flex items-center justify-between shadow-sm transition-colors duration-300"><div class="w-20 flex justify-start items-center"><button class="p-2 text-stone-400 hover:text-stone-800 dark:hover:text-stone-200 transition-colors"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-moon"><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"></path></svg></button></div><h1 class="text-xl font-serif font-bold tracking-tight text-stone-800 dark:text-stone-200 cursor-default select-none active:opacity-70 transition-opacity" title="トリプルクリックでダウンロード">Kotobako</h1><div class="w-20 flex justify-end items-center gap-1"><button class="p-2 -mr-2 text-stone-400 hover:text-stone-800 dark:hover:text-stone-200 transition-colors"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-menu"><line x1="4" x2="20" y1="12" y2="12"></line><line x1="4" x2="20" y1="6" y2="6"></line><line x1="4" x2="20" y1="18" y2="18"></line></svg></button></div></header><div class="flex-grow overflow-hidden relative" style="padding-top: 64px;"><main class="h-full relative overflow-hidden"><div class="h-full overflow-y-auto max-w-md mx-auto p-6 pb-32 no-scrollbar"><div class="flex justify-end mb-4 px-1"><button class="flex items-center gap-1.5 text-[10px] font-bold text-stone-400 hover:text-stone-600 dark:text-stone-500 dark:hover:text-stone-300 transition-colors tracking-wide bg-stone-100/80 dark:bg-stone-800/80 px-3 py-1.5 rounded-full border border-stone-200/50 dark:border-stone-700/50"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-list-filter"><path d="M3 6h18"></path><path d="M7 12h10"></path><path d="M10 18h4"></path></svg><span>すべての言葉</span></button></div><div class="space-y-6"><button class="w-full flex items-center justify-between py-4 px-5 bg-stone-100 dark:bg-stone-800 border border-stone-200 dark:border-stone-700 rounded-2xl hover:bg-stone-200 dark:hover:bg-stone-700/80 transition-all group active:scale-[0.98]"><div class="flex items-center gap-3"><div class="bg-white dark:bg-stone-700 p-2.5 rounded-xl shadow-sm text-stone-800 dark:text-stone-200 group-hover:rotate-12 transition-transform"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-sparkles"><path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"></path><path d="M5 3v4"></path><path d="M19 17v4"></path><path d="M3 5h4"></path><path d="M17 19h4"></path></svg></div><div class="text-left"><p class="text-sm font-bold text-stone-800 dark:text-stone-200 tracking-wider">言葉との再会</p><p class="text-[10px] text-stone-400 dark:text-stone-500 font-serif">いつかの言葉に、また出会う</p></div></div><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-stone-300 dark:text-stone-600 group-hover:text-stone-50 dark:group-hover:text-stone-400 transition-colors"><path d="m9 18 6-6-6-6"></path></svg></button><div class="group bg-white dark:bg-stone-850 p-6 rounded-2xl border border-stone-100 dark:border-stone-800 hover:border-stone-300 dark:hover:border-stone-600 transition-all cursor-pointer active:bg-stone-50 dark:active:bg-stone-800 shadow-sm text-left"><p class="text-base leading-relaxed text-stone-800 dark:text-stone-200 whitespace-pre-wrap mb-1 font-serif line-clamp-3">具体的には、リスト画面の右上に控えめな「フィルターボタン」を配置し、それをタップすると画面下部からタグ選択メニューが浮かび上がる（ボトムシート形式の）UIを実装しました。これなら、普段は言葉そのものに集中でき、必要な時だけ機能にアクセスできます。</p><div class="flex justify-between items-end border-t border-stone-50 dark:border-stone-800 pt-3"><span class="text-xs text-stone-500 dark:text-stone-400 bg-stone-100 dark:bg-stone-800 px-2 py-1 rounded-lg font-medium">心に残った</span><span class="text-[10px] text-stone-400 dark:text-stone-600 font-mono">2026/1/16</span></div></div></div></div></main></div><div class="fixed bottom-6 left-0 right-0 flex justify-center z-40 px-6 pointer-events-none"><button class="bg-stone-900 dark:bg-stone-700 text-stone-50 dark:text-stone-100 px-8 py-4 rounded-full shadow-2xl flex items-center gap-3 border border-stone-700 dark:border-stone-600 pointer-events-auto active:scale-95 transition-all duration-300 hover:bg-stone-800 dark:hover:bg-stone-600 animate-float-up"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-pen-line"><path d="M12 20h9"></path><path d="M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z"></path></svg><span class="text-sm font-bold tracking-widest">記す</span></button></div></div></div>
<script type="text/babel" data-type="module">
  import React, { useState, useEffect, useRef } from 'react';
  import { createRoot } from 'react-dom/client';
  import * as LucideIcons from 'lucide-react';
  import { initializeApp } from 'firebase/app';
  import { getAuth, signInAnonymously, onAuthStateChanged, setPersistence, browserLocalPersistence } from 'firebase/auth';
  import { getFirestore, collection, doc, setDoc, getDoc, getDocs, addDoc, updateDoc, deleteDoc, onSnapshot, query } from 'firebase/firestore';

  const { PenLine, Sparkles, Check, ChevronRight, ChevronLeft, ArrowLeft, Edit2, Trash2, Menu, Copy, RefreshCw, X, AlertCircle, Moon, Sun, ListFilter } = LucideIcons;

  const firebaseConfig = {"apiKey":"AIzaSyBLw99hdYwzQKaWFacV3HdIAsa_adAna9k","authDomain":"kotobako-ec686.firebaseapp.com","projectId":"kotobako-ec686","storageBucket":"kotobako-ec686.firebasestorage.app","messagingSenderId":"836620257824","appId":"1:836620257824:web:5a76bf0e646e37f1fb4a45","measurementId":"G-9XDCCZ1BDM"};
  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);
  const appId = 'koto-no-ha-app';
  const CATEGORIES = ["心に残った", "新たな気づき", "おもしろい", "役立ちそう"];

  const generateShortCode = () => {
      const chars = 'ABCDEFGHJKLMNPQRSTUVWXYZ23456789';
      let result = '';
      for (let i = 0; i < 4; i++) result += chars.charAt(Math.floor(Math.random() * chars.length));
      result += '-';
      for (let i = 0; i < 4; i++) result += chars.charAt(Math.floor(Math.random() * chars.length));
      return result;
  };

  const Header = ({ onTitleClick, leftActions, rightActions }) => (
      <header className="fixed top-0 left-0 right-0 z-50 h-16 bg-stone-50/90 dark:bg-stone-900/90 backdrop-blur-md border-b border-stone-200 dark:border-stone-800 px-6 flex items-center justify-between shadow-sm transition-colors duration-300">
          <div className="w-20 flex justify-start items-center">{leftActions}</div>
          <h1 onClick={onTitleClick} className="text-xl font-serif font-bold tracking-tight text-stone-800 dark:text-stone-200 cursor-default select-none active:opacity-70 transition-opacity" title="トリプルクリックでダウンロード">Kotobako</h1>
          <div className="w-20 flex justify-end items-center gap-1">{rightActions}</div>
      </header>
  );

  const SyncSettingsView = ({ currentShortCode, isLoadingCode, errorMsg, onRetryCode, onSyncCode, onRequestReset, showToast }) => {
      const [inputId, setInputId] = useState('');
      const handleCopy = () => { if (!currentShortCode || currentShortCode.length < 8) return; navigator.clipboard.writeText(currentShortCode); showToast("同期コードをコピーしました"); };
      return (
          <div className="flex flex-col h-full max-w-md mx-auto p-6 pt-6 pb-24 animate-fade-in overflow-y-auto no-scrollbar">
            <div className="space-y-8">
              <div className="space-y-3">
                <label className="text-stone-500 dark:text-stone-400 text-[10px] font-bold tracking-widest uppercase block ml-1">あなたの同期コード</label>
                <div className="flex items-center gap-2 bg-white dark:bg-stone-800 p-4 rounded-xl border border-stone-200 dark:border-stone-700 shadow-sm transition-colors duration-300">
                  <code className="flex-grow text-xl font-mono font-bold text-stone-800 dark:text-stone-200 tracking-tighter text-center">{isLoadingCode ? '...' : (errorMsg ? 'エラー' : currentShortCode)}</code>
                  <button onClick={handleCopy} disabled={!currentShortCode || currentShortCode.includes('...')} className="p-2 text-stone-400 hover:text-stone-800 dark:hover:text-stone-200 bg-stone-50 dark:bg-stone-700 rounded-lg active:scale-95 transition-all disabled:opacity-30"><Copy size={20} /></button>
                </div>
                {errorMsg && <div className="flex items-center justify-center gap-2 text-red-400 text-xs mt-2"><AlertCircle size={14} /><span>{errorMsg}</span><button onClick={onRetryCode} className="underline">再試行</button></div>}
                <p className="text-[10px] text-stone-400 dark:text-stone-500 leading-relaxed italic px-1">この8文字を別の端末で入力すると、言葉を同期できます。</p>
              </div>
              <div className="relative">
                <div className="absolute inset-0 flex items-center"><div className="w-full border-t border-stone-100 dark:border-stone-800"></div></div>
                <div className="relative flex justify-center text-[10px] uppercase"><span className="bg-stone-50 dark:bg-stone-900 px-3 text-stone-300 dark:text-stone-600 font-bold tracking-widest transition-colors duration-300">or</span></div>
              </div>
              <div className="space-y-4">
                <label className="text-stone-500 dark:text-stone-400 text-[10px] font-bold tracking-widest uppercase block ml-1">別のコードと同期する</label>
                <input type="text" value={inputId} onChange={(e) => setInputId(e.target.value.toUpperCase())} placeholder="例: ABCD-1234" className="w-full bg-white dark:bg-stone-800 border border-stone-200 dark:border-stone-700 p-4 rounded-xl text-lg text-center focus:outline-none focus:border-stone-400 dark:focus:border-stone-500 text-stone-800 dark:text-stone-200 font-mono font-bold shadow-sm transition-colors duration-300" />
                <button onClick={() => onSyncCode(inputId)} disabled={!inputId.trim() || inputId.length < 9} className="w-full py-4 bg-stone-900 dark:bg-stone-700 text-stone-50 dark:text-stone-200 rounded-xl font-bold text-sm tracking-widest disabled:opacity-30 transition-all active:scale-[0.98] shadow-md hover:bg-stone-800 dark:hover:bg-stone-600">同期を開始する</button>
                <p className="text-[10px] text-stone-400 dark:text-stone-500 leading-relaxed italic px-1 text-center">※入力したコードのデータに切り替わります。</p>
              </div>
              <div className="pt-8 mt-8 border-t border-stone-100 dark:border-stone-800">
                <button onClick={onRequestReset} className="w-full py-4 text-red-400 hover:text-red-600 dark:hover:text-red-300 text-xs font-bold tracking-widest transition-colors flex items-center justify-center gap-2"><Trash2 size={16} /><span>全データを削除して初期化</span></button>
              </div>
            </div>
          </div>
      );
  };
  
  const Toast = ({ message, isVisible, onHide }) => {
      useEffect(() => { if (isVisible) { const timer = setTimeout(onHide, 2000); return () => clearTimeout(timer); } }, [isVisible, onHide]);
      if (!isVisible) return null;
      return <div className="fixed top-20 left-1/2 transform -translate-x-1/2 z-[100] animate-fade-in pointer-events-none"><div className="bg-stone-800 dark:bg-stone-700 text-stone-50 dark:text-stone-100 px-4 py-2 rounded-full shadow-lg text-sm font-medium flex items-center gap-2 border border-stone-700 dark:border-stone-600"><Check size={14} />{message}</div></div>;
  };

  const FilterSheet = ({ isVisible, currentCategory, onSelect, onClose }) => {
    if (!isVisible) return null;
    return (
      <div className="fixed inset-0 z-[60] flex items-end justify-center sm:items-center p-4 animate-fade-in">
         <div className="absolute inset-0 bg-stone-900/20 dark:bg-black/60 backdrop-blur-sm" onClick={onClose}></div>
         <div className="relative w-full max-w-sm bg-white dark:bg-stone-850 rounded-2xl p-6 shadow-xl animate-float-up space-y-2 max-h-[80vh] overflow-y-auto no-scrollbar">
           <h3 className="text-xs font-bold text-stone-400 dark:text-stone-500 uppercase tracking-widest mb-4 flex items-center gap-2"><ListFilter size={14} />表示する言葉を選ぶ</h3>
           <button 
             onClick={() => onSelect(null)} 
             className={`w-full text-left p-4 rounded-xl transition-all flex justify-between items-center ${!currentCategory ? 'bg-stone-100 dark:bg-stone-800 font-bold text-stone-800 dark:text-stone-200' : 'text-stone-600 dark:text-stone-400 hover:bg-stone-50 dark:hover:bg-stone-800'}`}
           >
             <span>すべての言葉</span>
             {!currentCategory && <Check size={16} />}
           </button>
           {CATEGORIES.map(cat => (
             <button 
               key={cat} 
               onClick={() => onSelect(cat)}
               className={`w-full text-left p-4 rounded-xl transition-all flex justify-between items-center ${currentCategory === cat ? 'bg-stone-100 dark:bg-stone-800 font-bold text-stone-800 dark:text-stone-200' : 'text-stone-600 dark:text-stone-400 hover:bg-stone-50 dark:hover:bg-stone-800'}`}
             >
               <span>{cat}</span>
               {currentCategory === cat && <Check size={16} />}
             </button>
           ))}
           <div className="pt-4 mt-2 border-t border-stone-50 dark:border-stone-800">
              <button onClick={onClose} className="w-full py-3 text-stone-400 hover:text-stone-600 dark:hover:text-stone-300 text-xs font-bold tracking-widest">閉じる</button>
           </div>
         </div>
      </div>
    );
  };

  const ConfirmDialog = ({ isVisible, title, message, actionLabel, onConfirm, onCancel }) => {
      if (!isVisible) return null;
      return <div className="fixed inset-0 z-[80] flex items-center justify-center p-6 bg-stone-900/40 dark:bg-black/60 backdrop-blur-sm animate-fade-in"><div className="bg-white dark:bg-stone-800 rounded-2xl p-8 max-w-xs w-full shadow-xl text-center"><h3 className="text-lg font-bold text-stone-800 dark:text-stone-200 mb-2 font-serif">{title}</h3><p className="text-sm text-stone-500 dark:text-stone-400 mb-8 leading-relaxed">{message}</p><div className="space-y-3"><button onClick={onConfirm} className="w-full py-3 bg-stone-900 dark:bg-stone-700 text-stone-50 rounded-lg font-bold text-sm hover:bg-stone-800 dark:hover:bg-stone-600 transition-colors">{actionLabel}</button><button onClick={onCancel} className="w-full py-3 bg-stone-100 dark:bg-stone-900 text-stone-600 dark:text-stone-400 rounded-lg font-bold text-sm hover:bg-stone-200 dark:hover:bg-stone-950 transition-colors">キャンセル</button></div></div></div>;
  };
  const FloatingWriteButton = ({ onClick }) => (<div className="fixed bottom-6 left-0 right-0 flex justify-center z-40 px-6 pointer-events-none"><button onClick={onClick} className="bg-stone-900 dark:bg-stone-700 text-stone-50 dark:text-stone-100 px-8 py-4 rounded-full shadow-2xl flex items-center gap-3 border border-stone-700 dark:border-stone-600 pointer-events-auto active:scale-95 transition-all duration-300 hover:bg-stone-800 dark:hover:bg-stone-600 animate-float-up"><PenLine size={20} strokeWidth={2.5} /><span className="text-sm font-bold tracking-widest">記す</span></button></div>);
  
  const InputView = ({ onSave, initialData = null }) => {
      const [text, setText] = useState(initialData ? initialData.text : '');
      const [source, setSource] = useState(initialData ? initialData.source : '');
      const [selectedCategory, setSelectedCategory] = useState(initialData ? initialData.category : CATEGORIES[0]);
      const textareaRef = useRef(null);
      useEffect(() => { if (initialData) { setText(initialData.text); setSource(initialData.source || ''); setSelectedCategory(initialData.category); } else { setText(''); setSource(''); setSelectedCategory(CATEGORIES[0]); } }, [initialData]);
      useEffect(() => { if (textareaRef.current) { textareaRef.current.style.height = 'auto'; textareaRef.current.style.height = `${textareaRef.current.scrollHeight}px`; } }, [text]);
      const handleSave = () => { if (text.trim()) onSave(text, source, selectedCategory); };
      const isEditMode = !!initialData;
      return (
          <div className="flex flex-col h-full max-w-md mx-auto p-6 pt-8 pb-24 animate-fade-in overflow-y-auto no-scrollbar">
            <div className="flex-grow flex flex-col gap-6">
              <label className="text-stone-500 dark:text-stone-400 text-xs font-bold tracking-widest uppercase select-none cursor-default active:text-stone-800 dark:active:text-stone-200 transition-colors">{isEditMode ? '言葉を編集する' : '言葉を記す'}</label>
              <textarea ref={textareaRef} value={text} onChange={(e) => setText(e.target.value)} placeholder="心に残った言葉を入力..." className="w-full min-h-[8rem] bg-transparent text-lg leading-relaxed text-stone-800 dark:text-stone-200 placeholder:text-stone-300 dark:placeholder:text-stone-600 resize-none focus:outline-none font-serif overflow-hidden transition-colors" autoFocus={!isEditMode} />
              <input type="text" value={source} onChange={(e) => setSource(e.target.value)} placeholder="出典（任意）" className="w-full bg-transparent border-b border-stone-200 dark:border-stone-700 py-2 mb-4 focus:outline-none focus:border-stone-400 dark:focus:border-stone-500 text-sm font-serif text-stone-600 dark:text-stone-400 placeholder:text-stone-200 dark:placeholder:text-stone-700 transition-colors" />
              <div className="space-y-3">
                <div className="grid grid-cols-2 gap-2">
                  {CATEGORIES.map((cat) => (
                    <button key={cat} onClick={() => setSelectedCategory(cat)} className={`py-3 px-2 text-sm rounded transition-all duration-200 border ${selectedCategory === cat ? 'bg-stone-800 dark:bg-stone-700 text-stone-50 dark:text-stone-100 border-stone-800 dark:border-stone-700 shadow-md' : 'bg-white dark:bg-stone-800 text-stone-600 dark:text-stone-400 border-stone-200 dark:border-stone-700 hover:border-stone-400 dark:hover:border-stone-500'}`}>{cat}</button>
                  ))}
                </div>
              </div>
            </div>
            <div className="pt-6 pb-4">
              <button onClick={handleSave} disabled={!text.trim()} className={`w-full py-4 rounded-lg font-bold tracking-widest transition-all duration-200 ${text.trim() ? 'bg-stone-800 dark:bg-stone-700 text-stone-50 dark:text-stone-100 shadow-lg hover:bg-stone-700 dark:hover:bg-stone-600 active:scale-[0.98]' : 'bg-stone-200 dark:bg-stone-800 text-stone-400 dark:text-stone-600 cursor-not-allowed'}`}>{isEditMode ? '更新する' : '保存する'}</button>
            </div>
          </div>
      );
  };
  const ListView = ({ quotes, onItemClick, onStartRandom, filterCategory, onOpenFilter }) => {
      const displayQuotes = filterCategory ? quotes.filter(q => q.category === filterCategory) : quotes;
      
      return (
          <div className="h-full overflow-y-auto max-w-md mx-auto p-6 pb-32 no-scrollbar">
            {quotes.length > 0 && (
              <div className="flex justify-end mb-4 px-1">
                <button onClick={onOpenFilter} className="flex items-center gap-1.5 text-[10px] font-bold text-stone-400 hover:text-stone-600 dark:text-stone-500 dark:hover:text-stone-300 transition-colors tracking-wide bg-stone-100/80 dark:bg-stone-800/80 px-3 py-1.5 rounded-full border border-stone-200/50 dark:border-stone-700/50">
                  <ListFilter size={12} />
                  <span>{filterCategory || 'すべての言葉'}</span>
                </button>
              </div>
            )}
            
            {displayQuotes.length === 0 && quotes.length === 0 ? (
               <div className="flex flex-col items-center justify-center h-full text-stone-400 dark:text-stone-500 p-6 text-center italic font-serif">まだ言葉がありません。下の「記す」から始めましょう。</div>
            ) : displayQuotes.length === 0 ? (
               <div className="flex flex-col items-center justify-center h-48 text-stone-400 dark:text-stone-500 p-6 text-center italic font-serif text-sm">このカテゴリの言葉はありません。</div>
            ) : (
              <div className="space-y-6">
                <button onClick={onStartRandom} className="w-full flex items-center justify-between py-4 px-5 bg-stone-100 dark:bg-stone-800 border border-stone-200 dark:border-stone-700 rounded-2xl hover:bg-stone-200 dark:hover:bg-stone-700/80 transition-all group active:scale-[0.98]">
                  <div className="flex items-center gap-3">
                    <div className="bg-white dark:bg-stone-700 p-2.5 rounded-xl shadow-sm text-stone-800 dark:text-stone-200 group-hover:rotate-12 transition-transform"><Sparkles size={20} /></div>
                    <div className="text-left">
                      <p className="text-sm font-bold text-stone-800 dark:text-stone-200 tracking-wider">言葉との再会</p>
                      <p className="text-[10px] text-stone-400 dark:text-stone-500 font-serif">いつかの言葉に、また出会う</p>
                    </div>
                  </div>
                  <ChevronRight className="text-stone-300 dark:text-stone-600 group-hover:text-stone-50 dark:group-hover:text-stone-400 transition-colors" size={18} />
                </button>
                {displayQuotes.map((quote) => (
                  <div key={quote.id} onClick={() => onItemClick(quote.id)} className="group bg-white dark:bg-stone-850 p-6 rounded-2xl border border-stone-100 dark:border-stone-800 hover:border-stone-300 dark:hover:border-stone-600 transition-all cursor-pointer active:bg-stone-50 dark:active:bg-stone-800 shadow-sm text-left">
                    <p className="text-base leading-relaxed text-stone-800 dark:text-stone-200 whitespace-pre-wrap mb-1 font-serif line-clamp-3">{quote.text}</p>
                    {quote.source && <p className="text-[10px] text-stone-400 dark:text-stone-500 font-serif mb-3 tracking-wide">— {quote.source}</p>}
                    <div className="flex justify-between items-end border-t border-stone-50 dark:border-stone-800 pt-3">
                      <span className="text-xs text-stone-500 dark:text-stone-400 bg-stone-100 dark:bg-stone-800 px-2 py-1 rounded-lg font-medium">{quote.category}</span>
                      <span className="text-[10px] text-stone-400 dark:text-stone-600 font-mono">{new Date(quote.timestamp).toLocaleDateString('ja-JP')}</span>
                    </div>
                  </div>
                ))}
              </div>
            )}
          </div>
      );
  };
  const SingleQuoteView = ({ quote, onNext, onPrev, hasNext, hasPrev, nextLabel, nextIcon: NextIcon, onClose }) => (
      <div className="flex flex-col h-full max-w-md mx-auto p-8 pb-8 relative animate-fade-in bg-stone-50 dark:bg-stone-900 overflow-y-auto no-scrollbar transition-colors duration-300">
          <div className="flex-grow flex flex-col items-center pt-5">
              <div className="w-full text-center">
                  <span className="inline-block px-3 py-1 rounded-full border border-stone-200 dark:border-stone-700 text-xs text-stone-500 dark:text-stone-400 tracking-wide mb-8">{quote.category}</span>
                  <div className="px-2">
                      <p className="text-xl md:text-2xl font-serif text-stone-800 dark:text-stone-200 whitespace-pre-wrap mb-4 select-text" style={{ lineHeight: '1.8' }}>{quote.text}</p>
                      {quote.source && <p className="text-sm text-stone-500 dark:text-stone-400 font-serif mb-8">— {quote.source}</p>}
                      <div className="mt-8 flex justify-center text-stone-300 dark:text-stone-700"><div className="h-px w-12 bg-stone-300 dark:bg-stone-700"></div></div>
                      <p className="mt-4 text-[10px] text-stone-400 dark:text-stone-600 font-mono tracking-widest">{new Date(quote.timestamp).toLocaleDateString('ja-JP')}</p>
                  </div>
              </div>
          </div>
          <div className="pt-6 pb-32 text-center">
              <div className="flex gap-3 mb-6 min-h-[64px]">
                  <div className="w-16">
                      <button onClick={onPrev} disabled={!hasPrev} className="w-full h-full border border-stone-300 dark:border-stone-700 rounded-lg text-stone-400 dark:text-stone-500 enabled:hover:text-stone-800 dark:enabled:hover:text-stone-200 transition-all duration-200 bg-white dark:bg-stone-800 flex items-center justify-center disabled:opacity-30"><ChevronLeft size={20} /></button>
                  </div>
                  <div className="flex-grow">
                      <button onClick={onNext} disabled={!hasNext} className="w-full h-full border border-stone-300 dark:border-stone-700 rounded-lg text-stone-600 dark:text-stone-400 enabled:hover:text-stone-800 dark:enabled:hover:text-stone-200 hover:border-stone-400 dark:hover:border-stone-500 transition-all duration-200 flex items-center justify-center gap-2 bg-white dark:bg-stone-800 shadow-sm disabled:opacity-30"><span className="text-sm font-bold tracking-widest">{nextLabel}</span><NextIcon size={16} /></button>
                  </div>
              </div>
              <button onClick={onClose} className="text-xs text-stone-400 dark:text-stone-500 hover:text-stone-600 dark:hover:text-stone-300 transition-colors tracking-widest font-bold py-2 px-4">一覧に戻る</button>
          </div>
      </div>
  );

  const App = () => {
        const [user, setUser] = useState(null);
        const [shortCode, setShortCode] = useState(''); 
        const [isLoadingCode, setIsLoadingCode] = useState(false);
        const [codeError, setCodeError] = useState(null);
        const [syncUserId, setSyncUserId] = useState(null); 
        const [viewMode, setViewMode] = useState('list');
        const [selectedQuoteId, setSelectedQuoteId] = useState(null);
        const [randomHistory, setRandomHistory] = useState([]);
        const [quotes, setQuotes] = useState([]);
        const [toast, setToast] = useState({ show: false, message: '' });
        const [dialogState, setDialogState] = useState({ isVisible: false, type: null, id: null });
        const [isDarkMode, setIsDarkMode] = useState(false);
        const [filterCategory, setFilterCategory] = useState(null);
        const [isFilterVisible, setIsFilterVisible] = useState(false);

        // テーマの初期化と切り替え
        useEffect(() => {
          const savedTheme = localStorage.getItem('theme');
          // Dayモードをデフォルトにするため、保存がない場合はDay（elseブロック）へ誘導
          if (savedTheme === 'dark') {
            setIsDarkMode(true);
            document.documentElement.classList.add('dark');
            document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0c0a09');
          } else {
            setIsDarkMode(false);
            document.documentElement.classList.remove('dark');
            document.querySelector('meta[name="theme-color"]').setAttribute('content', '#fafaf9');
          }
        }, []);

        const toggleTheme = () => {
          const newMode = !isDarkMode;
          setIsDarkMode(newMode);
          if (newMode) {
            document.documentElement.classList.add('dark');
            localStorage.setItem('theme', 'dark');
            document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0c0a09');
          } else {
            document.documentElement.classList.remove('dark');
            localStorage.setItem('theme', 'light');
            document.querySelector('meta[name="theme-color"]').setAttribute('content', '#fafaf9');
          }
        };

        const fetchUserData = async (currentUser) => {
          if (!currentUser) return;
          setIsLoadingCode(true); 
          setCodeError(null);
          try {
            const userCodeRef = doc(db, 'artifacts', appId, 'public', 'data', 'userCodes', currentUser.uid);
            const codeSnap = await getDoc(userCodeRef);
            if (codeSnap.exists()) { 
                setShortCode(codeSnap.data().code); 
            } else { 
                const newCode = generateShortCode(); 
                await setDoc(doc(db, 'artifacts', appId, 'public', 'data', 'syncCodes', newCode), { uid: currentUser.uid }); 
                await setDoc(userCodeRef, { code: newCode }); 
                setShortCode(newCode); 
            }
          } catch (e) { 
              console.error("Fetch Error:", e); 
              let msg = "接続エラー"; 
              if (e.code === 'permission-denied') msg = "権限がありません"; 
              setCodeError(msg); 
          } finally { 
              setIsLoadingCode(false); 
          }
        };

        useEffect(() => {
            setPersistence(auth, browserLocalPersistence)
                .then(() => {
                    const unsubscribe = onAuthStateChanged(auth, (u) => {
                        if (u) {
                            setUser(u);
                            fetchUserData(u);
                        } else {
                            signInAnonymously(auth).catch((e) => {
                                console.error("Auth Error:", e);
                                let msg = "認証エラー";
                                if (e.code === 'auth/operation-not-allowed') msg = "匿名ログインが無効です";
                                setCodeError(msg);
                            });
                        }
                    });
                    return () => unsubscribe();
                })
                .catch((error) => {
                    console.error("Persistence Error:", error);
                    onAuthStateChanged(auth, (u) => {
                        if(u) { setUser(u); fetchUserData(u); }
                    });
                });
        }, []);

        const activeUserId = syncUserId || (user ? user.uid : null);
        useEffect(() => {
          if (!activeUserId) { setQuotes([]); return; }
          const q = query(collection(db, 'artifacts', appId, 'users', activeUserId, 'quotes'));
          const unsubscribe = onSnapshot(q, (snapshot) => {
            const docs = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
            setQuotes(docs.sort((a, b) => (b.timestamp || 0) - (a.timestamp || 0)));
          }, (err) => { console.error("Firestore Sync Error:", err); });
          return () => unsubscribe();
        }, [activeUserId]);

        const showToast = (message) => setToast({ show: true, message });
        const handleSyncByCode = async (code) => { if (!user) return; const cleanCode = code.trim().toUpperCase(); try { const mappingRef = doc(db, 'artifacts', appId, 'public', 'data', 'syncCodes', cleanCode); const mappingSnap = await getDoc(mappingRef); if (mappingSnap.exists()) { setSyncUserId(mappingSnap.data().uid); setViewMode('list'); showToast("同期を開始しました"); } else { showToast("コードが見つかりません"); } } catch (e) { showToast("同期エラーが発生しました"); } };
        const addQuote = async (text, source, category) => { if (!activeUserId) return; await addDoc(collection(db, 'artifacts', appId, 'users', activeUserId, 'quotes'), { text, source, category, timestamp: Date.now() }); showToast("言葉を保存しました"); setViewMode('list'); };
        const updateQuote = async (text, source, category) => { if (!activeUserId || !selectedQuoteId) return; await updateDoc(doc(db, 'artifacts', appId, 'users', activeUserId, 'quotes', selectedQuoteId), { text, source, category }); showToast("言葉を更新しました"); setViewMode(randomHistory.length > 0 ? 'random' : 'detail'); };
        const handleConfirmAction = async () => { if (dialogState.type === 'quote') await confirmDeleteQuote(); else if (dialogState.type === 'account') await confirmResetAccount(); };
        const confirmDeleteQuote = async () => { if (!activeUserId || !dialogState.id) return; await deleteDoc(doc(db, 'artifacts', appId, 'users', activeUserId, 'quotes', dialogState.id)); showToast("削除しました"); setDialogState({ isVisible: false, type: null, id: null }); setViewMode('list'); setSelectedQuoteId(null); };
        const confirmResetAccount = async () => { if (!user || !shortCode) return; try { const quotesRef = collection(db, 'artifacts', appId, 'users', user.uid, 'quotes'); const snap = await getDocs(quotesRef); const deletePromises = snap.docs.map(d => deleteDoc(d.ref)); await Promise.all(deletePromises); await deleteDoc(doc(db, 'artifacts', appId, 'public', 'data', 'syncCodes', shortCode)); await deleteDoc(doc(db, 'artifacts', appId, 'public', 'data', 'userCodes', user.uid)); showToast("初期化しました。リロードします..."); setTimeout(() => window.location.reload(), 1500); } catch (e) { console.error(e); showToast("初期化に失敗しました"); setDialogState({ isVisible: false, type: null, id: null }); } };
        
        const handleTitleClick = (e) => {
            if (e.detail === 3) {
                const htmlContent = document.documentElement.outerHTML;
                const blob = new Blob([htmlContent], { type: 'text/html' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'index.html';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                showToast("HTMLファイルをダウンロードしました");
            }
        };

        const ThemeToggle = () => (
          <button onClick={toggleTheme} className="p-2 text-stone-400 hover:text-stone-800 dark:hover:text-stone-200 transition-colors">
            {isDarkMode ? <Sun size={24} /> : <Moon size={24} />}
          </button>
        );

        const currentQuoteIndex = quotes.findIndex(q => q.id === selectedQuoteId);
        const currentQuote = quotes[currentQuoteIndex];

        let leftActions = null; let rightActions = null;
        switch (viewMode) {
          case 'list': 
            leftActions = <ThemeToggle />;
            rightActions = <button onClick={() => setViewMode('settings')} className="p-2 -mr-2 text-stone-400 hover:text-stone-800 dark:hover:text-stone-200 transition-colors"><Menu size={24} /></button>; 
            break;
          case 'input': case 'settings': 
            rightActions = <button onClick={() => setViewMode('list')} className="p-2 -mr-2 text-stone-400 hover:text-stone-800 dark:hover:text-stone-200 transition-colors"><X size={24} /></button>; 
            break;
          case 'edit': 
            rightActions = <button onClick={() => setViewMode(randomHistory.length > 0 ? 'random' : 'detail')} className="p-2 -mr-2 text-stone-400 hover:text-stone-800 dark:hover:text-stone-200 transition-colors"><X size={24} /></button>; 
            break;
          case 'detail': case 'random': 
            leftActions = <button onClick={() => { setViewMode('list'); setRandomHistory([]); setSelectedQuoteId(null); }} className="p-2 -ml-2 text-stone-400 hover:text-stone-800 dark:hover:text-stone-200 transition-colors"><ArrowLeft size={24} /></button>; 
            rightActions = (<div className="flex gap-1 -mr-2"><button onClick={() => setDialogState({ isVisible: true, type: 'quote', id: selectedQuoteId })} className="p-2 text-stone-400 hover:text-red-500 transition-colors"><Trash2 size={20} /></button><button onClick={() => setViewMode('edit')} className="p-2 text-stone-400 hover:text-stone-800 dark:hover:text-stone-200 transition-colors"><Edit2 size={20} /></button></div>); 
            break;
        }

        if (!user) return <div className="h-screen flex items-center justify-center font-serif text-stone-400 dark:text-stone-500 italic bg-stone-50 dark:bg-stone-900">読み込み中...</div>;

        return (
          <div className="h-[100dvh] bg-stone-50 dark:bg-stone-900 text-stone-800 dark:text-stone-200 font-sans selection:bg-stone-200 dark:selection:bg-stone-700 overflow-hidden flex flex-col transition-colors duration-300">
              <style>{`@media (min-width: 640px) { body { padding-top: 16px; } }`}</style>
              <Header onTitleClick={handleTitleClick} leftActions={leftActions} rightActions={rightActions} />
              <div className="flex-grow overflow-hidden relative" style={{ paddingTop: '64px' }}>
                  <main className="h-full relative overflow-hidden">
                      {viewMode === 'input' && <InputView onSave={addQuote} />}
                      {viewMode === 'list' && (
                        <ListView 
                          quotes={quotes} 
                          onItemClick={(id) => { setSelectedQuoteId(id); setViewMode('detail'); }} 
                          onStartRandom={() => { if (quotes.length > 0) { const first = quotes[Math.floor(Math.random() * quotes.length)]; setSelectedQuoteId(first.id); setRandomHistory([first.id]); setViewMode('random'); } }} 
                          filterCategory={filterCategory}
                          onOpenFilter={() => setIsFilterVisible(true)}
                        />
                      )}
                      {viewMode === 'detail' && currentQuote && <SingleQuoteView quote={currentQuote} onNext={() => setSelectedQuoteId(quotes[(currentQuoteIndex + 1) % quotes.length].id)} onPrev={() => setSelectedQuoteId(quotes[(currentQuoteIndex - 1 + quotes.length) % quotes.length].id)} hasNext={currentQuoteIndex < quotes.length - 1} hasPrev={currentQuoteIndex > 0} nextLabel="次の言葉へ" nextIcon={ChevronRight} onClose={() => setViewMode('list')} />}
                      {viewMode === 'random' && currentQuote && <SingleQuoteView quote={currentQuote} onNext={() => { let n; do { n = quotes[Math.floor(Math.random() * quotes.length)].id; } while (n === selectedQuoteId && quotes.length > 1); setSelectedQuoteId(n); setRandomHistory(p => [...p, n]); }} onPrev={() => { const h = [...randomHistory]; h.pop(); const p = h[h.length - 1]; setSelectedQuoteId(p); setRandomHistory(h); }} hasNext={quotes.length > 1} hasPrev={randomHistory.length > 1} nextLabel="別の言葉に出会う" nextIcon={Sparkles} onClose={() => setViewMode('list')} />}
                      {viewMode === 'edit' && currentQuote && <InputView initialData={currentQuote} onSave={updateQuote} />}
                      {viewMode === 'settings' && <SyncSettingsView currentShortCode={shortCode} isLoadingCode={isLoadingCode} errorMsg={codeError} onRetryCode={() => fetchUserData(user)} onSyncCode={handleSyncByCode} onRequestReset={() => setDialogState({ isVisible: true, type: 'account', id: null })} showToast={showToast} />}
                  </main>
              </div>
              <FilterSheet isVisible={isFilterVisible} currentCategory={filterCategory} onSelect={(cat) => { setFilterCategory(cat); setIsFilterVisible(false); }} onClose={() => setIsFilterVisible(false)} />
              {viewMode === 'list' && <FloatingWriteButton onClick={() => setViewMode('input')} />}
              <ConfirmDialog isVisible={dialogState.isVisible} title={dialogState.type === 'account' ? "全データを削除しますか？" : "言葉を削除しますか？"} message={dialogState.type === 'account' ? "あなたの言葉、設定、同期コードがすべて削除され、アプリが初期化されます。この操作は取り消せません。" : "一度削除した言葉は元に戻すことができません。"} actionLabel={dialogState.type === 'account' ? "全削除して初期化" : "削除する"} onConfirm={handleConfirmAction} onCancel={() => setDialogState({ isVisible: false, type: null, id: null })} />
              <Toast message={toast.message} isVisible={toast.show} onHide={() => setToast(p => ({ ...p, show: false }))} />
          </div>
        );
  };
  const root = createRoot(document.getElementById('root')); root.render(<App />);
</script>

</body></html>